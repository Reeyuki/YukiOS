(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))p(y);new MutationObserver(y=>{for(const m of y)if(m.type==="childList")for(const k of m.addedNodes)k.tagName==="LINK"&&k.rel==="modulepreload"&&p(k)}).observe(document,{childList:!0,subtree:!0});function f(y){const m={};return y.integrity&&(m.integrity=y.integrity),y.referrerPolicy&&(m.referrerPolicy=y.referrerPolicy),y.crossOrigin==="use-credentials"?m.credentials="include":y.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function p(y){if(y.ep)return;y.ep=!0;const m=f(y);fetch(y.href,m)}})();const Os="modulepreload",Ns=function(st){return"/desktop/"+st},br={},Ds=function(c,f,p){let y=Promise.resolve();if(f&&f.length>0){let S=function(g){return Promise.all(g.map(a=>Promise.resolve(a).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};var k=S;document.getElementsByTagName("link");const w=document.querySelector("meta[property=csp-nonce]"),I=w?.nonce||w?.getAttribute("nonce");y=S(f.map(g=>{if(g=Ns(g),g in br)return;br[g]=!0;const a=g.endsWith(".css"),_=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${_}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":Os,a||(u.as="script"),u.crossOrigin="",u.href=g,I&&u.setAttribute("nonce",I),document.head.appendChild(u),a)return new Promise((N,x)=>{u.addEventListener("load",N),u.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${g}`)))})}))}function m(w){const I=new Event("vite:preloadError",{cancelable:!0});if(I.payload=w,window.dispatchEvent(I),!I.defaultPrevented)throw w}return y.then(w=>{for(const I of w||[])I.status==="rejected"&&m(I.reason);return c().catch(m)})};function Cs(st={}){const{immediate:c=!1,onNeedRefresh:f,onOfflineReady:p,onRegistered:y,onRegisteredSW:m,onRegisterError:k}=st;let w,I;const S=async(a=!0)=>{await I};async function g(){if("serviceWorker"in navigator){if(w=await Ds(async()=>{const{Workbox:a}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:a}},[]).then(({Workbox:a})=>new a("/desktop/sw.js",{scope:"/desktop/",type:"classic"})).catch(a=>{k?.(a)}),!w)return;w.addEventListener("activated",a=>{(a.isUpdate||a.isExternal)&&window.location.reload()}),w.addEventListener("installed",a=>{a.isUpdate||p?.()}),w.register({immediate:c}).then(a=>{m?m("/desktop/sw.js",a):y?.(a)}).catch(a=>{k?.(a)})}}return I=g(),S}const Ne=document.getElementById("desktop");class As{constructor(c,f){this.fs=c,this.wm=f,this.currentPath=["home","reeyuki"],this.history=[],this.historyIndex=-1,this.username="reeyuki",this.hostname="desktop-os",this.printQueue=Promise.resolve(),this.commands={},this.pageLoadTime=Date.now(),this.isPrinting=!1,this.inputBuffer="",this.printDepth=0,this.registerDefaultCommands()}async print(c,f=null,p=!1,y=null,m=30){this.printDepth++,this.printDepth===1&&(this.isPrinting=!0,this.inputBuffer=this.terminalInput.value,this.terminalInput.value="",this.terminalInputLine.style.display="none");const k=document.createElement("div"),w=document.createElement("span");if(p){const I=document.createElement("span");I.textContent=y||this.terminalPrompt.textContent,I.style.color="white",k.appendChild(I),k.appendChild(w)}else f&&(w.style.color=f),k.appendChild(w);this.terminalOutput.appendChild(k);for(let I=0;I<c.length;I++)w.textContent+=c[I],await new Promise(S=>setTimeout(S,m)),this.terminalOutput.parentElement.scrollTop=this.terminalOutput.parentElement.scrollHeight;this.printDepth--,this.printDepth===0&&(this.isPrinting=!1,this.terminalInputLine.style.display="flex",this.terminalInput.value=this.inputBuffer,this.terminalInput.focus())}enqueuePrint(c,f=null,p=!1,y=null,m=6){return this.printQueue=this.printQueue.then(()=>this.print(c,f,p,y,m)),this.printQueue}setupEventHandlers(){this.terminalInput.addEventListener("keydown",f=>{if(f.key==="Enter"){f.preventDefault();const p=this.terminalInput.value.trim();if(!p)return;this.history.push(p),this.historyIndex=this.history.length,this.terminalInput.value="",this.executeCommand(p)}else if(f.key==="ArrowUp"&&this.historyIndex>0)f.preventDefault(),this.terminalInput.value=this.history[--this.historyIndex];else if(f.key==="ArrowDown")f.preventDefault(),this.historyIndex=Math.min(this.historyIndex+1,this.history.length),this.terminalInput.value=this.historyIndex<this.history.length?this.history[this.historyIndex]:"";else if(f.key==="Tab")f.preventDefault(),this.handleTabCompletion();else if(f.ctrlKey&&f.key==="l")f.preventDefault(),this.cmdClear();else if(f.ctrlKey&&f.key==="c"){const p=window.getSelection();if(p&&p.toString().length>0)return;f.preventDefault(),this.enqueuePrint("^C","white",!0,this.terminalPrompt.textContent),this.terminalInput.value=""}else if(f.ctrlKey&&f.key==="d"){const p=window.getSelection();if(p&&p.toString().length>0||this.terminalInput.value.length>0)return;f.preventDefault();const y=document.getElementById("terminal-win");this.wm.removeFromTaskbar(y.id),y&&y.remove();return}});const c=document.getElementById("terminal-win");c.addEventListener("mousedown",()=>{const f=window.getSelection();f&&f.removeAllRanges()}),c.addEventListener("mouseup",()=>{window.getSelection().toString().length>0||this.terminalInput.focus()})}expandGlob(c,f){const p=Object.keys(this.fs.getFolder(f)),y=new RegExp("^"+c.replace(/\*/g,".*").replace(/\?/g,".")+"$");return p.filter(m=>y.test(m))}expandGlobsInArgs(c,f){const p=[];for(const y of c)if(y.includes("*")||y.includes("?")){const m=this.expandGlob(y,f);m.length>0?p.push(...m):p.push(y)}else p.push(y);return p}parseCommand(c){return c.split("|").map(p=>p.trim()).map(p=>{const m=(p.match(/(?:[^\s"]+|"[^"]*")+/g)||[]).map(S=>S.replace(/^"(.*)"$/,"$1")),k=m[0],w=[],I=[];for(let S=1;S<m.length;S++)m[S].startsWith("-")?I.push(m[S]):w.push(m[S]);return{command:k,args:w,flags:I}})}async executePipeline(c){let f=null;for(let p=0;p<c.length;p++){const{command:y,args:m,flags:k}=c[p],w=this.expandGlobsInArgs(m,this.currentPath);f!==null&&w.unshift(f);const I=this.commands[y];if(!I){y&&await this.enqueuePrint(`bash: ${y}: command not found`);return}p<c.length-1?f=await this.captureOutput(()=>I(w,k)):await I(w,k)}}async captureOutput(c){const f=this.print.bind(this),p=[];return this.print=async y=>{p.push(y)},await c(),await this.printQueue,this.print=f,p.join(`
`)}async executeCommand(c){await this.enqueuePrint(c,null,!0,this.terminalPrompt.textContent);const f=this.parseCommand(c);await this.executePipeline(f),this.updatePrompt()}handleTabCompletion(){const c=this.terminalInput.value,f=this.terminalInput.selectionStart,p=c.slice(0,f),y=p.match(/(\S+)$/);if(!y)return;const m=y[1],k=p.slice(0,p.length-m.length);let w,I;if(m.includes("/")){const a=m.split("/");I=a.pop(),w=this.fs.resolvePath(a.join("/"),this.currentPath)}else w=[...this.currentPath],I=m;let S;try{S=Object.keys(this.fs.getFolder(w))}catch{return}const g=S.filter(a=>a.startsWith(I));if(g.length)if(g.length===1){const a=g[0]+(this.fs.isFile(w,g[0])?"":"/");this.terminalInput.value=k+a+c.slice(f),this.terminalInput.selectionStart=this.terminalInput.selectionEnd=k.length+a.length}else{const a=g.reduce((_,u)=>{let N=0;for(;N<_.length&&N<u.length&&_[N]===u[N];)N++;return _.slice(0,N)},g[0]);a.length>I.length?(this.terminalInput.value=k+a+c.slice(f),this.terminalInput.selectionStart=this.terminalInput.selectionEnd=k.length+a.length):this.print(g.join("  "))}}open(){const c=document.getElementById("terminal-win");if(c)return this.wm.bringToFront(c);const f=this.wm.createWindow("terminal-win","Terminal","700px","500px");Object.assign(f.style,{left:"200px",top:"100px"}),f.innerHTML=`
    <div class="window-header">
      <span>Terminal</span>
      <div class="window-controls">
        <button class="minimize-btn">−</button>
        <button class="maximize-btn">□</button>
        <button class="close-btn">X</button>
      </div>
    </div>
    <div class="window-content" style="background:#000;color:white;font-family:monospace;padding:10px;overflow-y:auto;height:calc(100% - 40px);">
      <div id="terminal-output" style="white-space:pre;"></div>
      <div id="terminal-input-line" style="display:flex;">
        <span id="terminal-prompt"></span>
        <input id="terminal-input" style="flex:1;background:transparent;border:none;color:white;font-family:monospace;outline:none;margin-left:5px;">
      </div>
    </div>
  `,Ne.appendChild(f),this.wm.makeDraggable(f),this.wm.makeResizable(f),this.wm.setupWindowControls(f),this.wm.addToTaskbar(f.id,"Terminal","/static/icons/terminal.png"),this.terminalOutput=f.querySelector("#terminal-output"),this.terminalInput=f.querySelector("#terminal-input"),this.terminalPrompt=f.querySelector("#terminal-prompt"),this.terminalInputLine=f.querySelector("#terminal-input-line"),this.terminalOutput.addEventListener("contextmenu",p=>{p.stopPropagation()}),this.terminalOutput.style.userSelect="text",this.terminalInput.style.userSelect="text",this.updatePrompt(),this.print("Welcome to Reeyuki's terminal"),this.print(`Type 'help' for available commands
`),this.setupEventHandlers(),this.terminalInput.focus()}updatePrompt(){const c=this.currentPath.length?"/"+this.currentPath.join("/"):"/";this.terminalPrompt.textContent=`${this.username}@${this.hostname}:${c}$ `}registerCommand(c,f){this.commands[c]=f}registerDefaultCommands(){this.registerCommand("help",()=>this.cmdHelp()),this.registerCommand("clear",()=>this.cmdClear()),this.registerCommand("pwd",()=>this.print(this.currentPath.length?"/"+this.currentPath.join("/"):"/")),this.registerCommand("ls",(c,f)=>this.cmdLs(c,f)),this.registerCommand("cd",c=>this.cmdCd(c)),this.registerCommand("mkdir",c=>this.cmdMkdir(c)),this.registerCommand("touch",c=>this.cmdTouch(c)),this.registerCommand("rm",(c,f)=>this.cmdRm(c,f)),this.registerCommand("cat",c=>this.cmdCat(c)),this.registerCommand("echo",c=>this.print(c.join(" "))),this.registerCommand("whoami",()=>this.print(this.username)),this.registerCommand("hostname",()=>this.print(this.hostname)),this.registerCommand("date",()=>this.print(new Date().toString())),this.registerCommand("history",()=>this.history.forEach((c,f)=>this.print(`  ${f+1}  ${c}`))),this.registerCommand("tree",()=>this.cmdTree()),this.registerCommand("uname",()=>this.print("Linux reeyuki-desktop 6.1.23-arch1-1 #1 SMP PREEMPT x86_64 GNU/Linux")),this.registerCommand("ping",c=>this.cmdPing(c)),this.registerCommand("curl",c=>this.cmdCurl(c)),this.registerCommand("neofetch",()=>this.cmdNeofetch()),this.registerCommand("ps",()=>this.cmdPs()),this.registerCommand("grep",c=>this.cmdGrep(c)),this.registerCommand("wc",c=>this.cmdWc(c))}cmdClear(){this.terminalOutput.innerHTML=""}cmdLs(c=[],f=[]){const p=f.some(a=>a.includes("a")),y=f.some(a=>a.includes("l")),m=f.some(a=>a.includes("h")),k=f.some(a=>a.includes("R")),w=f.some(a=>a.includes("r")),I=a=>{if(!m)return a;const _=["B","K","M","G"];let u=0,N=a;for(;N>=1024&&u<_.length-1;)N/=1024,u++;return`${Math.round(N)}${_[u]}`},S=(a,_="")=>{try{const u=this.fs.getFolder(a);let N=Object.keys(u);p||(N=N.filter(x=>!x.startsWith("."))),w&&(N=N.reverse()),N.forEach(x=>{const O=this.fs.isFile(a,x),C=y?`${O?"-":"d"} ${x}${O?"":"/"}${O&&u[x].size!=null?` ${I(u[x].size)}`:""}`:x+(O?"":"/");this.print(_+C,O?null:"blue"),k&&!O&&S(this.fs.resolvePath(x,a),_+"  ")})}catch{this.print(`ls: cannot access '${a}': No such file or directory`)}},g=c.length?this.fs.resolvePath(c[0],this.currentPath):this.currentPath;S(g)}cmdCd(c){if(!c.length||c[0]==="~"){this.currentPath=["home",this.username];return}try{const f=this.fs.resolvePath(c[0],this.currentPath);this.fs.getFolder(f),this.currentPath=f}catch{this.print(`cd: ${c[0]}: No such file or directory`)}}cmdMkdir(c){if(!c.length)return this.print("mkdir: missing operand");c.forEach(f=>{this.fs.createFolder(this.currentPath,f),this.print(`Created directory: ${f}`)})}cmdTouch(c){if(!c.length)return this.print("touch: missing file operand");c.forEach(f=>{this.fs.createFile(this.currentPath,f,""),this.print(`Created file: ${f}`)})}cmdRm(c=[],f=[]){if(!c.length)return this.print("rm: missing operand");const p=f.some(k=>k.includes("r")),y=f.some(k=>k.includes("f")),m=k=>{try{const w=k.slice(0,-1),I=k[k.length-1];if(this.fs.isFile(w,I))this.fs.deleteItem(w,I);else{if(!p)throw new Error("is a directory");Object.keys(this.fs.getFolder(k)).forEach(g=>m([...k,g])),this.fs.deleteItem(w,I)}}catch(w){y||this.print(`rm: cannot remove '${k.join("/")}': ${w.message}`)}};c.forEach(k=>{let w=k.startsWith("/")?this.fs.resolvePath(k,[]):this.fs.resolvePath(k,this.currentPath);m(w)})}cmdCat(c){if(!c.length)return this.print("cat: missing file operand");c.forEach(f=>{f.includes(`
`)?this.print(f):this.fs.isFile(this.currentPath,f)?this.print(this.fs.getFileContent(this.currentPath,f)||"(empty file)"):this.print(`cat: ${f}: Is a directory`)})}cmdGrep(c){if(c.length<1)return this.print("grep: missing pattern");const f=c[0],y=c.slice(1).join(" ").split(`
`),m=new RegExp(f,"i");y.forEach(k=>{m.test(k)&&this.print(k)})}cmdWc(c){const f=c.join(" "),p=f.split(`
`).filter(k=>k.length>0),y=f.split(/\s+/).filter(k=>k.length>0),m=f.length;this.print(`  ${p.length}  ${y.length}  ${m}`)}cmdTree(c=this.currentPath,f=""){f||this.print(c.length?"/"+c.join("/"):"/");const p=Object.keys(this.fs.getFolder(c));p.forEach((y,m)=>{const k=this.fs.isFile(c,y),w=m===p.length-1;this.print(f+(w?"└── ":"├── ")+y+(k?"":"/")),k||this.cmdTree([...c,y],f+(w?"    ":"│   "))})}async cmdPing(c){if(!c.length)return this.print("Usage: ping <host>");await this.print(`PING ${c[0]} ...`);const f=performance.now();try{await fetch("https://"+c[0],{method:"HEAD",mode:"no-cors"})}catch(p){console.error(p)}await this.print(`Reply from ${c[0]}: time=${(performance.now()-f).toFixed(2)}ms`)}async cmdCurl(c){if(!c.length)return this.print("Usage: curl <url>");try{const f=await(await fetch(c[0])).text();this.print(f.slice(0,1e3))}catch{this.print(`curl: (6) Could not resolve host: ${c[0]}`)}}async cmdNeofetch(){const c=navigator.userAgent,f=navigator.userAgentData?.platform||navigator.platform||c||"Unknown";let p="Unknown";/Windows/i.test(f)?p="Windows":/Mac/i.test(f)?p="macOS":/Android/i.test(f)?p="Android":/iPhone|iPad|iOS/i.test(f)?p="iOS":/Linux/i.test(f)&&(p="Linux");const y=p==="Windows"?"Eww a windows!":p;let m="Unknown";/Firefox\/\d+/i.test(c)?m="Firefox":/Edg\/\d+/i.test(c)?m="Edge":/Chrome\/\d+/i.test(c)?m="Chrome":/Safari\/\d+/i.test(c)&&(m="Safari");const k=m==="Chrome"||m==="Edge"?"eww a chromium?!":m,w=navigator.hardwareConcurrency??"Unknown",I=typeof w=="number"&&w>10?`${w} (WOW ITS SO BIG!)`:w;let S="Unknown",g=0;try{const C=document.createElement("canvas"),A=C.getContext("webgl2")||C.getContext("webgl");if(A){S=A.getParameter(A.RENDERER);const J=A.getParameter(A.MAX_TEXTURE_SIZE),B=A.getParameter(A.MAX_VARYING_VECTORS),H=A.getParameter(A.MAX_VERTEX_UNIFORM_VECTORS);g=Math.min(8,Math.floor((J/2048+B/16+H/128)*1.2))}}catch(C){console.error(C)}let a="Unknown";typeof InstallTrigger<"u"?a="SpiderMonkey":typeof window.chrome<"u"?a="V8":/Apple/.test(navigator.vendor)&&(a="JavaScriptCore");const _=navigator.deviceMemory?`${navigator.deviceMemory} GB`:"Unknown",u=navigator.doNotTrack==="1"||window.doNotTrack==="1"?"Enabled":"Disabled",N=Date.now()-this.pageLoadTime,x=`${Math.floor(N/36e5)}h, ${Math.floor(N%36e5/6e4)}m`,O=["","","                     "+this.username+"@"+this.hostname,`        /\\           OWOS     ${y}`,`       /  \\          KEWNEL   ${a}wu`,`      /\\   \\         CPUWU    Cwpu Cowes: ${I}`,`     / > ω <\\        BROWSEWU  ${k}`,`    /   __   \\       GWAPHU    ${S}`,`   / __|  |__-\\      WENDAWU   ${g}`,`  /_-''    ''-_\\     MEMOWY    ${_}`,`                     DoNawtTWACKWU  ${u}`,`                     RESOWUW   ${window.innerWidth}x${window.innerHeight}`,`                     UWUPTIME  ${x}`];for(const C of O)await this.enqueuePrint(C)}cmdPs(){const c=Array.from(document.querySelectorAll(".window"));this.print("  PID   TTY      TIME CMD"),c.forEach((f,p)=>{const y=f.querySelector(".window-header span")?.textContent||"unknown";this.print(`  ${1e3+p}  pts/0  0:00 ${y}`)})}cmdHelp(){const c=[["help","Show this help message"],["neofetch","Display system/browser summary"],["clear","Clear the terminal screen"],["ls","List directory contents"],["pwd","Print working directory"],["cd [dir]","Change directory"],["mkdir","Create a new directory"],["touch","Create a new file"],["rm","Remove file or directory"],["cat","Display file contents"],["echo","Display a line of text"],["grep","Search for pattern in input"],["wc","Count lines, words, and characters"],["whoami","Display current user"],["hostname","Display hostname"],["date","Display current date and time"],["history","Show command history"],["tree","Display directory tree"]];this.print("Available commands:"),c.forEach(([f,p])=>this.print(`  ${f.padEnd(10)} - ${p}`)),this.print(""),this.print("Glob patterns: * (match any), ? (match one)"),this.print("Pipes: command1 | command2")}}function Ms(st){return st&&st.__esModule&&Object.prototype.hasOwnProperty.call(st,"default")?st.default:st}var Hn={exports:{}},Ps=Hn.exports,kr;function Bs(){return kr||(kr=1,(function(st,c){(function(p,y){st.exports=y()})(Ps,function(){return(function(f){var p={};function y(m){if(p[m])return p[m].exports;var k=p[m]={exports:{},id:m,loaded:!1};return f[m].call(k.exports,k,k.exports,y),k.loaded=!0,k.exports}return y.m=f,y.c=p,y.p="",y(0)})([function(f,p,y){(function(m,k,w,I){Object.defineProperty(p,"__esModule",{value:!0});var S=y(2),g=y(9),a;(function(i){i[i.EPERM=1]="EPERM",i[i.ENOENT=2]="ENOENT",i[i.EIO=5]="EIO",i[i.EBADF=9]="EBADF",i[i.EACCES=13]="EACCES",i[i.EBUSY=16]="EBUSY",i[i.EEXIST=17]="EEXIST",i[i.ENOTDIR=20]="ENOTDIR",i[i.EISDIR=21]="EISDIR",i[i.EINVAL=22]="EINVAL",i[i.EFBIG=27]="EFBIG",i[i.ENOSPC=28]="ENOSPC",i[i.EROFS=30]="EROFS",i[i.ENOTEMPTY=39]="ENOTEMPTY",i[i.ENOTSUP=95]="ENOTSUP"})(a||(a={}));var _={};_[a.EPERM]="Operation not permitted.",_[a.ENOENT]="No such file or directory.",_[a.EIO]="Input/output error.",_[a.EBADF]="Bad file descriptor.",_[a.EACCES]="Permission denied.",_[a.EBUSY]="Resource busy or locked.",_[a.EEXIST]="File exists.",_[a.ENOTDIR]="File is not a directory.",_[a.EISDIR]="File is a directory.",_[a.EINVAL]="Invalid argument.",_[a.EFBIG]="File is too big.",_[a.ENOSPC]="No space left on disk.",_[a.EROFS]="Cannot modify a read-only file system.",_[a.ENOTEMPTY]="Directory is not empty.",_[a.ENOTSUP]="Operation is not supported.";var u=(function(i){function t(n,e,r){e===void 0&&(e=_[n]),i.call(this,e),this.syscall="",this.errno=n,this.code=a[n],this.path=r,this.stack=new i().stack,this.message="Error: "+this.code+": "+e+(this.path?", '"+this.path+"'":"")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.fromJSON=function(e){var r=new t(0);return r.errno=e.errno,r.code=e.code,r.path=e.path,r.stack=e.stack,r.message=e.message,r},t.fromBuffer=function(e,r){return r===void 0&&(r=0),t.fromJSON(JSON.parse(e.toString("utf8",r+4,r+4+e.readUInt32LE(r))))},t.FileError=function(e,r){return new t(e,_[e],r)},t.ENOENT=function(e){return this.FileError(a.ENOENT,e)},t.EEXIST=function(e){return this.FileError(a.EEXIST,e)},t.EISDIR=function(e){return this.FileError(a.EISDIR,e)},t.ENOTDIR=function(e){return this.FileError(a.ENOTDIR,e)},t.EPERM=function(e){return this.FileError(a.EPERM,e)},t.ENOTEMPTY=function(e){return this.FileError(a.ENOTEMPTY,e)},t.prototype.toString=function(){return this.message},t.prototype.toJSON=function(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message}},t.prototype.writeToBuffer=function(e,r){e===void 0&&(e=m.alloc(this.bufferSize())),r===void 0&&(r=0);var o=e.write(JSON.stringify(this.toJSON()),r+4);return e.writeUInt32LE(o,r),e},t.prototype.bufferSize=function(){return 4+m.byteLength(JSON.stringify(this.toJSON()))},t})(Error),N=Object.freeze({get ErrorCode(){return a},ErrorStrings:_,ApiError:u}),x;(function(i){i[i.NOP=0]="NOP",i[i.THROW_EXCEPTION=1]="THROW_EXCEPTION",i[i.TRUNCATE_FILE=2]="TRUNCATE_FILE",i[i.CREATE_FILE=3]="CREATE_FILE"})(x||(x={}));var O=function i(t){if(this.flagStr=t,i.validFlagStrs.indexOf(t)<0)throw new u(a.EINVAL,"Invalid flag: "+t)};O.getFileFlag=function(t){return O.flagCache.hasOwnProperty(t)?O.flagCache[t]:O.flagCache[t]=new O(t)},O.prototype.getFlagString=function(){return this.flagStr},O.prototype.isReadable=function(){return this.flagStr.indexOf("r")!==-1||this.flagStr.indexOf("+")!==-1},O.prototype.isWriteable=function(){return this.flagStr.indexOf("w")!==-1||this.flagStr.indexOf("a")!==-1||this.flagStr.indexOf("+")!==-1},O.prototype.isTruncating=function(){return this.flagStr.indexOf("w")!==-1},O.prototype.isAppendable=function(){return this.flagStr.indexOf("a")!==-1},O.prototype.isSynchronous=function(){return this.flagStr.indexOf("s")!==-1},O.prototype.isExclusive=function(){return this.flagStr.indexOf("x")!==-1},O.prototype.pathExistsAction=function(){return this.isExclusive()?x.THROW_EXCEPTION:this.isTruncating()?x.TRUNCATE_FILE:x.NOP},O.prototype.pathNotExistsAction=function(){return(this.isWriteable()||this.isAppendable())&&this.flagStr!=="r+"?x.CREATE_FILE:x.THROW_EXCEPTION},O.flagCache={},O.validFlagStrs=["r","r+","rs","rs+","w","wx","w+","wx+","a","ax","a+","ax+"];var C;(function(i){i[i.FILE=32768]="FILE",i[i.DIRECTORY=16384]="DIRECTORY",i[i.SYMLINK=40960]="SYMLINK"})(C||(C={}));var A=function(t,n,e,r,o,s){if(r===void 0&&(r=new Date),o===void 0&&(o=new Date),s===void 0&&(s=new Date),this.size=n,this.atime=r,this.mtime=o,this.ctime=s,this.dev=0,this.ino=0,this.rdev=0,this.nlink=1,this.blksize=4096,this.uid=0,this.gid=0,this.birthtime=new Date(0),this.fileData=null,e)this.mode=e;else switch(t){case C.FILE:this.mode=420;break;case C.DIRECTORY:default:this.mode=511}this.blocks=Math.ceil(n/512),this.mode<4096&&(this.mode|=t)};A.fromBuffer=function(t){var n=t.readUInt32LE(0),e=t.readUInt32LE(4),r=t.readDoubleLE(8),o=t.readDoubleLE(16),s=t.readDoubleLE(24);return new A(e&61440,n,e&4095,new Date(r),new Date(o),new Date(s))},A.prototype.toBuffer=function(){var t=m.alloc(32);return t.writeUInt32LE(this.size,0),t.writeUInt32LE(this.mode,4),t.writeDoubleLE(this.atime.getTime(),8),t.writeDoubleLE(this.mtime.getTime(),16),t.writeDoubleLE(this.ctime.getTime(),24),t},A.prototype.clone=function(){return new A(this.mode&61440,this.size,this.mode&4095,this.atime,this.mtime,this.ctime)},A.prototype.isFile=function(){return(this.mode&61440)===C.FILE},A.prototype.isDirectory=function(){return(this.mode&61440)===C.DIRECTORY},A.prototype.isSymbolicLink=function(){return(this.mode&61440)===C.SYMLINK},A.prototype.chmod=function(t){this.mode=this.mode&61440|t},A.prototype.isSocket=function(){return!1},A.prototype.isBlockDevice=function(){return!1},A.prototype.isCharacterDevice=function(){return!1},A.prototype.isFIFO=function(){return!1};var J=function(i,t){return i};function B(i){if(i)return i;throw new u(a.EIO,"Initialize BrowserFS with a file system using BrowserFS.initialize(filesystem)")}function H(i,t){switch(typeof i){case"number":return i;case"string":var n=parseInt(i,8);return isNaN(n)?t:n;default:return t}}function St(i){if(i instanceof Date)return i;if(typeof i=="number")return new Date(i*1e3);throw new u(a.EINVAL,"Invalid time.")}function tt(i){if(i.indexOf("\0")>=0)throw new u(a.EINVAL,"Path must be a string without null bytes.");if(i==="")throw new u(a.EINVAL,"Path must not be empty.");return g.resolve(i)}function kt(i,t,n,e){switch(typeof i){case"object":return{encoding:typeof i.encoding<"u"?i.encoding:t,flag:typeof i.flag<"u"?i.flag:n,mode:H(i.mode,e)};case"string":return{encoding:i,flag:n,mode:e};default:return{encoding:t,flag:n,mode:e}}}function dt(){}var z=function(){this.F_OK=0,this.R_OK=4,this.W_OK=2,this.X_OK=1,this.root=null,this.fdMap={},this.nextFd=100};z.prototype.initialize=function(t){if(!t.constructor.isAvailable())throw new u(a.EINVAL,"Tried to instantiate BrowserFS with an unavailable file system.");return this.root=t},z.prototype._toUnixTimestamp=function(t){if(typeof t=="number")return t;if(t instanceof Date)return t.getTime()/1e3;throw new Error("Cannot parse time: "+t)},z.prototype.getRootFS=function(){return this.root?this.root:null},z.prototype.rename=function(t,n,e){e===void 0&&(e=dt);var r=J(e,1);try{B(this.root).rename(tt(t),tt(n),r)}catch(o){r(o)}},z.prototype.renameSync=function(t,n){B(this.root).renameSync(tt(t),tt(n))},z.prototype.exists=function(t,n){n===void 0&&(n=dt);var e=J(n,1);try{return B(this.root).exists(tt(t),e)}catch{return e(!1)}},z.prototype.existsSync=function(t){try{return B(this.root).existsSync(tt(t))}catch{return!1}},z.prototype.stat=function(t,n){n===void 0&&(n=dt);var e=J(n,2);try{return B(this.root).stat(tt(t),!1,e)}catch(r){return e(r)}},z.prototype.statSync=function(t){return B(this.root).statSync(tt(t),!1)},z.prototype.lstat=function(t,n){n===void 0&&(n=dt);var e=J(n,2);try{return B(this.root).stat(tt(t),!0,e)}catch(r){return e(r)}},z.prototype.lstatSync=function(t){return B(this.root).statSync(tt(t),!0)},z.prototype.truncate=function(t,n,e){n===void 0&&(n=0),e===void 0&&(e=dt);var r=0;typeof n=="function"?e=n:typeof n=="number"&&(r=n);var o=J(e,1);try{if(r<0)throw new u(a.EINVAL);return B(this.root).truncate(tt(t),r,o)}catch(s){return o(s)}},z.prototype.truncateSync=function(t,n){if(n===void 0&&(n=0),n<0)throw new u(a.EINVAL);return B(this.root).truncateSync(tt(t),n)},z.prototype.unlink=function(t,n){n===void 0&&(n=dt);var e=J(n,1);try{return B(this.root).unlink(tt(t),e)}catch(r){return e(r)}},z.prototype.unlinkSync=function(t){return B(this.root).unlinkSync(tt(t))},z.prototype.open=function(t,n,e,r){var o=this;r===void 0&&(r=dt);var s=H(e,420);r=typeof e=="function"?e:r;var l=J(r,2);try{B(this.root).open(tt(t),O.getFileFlag(n),s,function(v,E){E?l(v,o.getFdForFile(E)):l(v)})}catch(v){l(v)}},z.prototype.openSync=function(t,n,e){return e===void 0&&(e=420),this.getFdForFile(B(this.root).openSync(tt(t),O.getFileFlag(n),H(e,420)))},z.prototype.readFile=function(t,n,e){n===void 0&&(n={}),e===void 0&&(e=dt);var r=kt(n,null,"r",null);e=typeof n=="function"?n:e;var o=J(e,2);try{var s=O.getFileFlag(r.flag);return s.isReadable()?B(this.root).readFile(tt(t),r.encoding,s,o):o(new u(a.EINVAL,"Flag passed to readFile must allow for reading."))}catch(l){return o(l)}},z.prototype.readFileSync=function(t,n){n===void 0&&(n={});var e=kt(n,null,"r",null),r=O.getFileFlag(e.flag);if(!r.isReadable())throw new u(a.EINVAL,"Flag passed to readFile must allow for reading.");return B(this.root).readFileSync(tt(t),e.encoding,r)},z.prototype.writeFile=function(t,n,e,r){e===void 0&&(e={}),r===void 0&&(r=dt);var o=kt(e,"utf8","w",420);r=typeof e=="function"?e:r;var s=J(r,1);try{var l=O.getFileFlag(o.flag);return l.isWriteable()?B(this.root).writeFile(tt(t),n,o.encoding,l,o.mode,s):s(new u(a.EINVAL,"Flag passed to writeFile must allow for writing."))}catch(v){return s(v)}},z.prototype.writeFileSync=function(t,n,e){var r=kt(e,"utf8","w",420),o=O.getFileFlag(r.flag);if(!o.isWriteable())throw new u(a.EINVAL,"Flag passed to writeFile must allow for writing.");return B(this.root).writeFileSync(tt(t),n,r.encoding,o,r.mode)},z.prototype.appendFile=function(t,n,e,r){r===void 0&&(r=dt);var o=kt(e,"utf8","a",420);r=typeof e=="function"?e:r;var s=J(r,1);try{var l=O.getFileFlag(o.flag);if(!l.isAppendable())return s(new u(a.EINVAL,"Flag passed to appendFile must allow for appending."));B(this.root).appendFile(tt(t),n,o.encoding,l,o.mode,s)}catch(v){s(v)}},z.prototype.appendFileSync=function(t,n,e){var r=kt(e,"utf8","a",420),o=O.getFileFlag(r.flag);if(!o.isAppendable())throw new u(a.EINVAL,"Flag passed to appendFile must allow for appending.");return B(this.root).appendFileSync(tt(t),n,r.encoding,o,r.mode)},z.prototype.fstat=function(t,n){n===void 0&&(n=dt);var e=J(n,2);try{var r=this.fd2file(t);r.stat(e)}catch(o){e(o)}},z.prototype.fstatSync=function(t){return this.fd2file(t).statSync()},z.prototype.close=function(t,n){var e=this;n===void 0&&(n=dt);var r=J(n,1);try{this.fd2file(t).close(function(o){o||e.closeFd(t),r(o)})}catch(o){r(o)}},z.prototype.closeSync=function(t){this.fd2file(t).closeSync(),this.closeFd(t)},z.prototype.ftruncate=function(t,n,e){e===void 0&&(e=dt);var r=typeof n=="number"?n:0;e=typeof n=="function"?n:e;var o=J(e,1);try{var s=this.fd2file(t);if(r<0)throw new u(a.EINVAL);s.truncate(r,o)}catch(l){o(l)}},z.prototype.ftruncateSync=function(t,n){n===void 0&&(n=0);var e=this.fd2file(t);if(n<0)throw new u(a.EINVAL);e.truncateSync(n)},z.prototype.fsync=function(t,n){n===void 0&&(n=dt);var e=J(n,1);try{this.fd2file(t).sync(e)}catch(r){e(r)}},z.prototype.fsyncSync=function(t){this.fd2file(t).syncSync()},z.prototype.fdatasync=function(t,n){n===void 0&&(n=dt);var e=J(n,1);try{this.fd2file(t).datasync(e)}catch(r){e(r)}},z.prototype.fdatasyncSync=function(t){this.fd2file(t).datasyncSync()},z.prototype.write=function(t,n,e,r,o,s){s===void 0&&(s=dt);var l,v,E,D=null;if(typeof n=="string"){var M="utf8";switch(typeof e){case"function":s=e;break;case"number":D=e,M=typeof r=="string"?r:"utf8",s=typeof o=="function"?o:s;break;default:return s=typeof r=="function"?r:typeof o=="function"?o:s,s(new u(a.EINVAL,"Invalid arguments."))}l=m.from(n,M),v=0,E=l.length}else l=n,v=e,E=r,D=typeof o=="number"?o:null,s=typeof o=="function"?o:s;var q=J(s,3);try{var $=this.fd2file(t);D==null&&(D=$.getPos()),$.write(l,v,E,D,q)}catch(nt){q(nt)}},z.prototype.writeSync=function(t,n,e,r,o){var s,l=0,v,E;if(typeof n=="string"){E=typeof e=="number"?e:null;var D=typeof r=="string"?r:"utf8";l=0,s=m.from(n,D),v=s.length}else s=n,l=e,v=r,E=typeof o=="number"?o:null;var M=this.fd2file(t);return E==null&&(E=M.getPos()),M.writeSync(s,l,v,E)},z.prototype.read=function(t,n,e,r,o,s){s===void 0&&(s=dt);var l,v,E,D,M;if(typeof n=="number"){E=n,l=e;var q=r;s=typeof o=="function"?o:s,v=0,D=m.alloc(E),M=J(function(nt,ut,yt){if(nt)return s(nt);s(nt,yt.toString(q),ut)},3)}else D=n,v=e,E=r,l=o,M=J(s,3);try{var $=this.fd2file(t);l==null&&(l=$.getPos()),$.read(D,v,E,l,M)}catch(nt){M(nt)}},z.prototype.readSync=function(t,n,e,r,o){var s=!1,l,v,E,D,M="utf8";typeof n=="number"?(E=n,D=e,M=r,v=0,l=m.alloc(E),s=!0):(l=n,v=e,E=r,D=o);var q=this.fd2file(t);D==null&&(D=q.getPos());var $=q.readSync(l,v,E,D);return s?[l.toString(M),$]:$},z.prototype.fchown=function(t,n,e,r){r===void 0&&(r=dt);var o=J(r,1);try{this.fd2file(t).chown(n,e,o)}catch(s){o(s)}},z.prototype.fchownSync=function(t,n,e){this.fd2file(t).chownSync(n,e)},z.prototype.fchmod=function(t,n,e){var r=J(e,1);try{var o=typeof n=="string"?parseInt(n,8):n;this.fd2file(t).chmod(o,r)}catch(s){r(s)}},z.prototype.fchmodSync=function(t,n){var e=typeof n=="string"?parseInt(n,8):n;this.fd2file(t).chmodSync(e)},z.prototype.futimes=function(t,n,e,r){r===void 0&&(r=dt);var o=J(r,1);try{var s=this.fd2file(t);typeof n=="number"&&(n=new Date(n*1e3)),typeof e=="number"&&(e=new Date(e*1e3)),s.utimes(n,e,o)}catch(l){o(l)}},z.prototype.futimesSync=function(t,n,e){this.fd2file(t).utimesSync(St(n),St(e))},z.prototype.rmdir=function(t,n){n===void 0&&(n=dt);var e=J(n,1);try{t=tt(t),B(this.root).rmdir(t,e)}catch(r){e(r)}},z.prototype.rmdirSync=function(t){return t=tt(t),B(this.root).rmdirSync(t)},z.prototype.mkdir=function(t,n,e){e===void 0&&(e=dt),typeof n=="function"&&(e=n,n=511);var r=J(e,1);try{t=tt(t),B(this.root).mkdir(t,n,r)}catch(o){r(o)}},z.prototype.mkdirSync=function(t,n){B(this.root).mkdirSync(tt(t),H(n,511))},z.prototype.readdir=function(t,n){n===void 0&&(n=dt);var e=J(n,2);try{t=tt(t),B(this.root).readdir(t,e)}catch(r){e(r)}},z.prototype.readdirSync=function(t){return t=tt(t),B(this.root).readdirSync(t)},z.prototype.link=function(t,n,e){e===void 0&&(e=dt);var r=J(e,1);try{t=tt(t),n=tt(n),B(this.root).link(t,n,r)}catch(o){r(o)}},z.prototype.linkSync=function(t,n){return t=tt(t),n=tt(n),B(this.root).linkSync(t,n)},z.prototype.symlink=function(t,n,e,r){r===void 0&&(r=dt);var o=typeof e=="string"?e:"file";r=typeof e=="function"?e:r;var s=J(r,1);try{if(o!=="file"&&o!=="dir")return s(new u(a.EINVAL,"Invalid type: "+o));t=tt(t),n=tt(n),B(this.root).symlink(t,n,o,s)}catch(l){s(l)}},z.prototype.symlinkSync=function(t,n,e){if(!e)e="file";else if(e!=="file"&&e!=="dir")throw new u(a.EINVAL,"Invalid type: "+e);return t=tt(t),n=tt(n),B(this.root).symlinkSync(t,n,e)},z.prototype.readlink=function(t,n){n===void 0&&(n=dt);var e=J(n,2);try{t=tt(t),B(this.root).readlink(t,e)}catch(r){e(r)}},z.prototype.readlinkSync=function(t){return t=tt(t),B(this.root).readlinkSync(t)},z.prototype.chown=function(t,n,e,r){r===void 0&&(r=dt);var o=J(r,1);try{t=tt(t),B(this.root).chown(t,!1,n,e,o)}catch(s){o(s)}},z.prototype.chownSync=function(t,n,e){t=tt(t),B(this.root).chownSync(t,!1,n,e)},z.prototype.lchown=function(t,n,e,r){r===void 0&&(r=dt);var o=J(r,1);try{t=tt(t),B(this.root).chown(t,!0,n,e,o)}catch(s){o(s)}},z.prototype.lchownSync=function(t,n,e){t=tt(t),B(this.root).chownSync(t,!0,n,e)},z.prototype.chmod=function(t,n,e){e===void 0&&(e=dt);var r=J(e,1);try{var o=H(n,-1);if(o<0)throw new u(a.EINVAL,"Invalid mode.");B(this.root).chmod(tt(t),!1,o,r)}catch(s){r(s)}},z.prototype.chmodSync=function(t,n){var e=H(n,-1);if(e<0)throw new u(a.EINVAL,"Invalid mode.");t=tt(t),B(this.root).chmodSync(t,!1,e)},z.prototype.lchmod=function(t,n,e){e===void 0&&(e=dt);var r=J(e,1);try{var o=H(n,-1);if(o<0)throw new u(a.EINVAL,"Invalid mode.");B(this.root).chmod(tt(t),!0,o,r)}catch(s){r(s)}},z.prototype.lchmodSync=function(t,n){var e=H(n,-1);if(e<1)throw new u(a.EINVAL,"Invalid mode.");B(this.root).chmodSync(tt(t),!0,e)},z.prototype.utimes=function(t,n,e,r){r===void 0&&(r=dt);var o=J(r,1);try{B(this.root).utimes(tt(t),St(n),St(e),o)}catch(s){o(s)}},z.prototype.utimesSync=function(t,n,e){B(this.root).utimesSync(tt(t),St(n),St(e))},z.prototype.realpath=function(t,n,e){e===void 0&&(e=dt);var r=typeof n=="object"?n:{};e=typeof n=="function"?n:dt;var o=J(e,2);try{t=tt(t),B(this.root).realpath(t,r,o)}catch(s){o(s)}},z.prototype.realpathSync=function(t,n){return n===void 0&&(n={}),t=tt(t),B(this.root).realpathSync(t,n)},z.prototype.watchFile=function(t,n,e){throw new u(a.ENOTSUP)},z.prototype.unwatchFile=function(t,n){throw new u(a.ENOTSUP)},z.prototype.watch=function(t,n,e){throw new u(a.ENOTSUP)},z.prototype.access=function(t,n,e){throw new u(a.ENOTSUP)},z.prototype.accessSync=function(t,n){throw new u(a.ENOTSUP)},z.prototype.createReadStream=function(t,n){throw new u(a.ENOTSUP)},z.prototype.createWriteStream=function(t,n){throw new u(a.ENOTSUP)},z.prototype.wrapCallbacks=function(t){J=t},z.prototype.getFdForFile=function(t){var n=this.nextFd++;return this.fdMap[n]=t,n},z.prototype.fd2file=function(t){var n=this.fdMap[t];if(n)return n;throw new u(a.EBADF,"Invalid file descriptor.")},z.prototype.closeFd=function(t){delete this.fdMap[t]},z.Stats=A;var et=new z,lt={},Ft=z.prototype;Object.keys(Ft).forEach(function(i){typeof et[i]=="function"?lt[i]=function(){return et[i].apply(et,arguments)}:lt[i]=et[i]}),lt.changeFSModule=function(i){et=i},lt.getFSModule=function(){return et},lt.FS=z;function mt(i,t,n,e,r){return i<t||n<t?i>n?n+1:i+1:e===r?t:t+1}function Ct(i,t){if(i===t)return 0;if(i.length>t.length){var n=i;i=t,t=n}for(var e=i.length,r=t.length;e>0&&i.charCodeAt(e-1)===t.charCodeAt(r-1);)e--,r--;for(var o=0;o<e&&i.charCodeAt(o)===t.charCodeAt(o);)o++;if(e-=o,r-=o,e===0||r===1)return r;for(var s=new Array(e<<1),l=0;l<e;)s[e+l]=i.charCodeAt(o+l),s[l]=++l;var v,E,D,M,q;for(v=0;v+3<r;)for(var $=t.charCodeAt(o+(E=v)),nt=t.charCodeAt(o+(D=v+1)),ut=t.charCodeAt(o+(M=v+2)),yt=t.charCodeAt(o+(q=v+3)),It=v+=4,Gt=0;Gt<e;){var ae=s[e+Gt],Fe=s[Gt];E=mt(Fe,E,D,$,ae),D=mt(E,D,M,nt,ae),M=mt(D,M,q,ut,ae),It=mt(M,q,It,yt,ae),s[Gt++]=It,q=M,M=D,D=E,E=Fe}for(var Te=0;v<r;){var un=t.charCodeAt(o+(E=v));Te=++v;for(var Pe=0;Pe<e;Pe++){var Be=s[Pe];s[Pe]=Te=Be<E||Te<E?Be>Te?Te+1:Be+1:un===s[e+Pe]?E:E+1,E=Be}}return Te}function Lt(i,t,n){i&&console.warn("["+t+"] Direct file system constructor usage is deprecated for this file system, and will be removed in the next major version. Please use the '"+t+".Create("+JSON.stringify(n)+", callback)' method instead. See https://github.com/jvilk/BrowserFS/issues/176 for more details.")}var Et=typeof navigator<"u"&&!!(/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||navigator.userAgent.indexOf("Trident")!==-1),Zt=typeof window>"u";function j(){throw new Error("BFS has reached an impossible code path; please file a bug.")}function U(i,t,n){n.existsSync(i)||(U(g.dirname(i),t,n),n.mkdirSync(i,t))}function K(i){var t=ft(i),n=t.byteOffset,e=t.byteLength;return n===0&&e===t.buffer.byteLength?t.buffer:t.buffer.slice(n,n+e)}function ft(i){return i instanceof Uint8Array?i:new Uint8Array(i)}function Rt(i){return i instanceof m?i:i instanceof Uint8Array?gt(i):m.from(i)}function gt(i){return i instanceof m?i:i.byteOffset===0&&i.byteLength===i.buffer.byteLength?_t(i.buffer):m.from(i.buffer,i.byteOffset,i.byteLength)}function _t(i){return m.from(i)}function Tt(i,t,n){if(t===void 0&&(t=0),n===void 0&&(n=i.length),t<0||n<0||n>i.length||t>n)throw new TypeError("Invalid slice bounds on buffer of length "+i.length+": ["+t+", "+n+"]");if(i.length===0)return Mt();var e=ft(i),r=i[0],o=(r+1)%255;return i[0]=o,e[0]===o?(e[0]=r,gt(e.slice(t,n))):(i[0]=r,gt(e.subarray(t,n)))}var Wt=null;function Mt(){return Wt||(Wt=m.alloc(0))}function F(i,t){m.isBuffer(i)?t():t(new u(a.EINVAL,"option must be a Buffer."))}function T(i,t,n){var e=i.Options,r=i.Name,o=0,s=!1,l=!1;function v(q){s||(q&&(s=!0,n(q)),o--,o===0&&l&&n())}var E=function(q){if(e.hasOwnProperty(q)){var $=e[q],nt=t[q];if(nt==null){if(!$.optional){var ut=Object.keys(t).filter(function(It){return!(It in e)}).map(function(It){return{str:It,distance:Ct(q,It)}}).filter(function(It){return It.distance<5}).sort(function(It,Gt){return It.distance-Gt.distance});return s?{}:(s=!0,{v:n(new u(a.EINVAL,"["+r+"] Required option '"+q+"' not provided."+(ut.length>0?" You provided unrecognized option '"+ut[0].str+"'; perhaps you meant to type '"+q+"'.":"")+`
Option description: `+$.description))})}}else{var yt=!1;if(Array.isArray($.type)?yt=$.type.indexOf(typeof nt)!==-1:yt=typeof nt===$.type,yt)$.validator&&(o++,$.validator(nt,v));else return s?{}:(s=!0,{v:n(new u(a.EINVAL,"["+r+"] Value provided for option "+q+" is not the proper type. Expected "+(Array.isArray($.type)?"one of {"+$.type.join(", ")+"}":$.type)+", but received "+typeof nt+`
Option description: `+$.description))})}}};for(var D in e){var M=E(D);if(M)return M.v}l=!0,o===0&&!s&&n()}var Z=Object.freeze({deprecationMessage:Lt,isIE:Et,isWebWorker:Zt,fail:j,mkdirpSync:U,buffer2ArrayBuffer:K,buffer2Uint8array:ft,arrayish2Buffer:Rt,uint8Array2Buffer:gt,arrayBuffer2Buffer:_t,copyingSlice:Tt,emptyBuffer:Mt,bufferValidator:F,checkOptions:T}),it=function(t){this.fs=t,this.nodefs=t.getNodeFS(),this.FS=t.getFS(),this.PATH=t.getPATH(),this.ERRNO_CODES=t.getERRNO_CODES()};it.prototype.open=function(t){var n=this.fs.realPath(t.node),e=this.FS;try{e.isFile(t.node.mode)&&(t.nfd=this.nodefs.openSync(n,this.fs.flagsToPermissionString(t.flags)))}catch(r){throw r.code?new e.ErrnoError(this.ERRNO_CODES[r.code]):r}},it.prototype.close=function(t){var n=this.FS;try{n.isFile(t.node.mode)&&t.nfd&&this.nodefs.closeSync(t.nfd)}catch(e){throw e.code?new n.ErrnoError(this.ERRNO_CODES[e.code]):e}},it.prototype.read=function(t,n,e,r,o){try{return this.nodefs.readSync(t.nfd,gt(n),e,r,o)}catch(s){throw new this.FS.ErrnoError(this.ERRNO_CODES[s.code])}},it.prototype.write=function(t,n,e,r,o){try{return this.nodefs.writeSync(t.nfd,gt(n),e,r,o)}catch(s){throw new this.FS.ErrnoError(this.ERRNO_CODES[s.code])}},it.prototype.llseek=function(t,n,e){var r=n;if(e===1)r+=t.position;else if(e===2&&this.FS.isFile(t.node.mode))try{var o=this.nodefs.fstatSync(t.nfd);r+=o.size}catch(s){throw new this.FS.ErrnoError(this.ERRNO_CODES[s.code])}if(r<0)throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL);return t.position=r,r};var pt=function(t){this.fs=t,this.nodefs=t.getNodeFS(),this.FS=t.getFS(),this.PATH=t.getPATH(),this.ERRNO_CODES=t.getERRNO_CODES()};pt.prototype.getattr=function(t){var n=this.fs.realPath(t),e;try{e=this.nodefs.lstatSync(n)}catch(r){throw r.code?new this.FS.ErrnoError(this.ERRNO_CODES[r.code]):r}return{dev:e.dev,ino:e.ino,mode:e.mode,nlink:e.nlink,uid:e.uid,gid:e.gid,rdev:e.rdev,size:e.size,atime:e.atime,mtime:e.mtime,ctime:e.ctime,blksize:e.blksize,blocks:e.blocks}},pt.prototype.setattr=function(t,n){var e=this.fs.realPath(t);try{if(n.mode!==void 0&&(this.nodefs.chmodSync(e,n.mode),t.mode=n.mode),n.timestamp!==void 0){var r=new Date(n.timestamp);this.nodefs.utimesSync(e,r,r)}}catch(o){if(!o.code)throw o;if(o.code!=="ENOTSUP")throw new this.FS.ErrnoError(this.ERRNO_CODES[o.code])}if(n.size!==void 0)try{this.nodefs.truncateSync(e,n.size)}catch(o){throw o.code?new this.FS.ErrnoError(this.ERRNO_CODES[o.code]):o}},pt.prototype.lookup=function(t,n){var e=this.PATH.join2(this.fs.realPath(t),n),r=this.fs.getMode(e);return this.fs.createNode(t,n,r)},pt.prototype.mknod=function(t,n,e,r){var o=this.fs.createNode(t,n,e,r),s=this.fs.realPath(o);try{this.FS.isDir(o.mode)?this.nodefs.mkdirSync(s,o.mode):this.nodefs.writeFileSync(s,"",{mode:o.mode})}catch(l){throw l.code?new this.FS.ErrnoError(this.ERRNO_CODES[l.code]):l}return o},pt.prototype.rename=function(t,n,e){var r=this.fs.realPath(t),o=this.PATH.join2(this.fs.realPath(n),e);try{this.nodefs.renameSync(r,o),t.name=e,t.parent=n}catch(s){throw s.code?new this.FS.ErrnoError(this.ERRNO_CODES[s.code]):s}},pt.prototype.unlink=function(t,n){var e=this.PATH.join2(this.fs.realPath(t),n);try{this.nodefs.unlinkSync(e)}catch(r){throw r.code?new this.FS.ErrnoError(this.ERRNO_CODES[r.code]):r}},pt.prototype.rmdir=function(t,n){var e=this.PATH.join2(this.fs.realPath(t),n);try{this.nodefs.rmdirSync(e)}catch(r){throw r.code?new this.FS.ErrnoError(this.ERRNO_CODES[r.code]):r}},pt.prototype.readdir=function(t){var n=this.fs.realPath(t);try{var e=this.nodefs.readdirSync(n);return e.push(".",".."),e}catch(r){throw r.code?new this.FS.ErrnoError(this.ERRNO_CODES[r.code]):r}},pt.prototype.symlink=function(t,n,e){var r=this.PATH.join2(this.fs.realPath(t),n);try{this.nodefs.symlinkSync(e,r)}catch(o){throw o.code?new this.FS.ErrnoError(this.ERRNO_CODES[o.code]):o}},pt.prototype.readlink=function(t){var n=this.fs.realPath(t);try{return this.nodefs.readlinkSync(n)}catch(e){throw e.code?new this.FS.ErrnoError(this.ERRNO_CODES[e.code]):e}};var bt=function(t,n,e,r){t===void 0&&(t=self.FS),n===void 0&&(n=self.PATH),e===void 0&&(e=self.ERRNO_CODES),r===void 0&&(r=lt),this.flagsToPermissionStringMap={0:"r",1:"r+",2:"r+",64:"r",65:"r+",66:"r+",129:"rx+",193:"rx+",514:"w+",577:"w",578:"w+",705:"wx",706:"wx+",1024:"a",1025:"a",1026:"a+",1089:"a",1090:"a+",1153:"ax",1154:"ax+",1217:"ax",1218:"ax+",4096:"rs",4098:"rs+"},this.nodefs=r,this.FS=t,this.PATH=n,this.ERRNO_CODES=e,this.node_ops=new pt(this),this.stream_ops=new it(this)};bt.prototype.mount=function(t){return this.createNode(null,"/",this.getMode(t.opts.root),0)},bt.prototype.createNode=function(t,n,e,r){var o=this.FS;if(!o.isDir(e)&&!o.isFile(e)&&!o.isLink(e))throw new o.ErrnoError(this.ERRNO_CODES.EINVAL);var s=o.createNode(t,n,e);return s.node_ops=this.node_ops,s.stream_ops=this.stream_ops,s},bt.prototype.getMode=function(t){var n;try{n=this.nodefs.lstatSync(t)}catch(e){throw e.code?new this.FS.ErrnoError(this.ERRNO_CODES[e.code]):e}return n.mode},bt.prototype.realPath=function(t){for(var n=[];t.parent!==t;)n.push(t.name),t=t.parent;return n.push(t.mount.opts.root),n.reverse(),this.PATH.join.apply(null,n)},bt.prototype.flagsToPermissionString=function(t){var n=typeof t=="string"?parseInt(t,10):t;return n&=8191,n in this.flagsToPermissionStringMap?this.flagsToPermissionStringMap[n]:t},bt.prototype.getNodeFS=function(){return this.nodefs},bt.prototype.getFS=function(){return this.FS},bt.prototype.getPATH=function(){return this.PATH},bt.prototype.getERRNO_CODES=function(){return this.ERRNO_CODES};var Q=function(){};Q.prototype.supportsLinks=function(){return!1},Q.prototype.diskSpace=function(t,n){n(0,0)},Q.prototype.openFile=function(t,n,e){throw new u(a.ENOTSUP)},Q.prototype.createFile=function(t,n,e,r){throw new u(a.ENOTSUP)},Q.prototype.open=function(t,n,e,r){var o=this,s=function(l,v){if(l)switch(n.pathNotExistsAction()){case x.CREATE_FILE:return o.stat(g.dirname(t),!1,function(E,D){E?r(E):D&&!D.isDirectory()?r(u.ENOTDIR(g.dirname(t))):o.createFile(t,n,e,r)});case x.THROW_EXCEPTION:return r(u.ENOENT(t));default:return r(new u(a.EINVAL,"Invalid FileFlag object."))}else{if(v&&v.isDirectory())return r(u.EISDIR(t));switch(n.pathExistsAction()){case x.THROW_EXCEPTION:return r(u.EEXIST(t));case x.TRUNCATE_FILE:return o.openFile(t,n,function(E,D){E?r(E):D?D.truncate(0,function(){D.sync(function(){r(null,D)})}):j()});case x.NOP:return o.openFile(t,n,r);default:return r(new u(a.EINVAL,"Invalid FileFlag object."))}}};this.stat(t,!1,s)},Q.prototype.rename=function(t,n,e){e(new u(a.ENOTSUP))},Q.prototype.renameSync=function(t,n){throw new u(a.ENOTSUP)},Q.prototype.stat=function(t,n,e){e(new u(a.ENOTSUP))},Q.prototype.statSync=function(t,n){throw new u(a.ENOTSUP)},Q.prototype.openFileSync=function(t,n,e){throw new u(a.ENOTSUP)},Q.prototype.createFileSync=function(t,n,e){throw new u(a.ENOTSUP)},Q.prototype.openSync=function(t,n,e){var r;try{r=this.statSync(t,!1)}catch{switch(n.pathNotExistsAction()){case x.CREATE_FILE:var o=this.statSync(g.dirname(t),!1);if(!o.isDirectory())throw u.ENOTDIR(g.dirname(t));return this.createFileSync(t,n,e);case x.THROW_EXCEPTION:throw u.ENOENT(t);default:throw new u(a.EINVAL,"Invalid FileFlag object.")}}if(r.isDirectory())throw u.EISDIR(t);switch(n.pathExistsAction()){case x.THROW_EXCEPTION:throw u.EEXIST(t);case x.TRUNCATE_FILE:return this.unlinkSync(t),this.createFileSync(t,n,r.mode);case x.NOP:return this.openFileSync(t,n,e);default:throw new u(a.EINVAL,"Invalid FileFlag object.")}},Q.prototype.unlink=function(t,n){n(new u(a.ENOTSUP))},Q.prototype.unlinkSync=function(t){throw new u(a.ENOTSUP)},Q.prototype.rmdir=function(t,n){n(new u(a.ENOTSUP))},Q.prototype.rmdirSync=function(t){throw new u(a.ENOTSUP)},Q.prototype.mkdir=function(t,n,e){e(new u(a.ENOTSUP))},Q.prototype.mkdirSync=function(t,n){throw new u(a.ENOTSUP)},Q.prototype.readdir=function(t,n){n(new u(a.ENOTSUP))},Q.prototype.readdirSync=function(t){throw new u(a.ENOTSUP)},Q.prototype.exists=function(t,n){this.stat(t,null,function(e){n(!e)})},Q.prototype.existsSync=function(t){try{return this.statSync(t,!0),!0}catch{return!1}},Q.prototype.realpath=function(t,n,e){if(this.supportsLinks())for(var r=t.split(g.sep),o=0;o<r.length;o++){var s=r.slice(0,o+1);r[o]=g.join.apply(null,s)}else this.exists(t,function(l){l?e(null,t):e(u.ENOENT(t))})},Q.prototype.realpathSync=function(t,n){if(this.supportsLinks()){for(var e=t.split(g.sep),r=0;r<e.length;r++){var o=e.slice(0,r+1);e[r]=g.join.apply(g,o)}return e.join(g.sep)}else{if(this.existsSync(t))return t;throw u.ENOENT(t)}},Q.prototype.truncate=function(t,n,e){this.open(t,O.getFileFlag("r+"),420,(function(r,o){if(r)return e(r);o.truncate(n,(function(s){o.close((function(l){e(s||l)}))}))}))},Q.prototype.truncateSync=function(t,n){var e=this.openSync(t,O.getFileFlag("r+"),420);try{e.truncateSync(n)}catch(r){throw r}finally{e.closeSync()}},Q.prototype.readFile=function(t,n,e,r){var o=r;this.open(t,e,420,function(s,l){if(s)return r(s);r=function(v,E){l.close(function(D){return v||(v=D),o(v,E)})},l.stat(function(v,E){if(v)return r(v);var D=m.alloc(E.size);l.read(D,0,E.size,0,function(M){if(M)return r(M);if(n===null)return r(M,D);try{r(null,D.toString(n))}catch(q){r(q)}})})})},Q.prototype.readFileSync=function(t,n,e){var r=this.openSync(t,e,420);try{var o=r.statSync(),s=m.alloc(o.size);return r.readSync(s,0,o.size,0),r.closeSync(),n===null?s:s.toString(n)}finally{r.closeSync()}},Q.prototype.writeFile=function(t,n,e,r,o,s){var l=s;this.open(t,r,420,function(v,E){if(v)return s(v);s=function(D){E.close(function(M){l(D||M)})};try{typeof n=="string"&&(n=m.from(n,e))}catch(D){return s(D)}E.write(n,0,n.length,0,s)})},Q.prototype.writeFileSync=function(t,n,e,r,o){var s=this.openSync(t,r,o);try{typeof n=="string"&&(n=m.from(n,e)),s.writeSync(n,0,n.length,0)}finally{s.closeSync()}},Q.prototype.appendFile=function(t,n,e,r,o,s){var l=s;this.open(t,r,o,function(v,E){if(v)return s(v);s=function(D){E.close(function(M){l(D||M)})},typeof n=="string"&&(n=m.from(n,e)),E.write(n,0,n.length,null,s)})},Q.prototype.appendFileSync=function(t,n,e,r,o){var s=this.openSync(t,r,o);try{typeof n=="string"&&(n=m.from(n,e)),s.writeSync(n,0,n.length,null)}finally{s.closeSync()}},Q.prototype.chmod=function(t,n,e,r){r(new u(a.ENOTSUP))},Q.prototype.chmodSync=function(t,n,e){throw new u(a.ENOTSUP)},Q.prototype.chown=function(t,n,e,r,o){o(new u(a.ENOTSUP))},Q.prototype.chownSync=function(t,n,e,r){throw new u(a.ENOTSUP)},Q.prototype.utimes=function(t,n,e,r){r(new u(a.ENOTSUP))},Q.prototype.utimesSync=function(t,n,e){throw new u(a.ENOTSUP)},Q.prototype.link=function(t,n,e){e(new u(a.ENOTSUP))},Q.prototype.linkSync=function(t,n){throw new u(a.ENOTSUP)},Q.prototype.symlink=function(t,n,e,r){r(new u(a.ENOTSUP))},Q.prototype.symlinkSync=function(t,n,e){throw new u(a.ENOTSUP)},Q.prototype.readlink=function(t,n){n(new u(a.ENOTSUP))},Q.prototype.readlinkSync=function(t){throw new u(a.ENOTSUP)};var ne=(function(i){function t(){i.apply(this,arguments)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.supportsSynch=function(){return!0},t.prototype.rename=function(e,r,o){try{this.renameSync(e,r),o()}catch(s){o(s)}},t.prototype.stat=function(e,r,o){try{o(null,this.statSync(e,r))}catch(s){o(s)}},t.prototype.open=function(e,r,o,s){try{s(null,this.openSync(e,r,o))}catch(l){s(l)}},t.prototype.unlink=function(e,r){try{this.unlinkSync(e),r()}catch(o){r(o)}},t.prototype.rmdir=function(e,r){try{this.rmdirSync(e),r()}catch(o){r(o)}},t.prototype.mkdir=function(e,r,o){try{this.mkdirSync(e,r),o()}catch(s){o(s)}},t.prototype.readdir=function(e,r){try{r(null,this.readdirSync(e))}catch(o){r(o)}},t.prototype.chmod=function(e,r,o,s){try{this.chmodSync(e,r,o),s()}catch(l){s(l)}},t.prototype.chown=function(e,r,o,s,l){try{this.chownSync(e,r,o,s),l()}catch(v){l(v)}},t.prototype.utimes=function(e,r,o,s){try{this.utimesSync(e,r,o),s()}catch(l){s(l)}},t.prototype.link=function(e,r,o){try{this.linkSync(e,r),o()}catch(s){o(s)}},t.prototype.symlink=function(e,r,o,s){try{this.symlinkSync(e,r,o),s()}catch(l){s(l)}},t.prototype.readlink=function(e,r){try{r(null,this.readlinkSync(e))}catch(o){r(o)}},t})(Q),vt=function(){};vt.prototype.sync=function(t){t(new u(a.ENOTSUP))},vt.prototype.syncSync=function(){throw new u(a.ENOTSUP)},vt.prototype.datasync=function(t){this.sync(t)},vt.prototype.datasyncSync=function(){return this.syncSync()},vt.prototype.chown=function(t,n,e){e(new u(a.ENOTSUP))},vt.prototype.chownSync=function(t,n){throw new u(a.ENOTSUP)},vt.prototype.chmod=function(t,n){n(new u(a.ENOTSUP))},vt.prototype.chmodSync=function(t){throw new u(a.ENOTSUP)},vt.prototype.utimes=function(t,n,e){e(new u(a.ENOTSUP))},vt.prototype.utimesSync=function(t,n){throw new u(a.ENOTSUP)};var oe=(function(i){function t(n,e,r,o,s){if(i.call(this),this._pos=0,this._dirty=!1,this._fs=n,this._path=e,this._flag=r,this._stat=o,s?this._buffer=s:this._buffer=Mt(),this._stat.size!==this._buffer.length&&this._flag.isReadable())throw new Error("Invalid buffer: Buffer is "+this._buffer.length+" long, yet Stats object specifies that file is "+this._stat.size+" long.")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.getBuffer=function(){return this._buffer},t.prototype.getStats=function(){return this._stat},t.prototype.getFlag=function(){return this._flag},t.prototype.getPath=function(){return this._path},t.prototype.getPos=function(){return this._flag.isAppendable()?this._stat.size:this._pos},t.prototype.advancePos=function(e){return this._pos+=e},t.prototype.setPos=function(e){return this._pos=e},t.prototype.sync=function(e){try{this.syncSync(),e()}catch(r){e(r)}},t.prototype.syncSync=function(){throw new u(a.ENOTSUP)},t.prototype.close=function(e){try{this.closeSync(),e()}catch(r){e(r)}},t.prototype.closeSync=function(){throw new u(a.ENOTSUP)},t.prototype.stat=function(e){try{e(null,this._stat.clone())}catch(r){e(r)}},t.prototype.statSync=function(){return this._stat.clone()},t.prototype.truncate=function(e,r){try{this.truncateSync(e),this._flag.isSynchronous()&&!lt.getRootFS().supportsSynch()&&this.sync(r),r()}catch(o){return r(o)}},t.prototype.truncateSync=function(e){if(this._dirty=!0,!this._flag.isWriteable())throw new u(a.EPERM,"File not opened with a writeable mode.");if(this._stat.mtime=new Date,e>this._buffer.length){var r=m.alloc(e-this._buffer.length,0);this.writeSync(r,0,r.length,this._buffer.length),this._flag.isSynchronous()&&lt.getRootFS().supportsSynch()&&this.syncSync();return}this._stat.size=e;var o=m.alloc(e);this._buffer.copy(o,0,0,e),this._buffer=o,this._flag.isSynchronous()&&lt.getRootFS().supportsSynch()&&this.syncSync()},t.prototype.write=function(e,r,o,s,l){try{l(null,this.writeSync(e,r,o,s),e)}catch(v){l(v)}},t.prototype.writeSync=function(e,r,o,s){if(this._dirty=!0,s==null&&(s=this.getPos()),!this._flag.isWriteable())throw new u(a.EPERM,"File not opened with a writeable mode.");var l=s+o;if(l>this._stat.size&&(this._stat.size=l,l>this._buffer.length)){var v=m.alloc(l);this._buffer.copy(v),this._buffer=v}var E=e.copy(this._buffer,s,r,r+o);return this._stat.mtime=new Date,this._flag.isSynchronous()?(this.syncSync(),E):(this.setPos(s+E),E)},t.prototype.read=function(e,r,o,s,l){try{l(null,this.readSync(e,r,o,s),e)}catch(v){l(v)}},t.prototype.readSync=function(e,r,o,s){if(!this._flag.isReadable())throw new u(a.EPERM,"File not opened with a readable mode.");s==null&&(s=this.getPos());var l=s+o;l>this._stat.size&&(o=this._stat.size-s);var v=this._buffer.copy(e,r,s,s+o);return this._stat.atime=new Date,this._pos=s+o,v},t.prototype.chmod=function(e,r){try{this.chmodSync(e),r()}catch(o){r(o)}},t.prototype.chmodSync=function(e){if(!this._fs.supportsProps())throw new u(a.ENOTSUP);this._dirty=!0,this._stat.chmod(e),this.syncSync()},t.prototype.isDirty=function(){return this._dirty},t.prototype.resetDirty=function(){this._dirty=!1},t})(vt),le=(function(i){function t(n,e,r,o,s){i.call(this,n,e,r,o,s)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){e()},t.prototype.syncSync=function(){},t.prototype.close=function(e){e()},t.prototype.closeSync=function(){},t})(oe),be=(function(i){function t(n,e,r,o,s){i.call(this,n,e,r,o,s)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},t.prototype.closeSync=function(){this.syncSync()},t})(oe),R=(function(i){function t(n,e,r){if(r===void 0&&(r=!0),i.call(this),this._queue=[],this._queueRunning=!1,this._isInitialized=!1,this._initializeCallbacks=[],this._sync=n,this._async=e,!n.supportsSynch())throw new Error("The first argument to AsyncMirror needs to be a synchronous file system.");Lt(r,t.Name,{sync:"sync file system instance",async:"async file system instance"})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){try{var o=new t(e.sync,e.async,!1);o.initialize(function(s){s?r(s):r(null,o)},!1)}catch(s){r(s)}},t.isAvailable=function(){return!0},t.prototype.getName=function(){return t.Name},t.prototype._syncSync=function(e){this._sync.writeFileSync(e.getPath(),e.getBuffer(),null,O.getFileFlag("w"),e.getStats().mode),this.enqueueOp({apiMethod:"writeFile",arguments:[e.getPath(),e.getBuffer(),null,e.getFlag(),e.getStats().mode]})},t.prototype.initialize=function(e,r){var o=this;r===void 0&&(r=!0),r&&console.warn("[AsyncMirror] AsyncMirror.initialize() is deprecated and will be removed in the next major version. Please use 'AsyncMirror.Create({ sync: (sync file system instance), async: (async file system instance)}, cb)' to create and initialize AsyncMirror instances.");var s=this._initializeCallbacks,l=function(M){o._isInitialized=!M,o._initializeCallbacks=[],s.forEach(function(q){return q(M)})};if(this._isInitialized)e();else if(s.push(e)===1){var v=function(M,q,$){M!=="/"&&o._sync.mkdirSync(M,q),o._async.readdir(M,function(nt,ut){var yt=0;function It(Gt){Gt?$(Gt):yt<ut.length?(D(g.join(M,ut[yt]),It),yt++):$()}nt?$(nt):It()})},E=function(M,q,$){o._async.readFile(M,null,O.getFileFlag("r"),function(nt,ut){if(nt)$(nt);else try{o._sync.writeFileSync(M,ut,null,O.getFileFlag("w"),q)}catch(yt){nt=yt}finally{$(nt)}})},D=function(M,q){o._async.stat(M,!1,function($,nt){$?q($):nt.isDirectory()?v(M,nt.mode,q):E(M,nt.mode,q)})};v("/",0,l)}},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return this._sync.supportsProps()&&this._async.supportsProps()},t.prototype.renameSync=function(e,r){this.checkInitialized(),this._sync.renameSync(e,r),this.enqueueOp({apiMethod:"rename",arguments:[e,r]})},t.prototype.statSync=function(e,r){return this.checkInitialized(),this._sync.statSync(e,r)},t.prototype.openSync=function(e,r,o){this.checkInitialized();var s=this._sync.openSync(e,r,o);return s.closeSync(),new be(this,e,r,this._sync.statSync(e,!1),this._sync.readFileSync(e,null,O.getFileFlag("r")))},t.prototype.unlinkSync=function(e){this.checkInitialized(),this._sync.unlinkSync(e),this.enqueueOp({apiMethod:"unlink",arguments:[e]})},t.prototype.rmdirSync=function(e){this.checkInitialized(),this._sync.rmdirSync(e),this.enqueueOp({apiMethod:"rmdir",arguments:[e]})},t.prototype.mkdirSync=function(e,r){this.checkInitialized(),this._sync.mkdirSync(e,r),this.enqueueOp({apiMethod:"mkdir",arguments:[e,r]})},t.prototype.readdirSync=function(e){return this.checkInitialized(),this._sync.readdirSync(e)},t.prototype.existsSync=function(e){return this.checkInitialized(),this._sync.existsSync(e)},t.prototype.chmodSync=function(e,r,o){this.checkInitialized(),this._sync.chmodSync(e,r,o),this.enqueueOp({apiMethod:"chmod",arguments:[e,r,o]})},t.prototype.chownSync=function(e,r,o,s){this.checkInitialized(),this._sync.chownSync(e,r,o,s),this.enqueueOp({apiMethod:"chown",arguments:[e,r,o,s]})},t.prototype.utimesSync=function(e,r,o){this.checkInitialized(),this._sync.utimesSync(e,r,o),this.enqueueOp({apiMethod:"utimes",arguments:[e,r,o]})},t.prototype.checkInitialized=function(){if(!this._isInitialized)throw new u(a.EPERM,"AsyncMirrorFS is not initialized. Please initialize AsyncMirrorFS using its initialize() method before using it.")},t.prototype.enqueueOp=function(e){var r=this;if(this._queue.push(e),!this._queueRunning){this._queueRunning=!0;var o=function(s){if(s&&console.error("WARNING: File system has desynchronized. Received following error: "+s+`
$`),r._queue.length>0){var l=r._queue.shift(),v=l.arguments;v.push(o),r._async[l.apiMethod].apply(r._async,v)}else r._queueRunning=!1};o()}},t})(ne);R.Name="AsyncMirror",R.Options={sync:{type:"object",description:"The synchronous file system to mirror the asynchronous file system to."},async:{type:"object",description:"The asynchronous file system to mirror."}};function h(i,t,n){switch(n.length){case 0:return i.call(t);case 1:return i.call(t,n[0]);case 2:return i.call(t,n[0],n[1]);case 3:return i.call(t,n[0],n[1],n[2])}return i.apply(t,n)}var d=Math.max;function L(i,t,n){return t=d(t===void 0?i.length-1:t,0),function(){for(var e=arguments,r=-1,o=d(e.length-t,0),s=Array(o);++r<o;)s[r]=e[t+r];r=-1;for(var l=Array(t+1);++r<t;)l[r]=e[r];return l[t]=n(s),h(i,this,l)}}function P(i){return i}function G(i,t){return L(i,t,P)}var V=function(i){return G(function(t){var n=t.pop();i.call(this,t,n)})};function xt(i){return G(function(t,n){var e=V(function(r,o){var s=this;return i(t,function(l,v){l.apply(s,r.concat(v))},o)});return n.length?e.apply(this,n):e})}var Dt=typeof k=="object"&&k&&k.Object===Object&&k,Pt=typeof self=="object"&&self&&self.Object===Object&&self,Vt=Dt||Pt||Function("return this")(),At=Vt.Symbol,ke=Object.prototype,$e=ke.hasOwnProperty,We=ke.toString,He=At?At.toStringTag:void 0;function Xn(i){var t=$e.call(i,He),n=i[He];try{i[He]=void 0;var e=!0}catch{}var r=We.call(i);return e&&(t?i[He]=n:delete i[He]),r}var Yn=Object.prototype,Zn=Yn.toString;function W(i){return Zn.call(i)}var ot="[object Null]",b="[object Undefined]",ct=At?At.toStringTag:void 0;function Bt(i){return i==null?i===void 0?b:ot:ct&&ct in Object(i)?Xn(i):W(i)}function rt(i){var t=typeof i;return i!=null&&(t=="object"||t=="function")}var fe="[object AsyncFunction]",at="[object Function]",Kt="[object GeneratorFunction]",Y="[object Proxy]";function X(i){if(!rt(i))return!1;var t=Bt(i);return t==at||t==Kt||t==fe||t==Y}var tn=9007199254740991;function Ut(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=tn}function ht(i){return i!=null&&Ut(i.length)&&!X(i)}var qe={};function De(){}function Ht(i){return function(){if(i!==null){var t=i;i=null,t.apply(this,arguments)}}}var Ot=typeof Symbol=="function"&&Symbol.iterator,ie=function(i){return Ot&&i[Ot]&&i[Ot]()};function ue(i,t){for(var n=-1,e=Array(i);++n<i;)e[n]=t(n);return e}function re(i){return i!=null&&typeof i=="object"}var en="[object Arguments]";function Ge(i){return re(i)&&Bt(i)==en}var Xt=Object.prototype,he=Xt.hasOwnProperty,te=Xt.propertyIsEnumerable,Ie=Ge((function(){return arguments})())?Ge:function(i){return re(i)&&he.call(i,"callee")&&!te.call(i,"callee")},Se=Array.isArray;function Rn(){return!1}var hi=typeof p=="object"&&p&&!p.nodeType&&p,pi=hi&&typeof w=="object"&&w&&!w.nodeType&&w,Pr=pi&&pi.exports===hi,di=Pr?Vt.Buffer:void 0,Br=di?di.isBuffer:void 0,Ur=Br||Rn,zr=9007199254740991,jr=/^(?:0|[1-9]\d*)$/;function Wr(i,t){return t=t??zr,!!t&&(typeof i=="number"||jr.test(i))&&i>-1&&i%1==0&&i<t}var Hr="[object Arguments]",qr="[object Array]",Gr="[object Boolean]",Xr="[object Date]",Yr="[object Error]",Zr="[object Function]",Vr="[object Map]",Kr="[object Number]",Jr="[object Object]",Qr="[object RegExp]",$r="[object Set]",to="[object String]",eo="[object WeakMap]",no="[object ArrayBuffer]",io="[object DataView]",ro="[object Float32Array]",oo="[object Float64Array]",so="[object Int8Array]",ao="[object Int16Array]",co="[object Int32Array]",lo="[object Uint8Array]",uo="[object Uint8ClampedArray]",fo="[object Uint16Array]",ho="[object Uint32Array]",zt={};zt[ro]=zt[oo]=zt[so]=zt[ao]=zt[co]=zt[lo]=zt[uo]=zt[fo]=zt[ho]=!0,zt[Hr]=zt[qr]=zt[no]=zt[Gr]=zt[io]=zt[Xr]=zt[Yr]=zt[Zr]=zt[Vr]=zt[Kr]=zt[Jr]=zt[Qr]=zt[$r]=zt[to]=zt[eo]=!1;function po(i){return re(i)&&Ut(i.length)&&!!zt[Bt(i)]}function yo(i){return function(t){return i(t)}}var yi=typeof p=="object"&&p&&!p.nodeType&&p,mi=yi&&typeof w=="object"&&w&&!w.nodeType&&w,mo=mi&&mi.exports===yi,Vn=mo&&Dt.process,vi=(function(){try{return Vn&&Vn.binding&&Vn.binding("util")}catch{}})(),gi=vi&&vi.isTypedArray,vo=gi?yo(gi):po,go=Object.prototype,wo=go.hasOwnProperty;function So(i,t){var n=Se(i),e=!n&&Ie(i),r=!n&&!e&&Ur(i),o=!n&&!e&&!r&&vo(i),s=n||e||r||o,l=s?ue(i.length,String):[],v=l.length;for(var E in i)wo.call(i,E)&&!(s&&(E=="length"||r&&(E=="offset"||E=="parent")||o&&(E=="buffer"||E=="byteLength"||E=="byteOffset")||Wr(E,v)))&&l.push(E);return l}var Eo=Object.prototype;function _o(i){var t=i&&i.constructor,n=typeof t=="function"&&t.prototype||Eo;return i===n}function bo(i,t){return function(n){return i(t(n))}}var ko=bo(Object.keys,Object),Io=Object.prototype,Ro=Io.hasOwnProperty;function Lo(i){if(!_o(i))return ko(i);var t=[];for(var n in Object(i))Ro.call(i,n)&&n!="constructor"&&t.push(n);return t}function xo(i){return ht(i)?So(i):Lo(i)}function Fo(i){var t=-1,n=i.length;return function(){return++t<n?{value:i[t],key:t}:null}}function To(i){var t=-1;return function(){var e=i.next();return e.done?null:(t++,{value:e.value,key:t})}}function Oo(i){var t=xo(i),n=-1,e=t.length;return function(){var o=t[++n];return n<e?{value:i[o],key:o}:null}}function No(i){if(ht(i))return Fo(i);var t=ie(i);return t?To(t):Oo(i)}function wi(i){return function(){if(i===null)throw new Error("Callback was already called.");var t=i;i=null,t.apply(this,arguments)}}function Si(i){return function(t,n,e){if(e=Ht(e||De),i<=0||!t)return e(null);var r=No(t),o=!1,s=0;function l(E,D){if(s-=1,E)o=!0,e(E);else{if(D===qe||o&&s<=0)return o=!0,e(null);v()}}function v(){for(;s<i&&!o;){var E=r();if(E===null){o=!0,s<=0&&e(null);return}s+=1,n(E.value,E.key,wi(l))}}v()}}function Ei(i,t,n,e){Si(t)(i,n,e)}function Kn(i,t){return function(n,e,r){return i(n,t,e,r)}}function Do(i,t,n){n=Ht(n||De);var e=0,r=0,o=i.length;o===0&&n(null);function s(l,v){l?n(l):(++r===o||v===qe)&&n(null)}for(;e<o;e++)t(i[e],e,wi(s))}var Co=Kn(Ei,1/0),_i=function(i,t,n){var e=ht(i)?Do:Co;e(i,t,n)};function Ao(i){return function(t,n,e){return i(_i,t,n,e)}}function bi(i,t,n,e){e=e||De,t=t||[];var r=[],o=0;i(t,function(s,l,v){var E=o++;n(s,function(D,M){r[E]=M,v(D)})},function(s){e(s,r)})}var Mo=Ao(bi);xt(Mo);function Po(i){return function(t,n,e,r){return i(Si(n),t,e,r)}}var Bo=Po(bi),Uo=Kn(Bo,1);xt(Uo),G(function(i,t){return G(function(n){return i.apply(null,t.concat(n))})});function zo(i,t){for(var n=-1,e=i==null?0:i.length;++n<e&&t(i[n],n,i)!==!1;);return i}var ki=typeof setImmediate=="function"&&setImmediate,Ii=typeof I=="object"&&typeof I.nextTick=="function";function Ri(i){setTimeout(i,0)}function Li(i){return G(function(t,n){i(function(){t.apply(null,n)})})}var Ln;ki?Ln=setImmediate:Ii?Ln=I.nextTick:Ln=Ri,Li(Ln);var jo=Kn(Ei,1);function Wo(i,t,n,e){e=Ht(e||De),jo(i,function(r,o,s){n(t,r,function(l,v){t=v,s(l)})},function(r){e(r,t)})}var Ho=G(function(t){return G(function(n){var e=this,r=n[n.length-1];typeof r=="function"?n.pop():r=De,Wo(t,n,function(o,s,l){s.apply(e,o.concat(G(function(v,E){l(v,E)})))},function(o,s){r.apply(e,[o].concat(s))})})});G(function(i){return Ho.apply(null,i.reverse())}),G(function(i){var t=[null].concat(i);return V(function(n,e){return e.apply(this,t)})});function xi(i){return G(function(t,n){t.apply(null,n.concat(G(function(e,r){typeof console=="object"&&(e?console.error&&console.error(e):console[i]&&zo(r,function(o){console[i](o)}))})))})}xi("dir");function qo(i){return function(t,n,e){return i(t,e)}}function Fi(i,t,n){_i(i,qo(t),n)}xi("log");var xn;Ii?xn=I.nextTick:ki?xn=setImmediate:xn=Ri,Li(xn);var pe;function Go(){pe||(pe={},pe[Dropbox.ApiError.NETWORK_ERROR]=a.EIO,pe[Dropbox.ApiError.INVALID_PARAM]=a.EINVAL,pe[Dropbox.ApiError.INVALID_TOKEN]=a.EPERM,pe[Dropbox.ApiError.OAUTH_ERROR]=a.EPERM,pe[Dropbox.ApiError.NOT_FOUND]=a.ENOENT,pe[Dropbox.ApiError.INVALID_METHOD]=a.EINVAL,pe[Dropbox.ApiError.NOT_ACCEPTABLE]=a.EINVAL,pe[Dropbox.ApiError.CONFLICT]=a.EINVAL,pe[Dropbox.ApiError.RATE_LIMITED]=a.EBUSY,pe[Dropbox.ApiError.SERVER_ERROR]=a.EBUSY,pe[Dropbox.ApiError.OVER_QUOTA]=a.ENOSPC)}function Xo(i){return i&&i.stat.isFile}function Yo(i){return i&&i.stat.isFolder}function Zo(i){return i==null||typeof i=="object"&&typeof i.byteLength=="number"}var se=function(t){this._cache={},this._client=t};se.prototype.readdir=function(t,n){var e=this,r=this.getCachedDirInfo(t);this._wrap(function(o){r!==null&&r.contents?e._client.readdir(t,{contentHash:r.stat.contentHash},o):e._client.readdir(t,o)},function(o,s,l,v){o?o.status===Dropbox.ApiError.NO_CONTENT&&r!==null?n(null,r.contents.slice(0)):n(o):(e.updateCachedDirInfo(t,l,s.slice(0)),v.forEach(function(E){e.updateCachedInfo(g.join(t,E.name),E)}),n(null,s))})},se.prototype.remove=function(t,n){var e=this;this._wrap(function(r){e._client.remove(t,r)},function(r,o){r||e.updateCachedInfo(t,o),n(r)})},se.prototype.move=function(t,n,e){var r=this;this._wrap(function(o){r._client.move(t,n,o)},function(o,s){o||(r.deleteCachedInfo(t),r.updateCachedInfo(n,s)),e(o)})},se.prototype.stat=function(t,n){var e=this;this._wrap(function(r){e._client.stat(t,r)},function(r,o){r||e.updateCachedInfo(t,o),n(r,o)})},se.prototype.readFile=function(t,n){var e=this,r=this.getCachedFileInfo(t);r!==null&&r.contents!==null?this.stat(t,function(o,s){o?n(o):s.contentHash===r.stat.contentHash?n(o,r.contents.slice(0),r.stat):e.readFile(t,n)}):this._wrap(function(o){e._client.readFile(t,{arrayBuffer:!0},o)},function(o,s,l){o||e.updateCachedInfo(t,l,s.slice(0)),n(o,s,l)})},se.prototype.writeFile=function(t,n,e){var r=this;this._wrap(function(o){r._client.writeFile(t,n,o)},function(o,s){o||r.updateCachedInfo(t,s,n.slice(0)),e(o,s)})},se.prototype.mkdir=function(t,n){var e=this;this._wrap(function(r){e._client.mkdir(t,r)},function(r,o){r||e.updateCachedInfo(t,o,[]),n(r)})},se.prototype._wrap=function(t,n){var e=0,r=function(o){var s=2;if(o&&3>++e)switch(o.status){case Dropbox.ApiError.SERVER_ERROR:case Dropbox.ApiError.NETWORK_ERROR:case Dropbox.ApiError.RATE_LIMITED:setTimeout(function(){t(r)},s*1e3);break;default:n.apply(null,arguments);break}else n.apply(null,arguments)};t(r)},se.prototype.getCachedInfo=function(t){return this._cache[t.toLowerCase()]},se.prototype.putCachedInfo=function(t,n){this._cache[t.toLowerCase()]=n},se.prototype.deleteCachedInfo=function(t){delete this._cache[t.toLowerCase()]},se.prototype.getCachedDirInfo=function(t){var n=this.getCachedInfo(t);return Yo(n)?n:null},se.prototype.getCachedFileInfo=function(t){var n=this.getCachedInfo(t);return Xo(n)?n:null},se.prototype.updateCachedDirInfo=function(t,n,e){e===void 0&&(e=null);var r=this.getCachedInfo(t);n.contentHash!==null&&(r===void 0||r.stat.contentHash!==n.contentHash)&&this.putCachedInfo(t,{stat:n,contents:e})},se.prototype.updateCachedFileInfo=function(t,n,e){e===void 0&&(e=null);var r=this.getCachedInfo(t);n.versionTag!==null&&(r===void 0||r.stat.versionTag!==n.versionTag)&&this.putCachedInfo(t,{stat:n,contents:e})},se.prototype.updateCachedInfo=function(t,n,e){e===void 0&&(e=null),n.isFile&&Zo(e)?this.updateCachedFileInfo(t,n,e):n.isFolder&&Array.isArray(e)&&this.updateCachedDirInfo(t,n,e)};var Vo=(function(i){function t(n,e,r,o,s){i.call(this,n,e,r,o,s)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var r=this;if(this.isDirty()){var o=this.getBuffer(),s=K(o);this._fs._writeFileStrict(this.getPath(),s,function(l){l||r.resetDirty(),e(l)})}else e()},t.prototype.close=function(e){this.sync(e)},t})(oe),Fn=(function(i){function t(n,e){e===void 0&&(e=!0),i.call(this),this._client=new se(n),Lt(e,t.Name,{client:"authenticated dropbox client instance"}),Go()}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){r(null,new t(e.client,!1))},t.isAvailable=function(){return typeof Dropbox<"u"},t.prototype.getName=function(){return t.Name},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.empty=function(e){var r=this;this._client.readdir("/",function(o,s){if(o)e(r.convert(o,"/"));else{var l=function(E,D){var M=g.join("/",E);r._client.remove(M,function(q){D(q?r.convert(q,M):null)})},v=function(E){E?e(E):e()};Fi(s,l,v)}})},t.prototype.rename=function(e,r,o){var s=this;this._client.move(e,r,function(l){l?s._client.stat(r,function(v,E){if(v||E.isFolder){var D=l.response.error.indexOf(e)>-1?e:r;o(s.convert(l,D))}else s._client.remove(r,function(M){M?o(s.convert(M,r)):s.rename(e,r,o)})}):o()})},t.prototype.stat=function(e,r,o){var s=this;this._client.stat(e,function(l,v){if(l)o(s.convert(l,e));else if(v&&v.isRemoved)o(u.FileError(a.ENOENT,e));else{var E=new A(s._statType(v),v.size);return o(null,E)}})},t.prototype.open=function(e,r,o,s){var l=this;this._client.readFile(e,function(v,E,D){if(v)if(r.isReadable())s(l.convert(v,e));else if(v.status===Dropbox.ApiError.NOT_FOUND){var M=new ArrayBuffer(0);return l._writeFileStrict(e,M,function(nt,ut){if(nt)s(nt);else{var yt=l._makeFile(e,r,ut,_t(M));s(null,yt)}})}else return s(l.convert(v,e));else{var q;E===null?q=Mt():q=_t(E);var $=l._makeFile(e,r,D,q);return s(null,$)}})},t.prototype._writeFileStrict=function(e,r,o){var s=this,l=g.dirname(e);this.stat(l,!1,function(v,E){v?o(u.FileError(a.ENOENT,l)):s._client.writeFile(e,r,function(D,M){D?o(s.convert(D,e)):o(null,M)})})},t.prototype._statType=function(e){return e.isFile?C.FILE:C.DIRECTORY},t.prototype._makeFile=function(e,r,o,s){var l=this._statType(o),v=new A(l,o.size);return new Vo(this,e,r,v,s)},t.prototype._remove=function(e,r,o){var s=this;this._client.stat(e,function(l,v){l?r(s.convert(l,e)):v.isFile&&!o?r(u.FileError(a.ENOTDIR,e)):!v.isFile&&o?r(u.FileError(a.EISDIR,e)):s._client.remove(e,function(E){r(E?s.convert(E,e):null)})})},t.prototype.unlink=function(e,r){this._remove(e,r,!0)},t.prototype.rmdir=function(e,r){this._remove(e,r,!1)},t.prototype.mkdir=function(e,r,o){var s=this,l=g.dirname(e);this._client.stat(l,function(v,E){v?o(s.convert(v,l)):s._client.mkdir(e,function(D){o(D?u.FileError(a.EEXIST,e):null)})})},t.prototype.readdir=function(e,r){var o=this;this._client.readdir(e,function(s,l){return s?r(o.convert(s)):r(null,l)})},t.prototype.convert=function(e,r){r===void 0&&(r=null);var o=pe[e.status];return o===void 0&&(o=a.EIO),r?u.FileError(o,r):new u(o)},t})(Q);Fn.Name="Dropbox",Fn.Options={client:{type:"object",description:"An *authenticated* Dropbox client. Must be from the 0.10 JS SDK.",validator:function(i,t){i.isAuthenticated&&i.isAuthenticated()?t():t(new u(a.EINVAL,"'client' option must be an authenticated Dropbox client from the v0.10 JS SDK."))}}};function Yt(i,t){t===void 0&&(t="");for(var n=i.errno,e=i.node,r=[];e&&(r.unshift(e.name),e!==e.parent);)e=e.parent;return new u(n,_[n],r.length>0?"/"+r.join("/"):t)}var Ko=(function(i){function t(n,e,r,o){i.call(this),this._fs=n,this._FS=e,this._path=r,this._stream=o}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.getPos=function(){},t.prototype.close=function(e){var r=null;try{this.closeSync()}catch(o){r=o}finally{e(r)}},t.prototype.closeSync=function(){try{this._FS.close(this._stream)}catch(e){throw Yt(e,this._path)}},t.prototype.stat=function(e){try{e(null,this.statSync())}catch(r){e(r)}},t.prototype.statSync=function(){try{return this._fs.statSync(this._path,!1)}catch(e){throw Yt(e,this._path)}},t.prototype.truncate=function(e,r){var o=null;try{this.truncateSync(e)}catch(s){o=s}finally{r(o)}},t.prototype.truncateSync=function(e){try{this._FS.ftruncate(this._stream.fd,e)}catch(r){throw Yt(r,this._path)}},t.prototype.write=function(e,r,o,s,l){try{l(null,this.writeSync(e,r,o,s),e)}catch(v){l(v)}},t.prototype.writeSync=function(e,r,o,s){try{var l=ft(e),v=s===null?void 0:s;return this._FS.write(this._stream,l,r,o,v)}catch(E){throw Yt(E,this._path)}},t.prototype.read=function(e,r,o,s,l){try{l(null,this.readSync(e,r,o,s),e)}catch(v){l(v)}},t.prototype.readSync=function(e,r,o,s){try{var l=ft(e),v=s===null?void 0:s;return this._FS.read(this._stream,l,r,o,v)}catch(E){throw Yt(E,this._path)}},t.prototype.sync=function(e){e()},t.prototype.syncSync=function(){},t.prototype.chown=function(e,r,o){var s=null;try{this.chownSync(e,r)}catch(l){s=l}finally{o(s)}},t.prototype.chownSync=function(e,r){try{this._FS.fchown(this._stream.fd,e,r)}catch(o){throw Yt(o,this._path)}},t.prototype.chmod=function(e,r){var o=null;try{this.chmodSync(e)}catch(s){o=s}finally{r(o)}},t.prototype.chmodSync=function(e){try{this._FS.fchmod(this._stream.fd,e)}catch(r){throw Yt(r,this._path)}},t.prototype.utimes=function(e,r,o){var s=null;try{this.utimesSync(e,r)}catch(l){s=l}finally{o(s)}},t.prototype.utimesSync=function(e,r){this._fs.utimesSync(this._path,e,r)},t})(vt),Tn=(function(i){function t(n){i.call(this),this._FS=n}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){r(null,new t(e.FS))},t.isAvailable=function(){return!0},t.prototype.getName=function(){return this._FS.DB_NAME()},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsLinks=function(){return!0},t.prototype.supportsProps=function(){return!0},t.prototype.supportsSynch=function(){return!0},t.prototype.renameSync=function(e,r){try{this._FS.rename(e,r)}catch(o){throw o.errno===a.ENOENT?Yt(o,this.existsSync(e)?r:e):Yt(o)}},t.prototype.statSync=function(e,r){try{var o=r?this._FS.lstat(e):this._FS.stat(e),s=this.modeToFileType(o.mode);return new A(s,o.size,o.mode,o.atime,o.mtime,o.ctime)}catch(l){throw Yt(l,e)}},t.prototype.openSync=function(e,r,o){try{var s=this._FS.open(e,r.getFlagString(),o);if(this._FS.isDir(s.node.mode))throw this._FS.close(s),u.EISDIR(e);return new Ko(this,this._FS,e,s)}catch(l){throw Yt(l,e)}},t.prototype.unlinkSync=function(e){try{this._FS.unlink(e)}catch(r){throw Yt(r,e)}},t.prototype.rmdirSync=function(e){try{this._FS.rmdir(e)}catch(r){throw Yt(r,e)}},t.prototype.mkdirSync=function(e,r){try{this._FS.mkdir(e,r)}catch(o){throw Yt(o,e)}},t.prototype.readdirSync=function(e){try{return this._FS.readdir(e).filter(function(r){return r!=="."&&r!==".."})}catch(r){throw Yt(r,e)}},t.prototype.truncateSync=function(e,r){try{this._FS.truncate(e,r)}catch(o){throw Yt(o,e)}},t.prototype.readFileSync=function(e,r,o){try{var s=this._FS.readFile(e,{flags:o.getFlagString()}),l=gt(s);return r?l.toString(r):l}catch(v){throw Yt(v,e)}},t.prototype.writeFileSync=function(e,r,o,s,l){try{o&&(r=m.from(r,o));var v=ft(r);this._FS.writeFile(e,v,{flags:s.getFlagString(),encoding:"binary"}),this._FS.chmod(e,l)}catch(E){throw Yt(E,e)}},t.prototype.chmodSync=function(e,r,o){try{r?this._FS.lchmod(e,o):this._FS.chmod(e,o)}catch(s){throw Yt(s,e)}},t.prototype.chownSync=function(e,r,o,s){try{r?this._FS.lchown(e,o,s):this._FS.chown(e,o,s)}catch(l){throw Yt(l,e)}},t.prototype.symlinkSync=function(e,r,o){try{this._FS.symlink(e,r)}catch(s){throw Yt(s)}},t.prototype.readlinkSync=function(e){try{return this._FS.readlink(e)}catch(r){throw Yt(r,e)}},t.prototype.utimesSync=function(e,r,o){try{this._FS.utime(e,r.getTime(),o.getTime())}catch(s){throw Yt(s,e)}},t.prototype.modeToFileType=function(e){if(this._FS.isDir(e))return C.DIRECTORY;if(this._FS.isFile(e))return C.FILE;if(this._FS.isLink(e))return C.SYMLINK;throw u.EPERM("Invalid mode: "+e)},t})(ne);Tn.Name="EmscriptenFileSystem",Tn.Options={FS:{type:"object",description:"The Emscripten file system to use (the `FS` variable)"}};var nn=(function(i){function t(n,e){i.call(this),this._folder=n,this._wrapped=e}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){r(null,new t(e.folder,e.wrapped))},t.isAvailable=function(){return!0},t.prototype.initialize=function(e){var r=this;this._wrapped.exists(this._folder,function(o){o?e():r._wrapped.isReadOnly()?e(u.ENOENT(r._folder)):r._wrapped.mkdir(r._folder,511,e)})},t.prototype.getName=function(){return this._wrapped.getName()},t.prototype.isReadOnly=function(){return this._wrapped.isReadOnly()},t.prototype.supportsProps=function(){return this._wrapped.supportsProps()},t.prototype.supportsSynch=function(){return this._wrapped.supportsSynch()},t.prototype.supportsLinks=function(){return!1},t})(Q);nn.Name="FolderAdapter",nn.Options={folder:{type:"string",description:"The folder to use as the root directory"},wrapped:{type:"object",description:"The file system to wrap"}};function Ti(i,t){if(t!==null&&typeof t=="object"){var n=t,e=n.path;e&&(e="/"+g.relative(i,e),n.message=n.message.replace(n.path,e),n.path=e)}return t}function Jo(i,t){return typeof t=="function"?function(n){arguments.length>0&&(arguments[0]=Ti(i,n)),t.apply(null,arguments)}:t}function Oi(i,t,n){return i.slice(i.length-4)!=="Sync"?function(){return arguments.length>0&&(arguments[0]=g.join(this._folder,arguments[0]),n&&(arguments[1]=g.join(this._folder,arguments[1])),arguments[arguments.length-1]=Jo(this._folder,arguments[arguments.length-1])),this._wrapped[i].apply(this._wrapped,arguments)}:function(){try{return t&&(arguments[0]=g.join(this._folder,arguments[0])),n&&(arguments[1]=g.join(this._folder,arguments[1])),this._wrapped[i].apply(this._wrapped,arguments)}catch(e){throw Ti(this._folder,e)}}}["diskSpace","stat","statSync","open","openSync","unlink","unlinkSync","rmdir","rmdirSync","mkdir","mkdirSync","readdir","readdirSync","exists","existsSync","realpath","realpathSync","truncate","truncateSync","readFile","readFileSync","writeFile","writeFileSync","appendFile","appendFileSync","chmod","chmodSync","chown","chownSync","utimes","utimesSync","readlink","readlinkSync"].forEach(function(i){nn.prototype[i]=Oi(i,!0,!1)}),["rename","renameSync","link","linkSync","symlink","symlinkSync"].forEach(function(i){nn.prototype[i]=Oi(i,!0,!0)});var On;typeof window<"u"?On=window:typeof self<"u"?On=self:On=k;var Jt=On;function Qo(i){return i.isDirectory}var Jn=Jt.webkitRequestFileSystem||Jt.requestFileSystem||null;function $o(i,t,n,e){if(typeof navigator.webkitPersistentStorage<"u")switch(i){case Jt.PERSISTENT:navigator.webkitPersistentStorage.requestQuota(t,n,e);break;case Jt.TEMPORARY:navigator.webkitTemporaryStorage.requestQuota(t,n,e);break;default:e(new TypeError("Invalid storage type: "+i));break}else Jt.webkitStorageInfo.requestQuota(i,t,n,e)}function ts(i){return Array.prototype.slice.call(i||[],0)}function Re(i,t,n){switch(i.name){case"PathExistsError":return u.EEXIST(t);case"QuotaExceededError":return u.FileError(a.ENOSPC,t);case"NotFoundError":return u.ENOENT(t);case"SecurityError":return u.FileError(a.EACCES,t);case"InvalidModificationError":return u.FileError(a.EPERM,t);case"TypeMismatchError":return u.FileError(n?a.ENOTDIR:a.EISDIR,t);default:return u.FileError(a.EINVAL,t)}}var es=(function(i){function t(n,e,r,o,s,l){i.call(this,n,r,o,s,l),this._entry=e}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var r=this;if(!this.isDirty())return e();this._entry.createWriter(function(o){var s=r.getBuffer(),l=new Blob([K(s)]),v=l.size;o.onwriteend=function(E){o.onwriteend=null,o.onerror=null,o.truncate(v),r.resetDirty(),e()},o.onerror=function(E){e(Re(E,r.getPath(),!1))},o.write(l)})},t.prototype.close=function(e){this.sync(e)},t})(oe),Nn=(function(i){function t(n,e,r){n===void 0&&(n=5),e===void 0&&(e=Jt.PERSISTENT),r===void 0&&(r=!0),i.call(this),this.size=1024*1024*n,this.type=e,Lt(r,t.Name,{size:n,type:e})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){var o=new t(e.size,e.type,!1);o.allocate(function(s){return s?r(s):r(null,o)},!1)},t.isAvailable=function(){return!!Jn},t.prototype.getName=function(){return t.Name},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.allocate=function(e,r){var o=this;e===void 0&&(e=function(){}),r===void 0&&(r=!0),r&&console.warn("[HTML5FS] HTML5FS.allocate() is deprecated and will be removed in the next major release. Please use 'HTML5FS.Create({type: "+this.type+", size: "+this.size+"}, cb)' to create and allocate HTML5FS instances.");var s=function(v){o.fs=v,e()},l=function(v){e(Re(v,"/",!0))};this.type===Jt.PERSISTENT?$o(this.type,this.size,function(v){Jn(o.type,v,s,l)},l):Jn(this.type,this.size,s,l)},t.prototype.empty=function(e){this._readdir("/",function(r,o){if(r)console.error("Failed to empty FS"),e(r);else{var s=function(v){r?(console.error("Failed to empty FS"),e(r)):e()},l=function(v,E){var D=function(){E()},M=function(q){E(Re(q,v.fullPath,!v.isDirectory))};Qo(v)?v.removeRecursively(D,M):v.remove(D,M)};Fi(o,l,s)}})},t.prototype.rename=function(e,r,o){var s=this,l=2,v=0,E=this.fs.root,D=e,M=function($){--l<=0&&o(Re($,D,!1))},q=function($){if(++v===2)return o(new u(a.EINVAL,"Something was identified as both a file and a directory. This should never happen."));if(e===r)return o();D=g.dirname(r),E.getDirectory(D,{},function(nt){D=g.basename(r),$.moveTo(nt,D,function(ut){o()},function(ut){$.isDirectory?(D=r,s.unlink(r,function(yt){yt?M(ut):s.rename(e,r,o)})):M(ut)})},M)};E.getFile(e,{},q,M),E.getDirectory(e,{},q,M)},t.prototype.stat=function(e,r,o){var s=this,l={create:!1},v=function(q){var $=function(nt){var ut=new A(C.FILE,nt.size);o(null,ut)};q.file($,D)},E=function(q){var $=4096,nt=new A(C.DIRECTORY,$);o(null,nt)},D=function(q){o(Re(q,e,!1))},M=function(){s.fs.root.getDirectory(e,l,E,D)};this.fs.root.getFile(e,l,v,M)},t.prototype.open=function(e,r,o,s){var l=this,v=function(E){E.name==="InvalidModificationError"&&r.isExclusive()?s(u.EEXIST(e)):s(Re(E,e,!1))};this.fs.root.getFile(e,{create:r.pathNotExistsAction()===x.CREATE_FILE,exclusive:r.isExclusive()},function(E){E.file(function(D){var M=new FileReader;M.onloadend=function(q){var $=l._makeFile(e,E,r,D,M.result);s(null,$)},M.onerror=function(q){v(M.error)},M.readAsArrayBuffer(D)},v)},v)},t.prototype.unlink=function(e,r){this._remove(e,r,!0)},t.prototype.rmdir=function(e,r){var o=this;this.readdir(e,function(s,l){s?r(s):l.length>0?r(u.ENOTEMPTY(e)):o._remove(e,r,!1)})},t.prototype.mkdir=function(e,r,o){var s={create:!0,exclusive:!0},l=function(E){o()},v=function(E){o(Re(E,e,!0))};this.fs.root.getDirectory(e,s,l,v)},t.prototype.readdir=function(e,r){this._readdir(e,function(o,s){if(s){for(var l=[],v=0,E=s;v<E.length;v+=1){var D=E[v];l.push(D.name)}r(null,l)}else return r(o)})},t.prototype._makeFile=function(e,r,o,s,l){l===void 0&&(l=new ArrayBuffer(0));var v=new A(C.FILE,s.size),E=_t(l);return new es(this,r,e,o,v,E)},t.prototype._readdir=function(e,r){var o=function(s){r(Re(s,e,!0))};this.fs.root.getDirectory(e,{create:!1},function(s){var l=s.createReader(),v=[],E=function(){l.readEntries((function(D){D.length?(v=v.concat(ts(D)),E()):r(null,v)}),o)};E()},o)},t.prototype._remove=function(e,r,o){var s=function(E){var D=function(){r()},M=function(q){r(Re(q,e,!o))};E.remove(D,M)},l=function(E){r(Re(E,e,!o))},v={create:!1};o?this.fs.root.getFile(e,v,s,l):this.fs.root.getDirectory(e,v,s,l)},t})(Q);Nn.Name="HTML5FS",Nn.Options={size:{type:"number",optional:!0,description:"Storage quota to request, in megabytes. Allocated value may be less. Defaults to 5."},type:{type:"number",optional:!0,description:"window.PERSISTENT or window.TEMPORARY. Defaults to PERSISTENT."}};var de=function(t,n,e,r,o,s){this.id=t,this.size=n,this.mode=e,this.atime=r,this.mtime=o,this.ctime=s};de.fromBuffer=function(t){if(t===void 0)throw new Error("NO");return new de(t.toString("ascii",30),t.readUInt32LE(0),t.readUInt16LE(4),t.readDoubleLE(6),t.readDoubleLE(14),t.readDoubleLE(22))},de.prototype.toStats=function(){return new A((this.mode&61440)===C.DIRECTORY?C.DIRECTORY:C.FILE,this.size,this.mode,new Date(this.atime),new Date(this.mtime),new Date(this.ctime))},de.prototype.getSize=function(){return 30+this.id.length},de.prototype.toBuffer=function(t){return t===void 0&&(t=m.alloc(this.getSize())),t.writeUInt32LE(this.size,0),t.writeUInt16LE(this.mode,4),t.writeDoubleLE(this.atime,6),t.writeDoubleLE(this.mtime,14),t.writeDoubleLE(this.ctime,22),t.write(this.id,30,this.id.length,"ascii"),t},de.prototype.update=function(t){var n=!1;this.size!==t.size&&(this.size=t.size,n=!0),this.mode!==t.mode&&(this.mode=t.mode,n=!0);var e=t.atime.getTime();this.atime!==e&&(this.atime=e,n=!0);var r=t.mtime.getTime();this.mtime!==r&&(this.mtime=r,n=!0);var o=t.ctime.getTime();return this.ctime!==o&&(this.ctime=o,n=!0),n},de.prototype.isFile=function(){return(this.mode&61440)===C.FILE},de.prototype.isDirectory=function(){return(this.mode&61440)===C.DIRECTORY};var Ue="/",Qn=null;function Ni(){return Qn||(Qn=m.from("{}"))}function Dn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var t=Math.random()*16|0,n=i==="x"?t:t&3|8;return n.toString(16)})}function ve(i,t){return i?(t(i),!1):!0}function $t(i,t,n){return i?(t.abort(function(){n(i)}),!1):!0}var Ce=function(t){this.store=t,this.originalData={},this.modifiedKeys=[]};Ce.prototype.get=function(t){var n=this.store.get(t);return this.stashOldValue(t,n),n},Ce.prototype.put=function(t,n,e){return this.markModified(t),this.store.put(t,n,e)},Ce.prototype.del=function(t){this.markModified(t),this.store.del(t)},Ce.prototype.commit=function(){},Ce.prototype.abort=function(){for(var t=this,n=0,e=t.modifiedKeys;n<e.length;n+=1){var r=e[n],o=t.originalData[r];o?t.store.put(r,o,!0):t.store.del(r)}},Ce.prototype.stashOldValue=function(t,n){this.originalData.hasOwnProperty(t)||(this.originalData[t]=n)},Ce.prototype.markModified=function(t){this.modifiedKeys.indexOf(t)===-1&&(this.modifiedKeys.push(t),this.originalData.hasOwnProperty(t)||(this.originalData[t]=this.store.get(t)))};var Di=(function(i){function t(n,e,r,o,s){i.call(this,n,e,r,o,s)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this.getPath(),this.getBuffer(),this.getStats()),this.resetDirty())},t.prototype.closeSync=function(){this.syncSync()},t})(oe),Ci=(function(i){function t(n){i.call(this),this.store=n.store,this.makeRootDirectory()}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.getName=function(){return this.store.name()},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.empty=function(){this.store.clear(),this.makeRootDirectory()},t.prototype.renameSync=function(e,r){var o=this.store.beginTransaction("readwrite"),s=g.dirname(e),l=g.basename(e),v=g.dirname(r),E=g.basename(r),D=this.findINode(o,s),M=this.getDirListing(o,s,D);if(!M[l])throw u.ENOENT(e);var q=M[l];if(delete M[l],(v+"/").indexOf(e+"/")===0)throw new u(a.EBUSY,s);var $,nt;if(v===s?($=D,nt=M):($=this.findINode(o,v),nt=this.getDirListing(o,v,$)),nt[E]){var ut=this.getINode(o,r,nt[E]);if(ut.isFile())try{o.del(ut.id),o.del(nt[E])}catch(yt){throw o.abort(),yt}else throw u.EPERM(r)}nt[E]=q;try{o.put(D.id,m.from(JSON.stringify(M)),!0),o.put($.id,m.from(JSON.stringify(nt)),!0)}catch(yt){throw o.abort(),yt}o.commit()},t.prototype.statSync=function(e,r){return this.findINode(this.store.beginTransaction("readonly"),e).toStats()},t.prototype.createFileSync=function(e,r,o){var s=this.store.beginTransaction("readwrite"),l=Mt(),v=this.commitNewFile(s,e,C.FILE,o,l);return new Di(this,e,r,v.toStats(),l)},t.prototype.openFileSync=function(e,r){var o=this.store.beginTransaction("readonly"),s=this.findINode(o,e),l=o.get(s.id);if(l===void 0)throw u.ENOENT(e);return new Di(this,e,r,s.toStats(),l)},t.prototype.unlinkSync=function(e){this.removeEntry(e,!1)},t.prototype.rmdirSync=function(e){if(this.readdirSync(e).length>0)throw u.ENOTEMPTY(e);this.removeEntry(e,!0)},t.prototype.mkdirSync=function(e,r){var o=this.store.beginTransaction("readwrite"),s=m.from("{}");this.commitNewFile(o,e,C.DIRECTORY,r,s)},t.prototype.readdirSync=function(e){var r=this.store.beginTransaction("readonly");return Object.keys(this.getDirListing(r,e,this.findINode(r,e)))},t.prototype._syncSync=function(e,r,o){var s=this.store.beginTransaction("readwrite"),l=this._findINode(s,g.dirname(e),g.basename(e)),v=this.getINode(s,e,l),E=v.update(o);try{s.put(v.id,r,!0),E&&s.put(l,v.toBuffer(),!0)}catch(D){throw s.abort(),D}s.commit()},t.prototype.makeRootDirectory=function(){var e=this.store.beginTransaction("readwrite");if(e.get(Ue)===void 0){var r=new Date().getTime(),o=new de(Dn(),4096,511|C.DIRECTORY,r,r,r);e.put(o.id,Ni(),!1),e.put(Ue,o.toBuffer(),!1),e.commit()}},t.prototype._findINode=function(e,r,o){var s=this,l=function(v){var E=s.getDirListing(e,r,v);if(E[o])return E[o];throw u.ENOENT(g.resolve(r,o))};return r==="/"?o===""?Ue:l(this.getINode(e,r,Ue)):l(this.getINode(e,r+g.sep+o,this._findINode(e,g.dirname(r),g.basename(r))))},t.prototype.findINode=function(e,r){return this.getINode(e,r,this._findINode(e,g.dirname(r),g.basename(r)))},t.prototype.getINode=function(e,r,o){var s=e.get(o);if(s===void 0)throw u.ENOENT(r);return de.fromBuffer(s)},t.prototype.getDirListing=function(e,r,o){if(!o.isDirectory())throw u.ENOTDIR(r);var s=e.get(o.id);if(s===void 0)throw u.ENOENT(r);return JSON.parse(s.toString())},t.prototype.addNewNode=function(e,r){for(var o=0,s;o<5;)try{return s=Dn(),e.put(s,r,!1),s}catch{}throw new u(a.EIO,"Unable to commit data to key-value store.")},t.prototype.commitNewFile=function(e,r,o,s,l){var v=g.dirname(r),E=g.basename(r),D=this.findINode(e,v),M=this.getDirListing(e,v,D),q=new Date().getTime();if(r==="/"||M[E])throw u.EEXIST(r);var $;try{var nt=this.addNewNode(e,l);$=new de(nt,l.length,s|o,q,q,q);var ut=this.addNewNode(e,$.toBuffer());M[E]=ut,e.put(D.id,m.from(JSON.stringify(M)),!0)}catch(yt){throw e.abort(),yt}return e.commit(),$},t.prototype.removeEntry=function(e,r){var o=this.store.beginTransaction("readwrite"),s=g.dirname(e),l=this.findINode(o,s),v=this.getDirListing(o,s,l),E=g.basename(e);if(!v[E])throw u.ENOENT(e);var D=v[E];delete v[E];var M=this.getINode(o,e,D);if(!r&&M.isDirectory())throw u.EISDIR(e);if(r&&!M.isDirectory())throw u.ENOTDIR(e);try{o.del(M.id),o.del(D),o.put(l.id,m.from(JSON.stringify(v)),!0)}catch(q){throw o.abort(),q}o.commit()},t})(ne),Ai=(function(i){function t(n,e,r,o,s){i.call(this,n,e,r,o,s)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var r=this;this.isDirty()?this._fs._sync(this.getPath(),this.getBuffer(),this.getStats(),function(o){o||r.resetDirty(),e(o)}):e()},t.prototype.close=function(e){this.sync(e)},t})(oe),ns=(function(i){function t(){i.apply(this,arguments)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.init=function(e,r){this.store=e,this.makeRootDirectory(r)},t.prototype.getName=function(){return this.store.name()},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.empty=function(e){var r=this;this.store.clear(function(o){ve(o,e)&&r.makeRootDirectory(e)})},t.prototype.rename=function(e,r,o){var s=this,l=this.store.beginTransaction("readwrite"),v=g.dirname(e),E=g.basename(e),D=g.dirname(r),M=g.basename(r),q={},$={},nt=!1;if((D+"/").indexOf(e+"/")===0)return o(new u(a.EBUSY,v));var ut=function(){if(!(nt||!$.hasOwnProperty(v)||!$.hasOwnProperty(D))){var It=$[v],Gt=q[v],ae=$[D],Fe=q[D];if(!It[E])o(u.ENOENT(e));else{var Te=It[E];delete It[E];var un=function(){ae[M]=Te,l.put(Gt.id,m.from(JSON.stringify(It)),!0,function(Pe){$t(Pe,l,o)&&(v===D?l.commit(o):l.put(Fe.id,m.from(JSON.stringify(ae)),!0,function(Be){$t(Be,l,o)&&l.commit(o)}))})};ae[M]?s.getINode(l,r,ae[M],function(Pe,Be){$t(Pe,l,o)&&(Be.isFile()?l.del(Be.id,function(_r){$t(_r,l,o)&&l.del(ae[M],function(Ts){$t(Ts,l,o)&&un()})}):l.abort(function(_r){o(u.EPERM(r))}))}):un()}}},yt=function(It){s.findINodeAndDirListing(l,It,function(Gt,ae,Fe){Gt?nt||(nt=!0,l.abort(function(){o(Gt)})):(q[It]=ae,$[It]=Fe,ut())})};yt(v),v!==D&&yt(D)},t.prototype.stat=function(e,r,o){var s=this.store.beginTransaction("readonly");this.findINode(s,e,function(l,v){ve(l,o)&&o(null,v.toStats())})},t.prototype.createFile=function(e,r,o,s){var l=this,v=this.store.beginTransaction("readwrite"),E=Mt();this.commitNewFile(v,e,C.FILE,o,E,function(D,M){ve(D,s)&&s(null,new Ai(l,e,r,M.toStats(),E))})},t.prototype.openFile=function(e,r,o){var s=this,l=this.store.beginTransaction("readonly");this.findINode(l,e,function(v,E){ve(v,o)&&l.get(E.id,function(D,M){ve(D,o)&&(M===void 0?o(u.ENOENT(e)):o(null,new Ai(s,e,r,E.toStats(),M)))})})},t.prototype.unlink=function(e,r){this.removeEntry(e,!1,r)},t.prototype.rmdir=function(e,r){var o=this;this.readdir(e,function(s,l){s?r(s):l.length>0?r(u.ENOTEMPTY(e)):o.removeEntry(e,!0,r)})},t.prototype.mkdir=function(e,r,o){var s=this.store.beginTransaction("readwrite"),l=m.from("{}");this.commitNewFile(s,e,C.DIRECTORY,r,l,o)},t.prototype.readdir=function(e,r){var o=this,s=this.store.beginTransaction("readonly");this.findINode(s,e,function(l,v){ve(l,r)&&o.getDirListing(s,e,v,function(E,D){ve(E,r)&&r(null,Object.keys(D))})})},t.prototype._sync=function(e,r,o,s){var l=this,v=this.store.beginTransaction("readwrite");this._findINode(v,g.dirname(e),g.basename(e),function(E,D){$t(E,v,s)&&l.getINode(v,e,D,function(M,q){if($t(M,v,s)){var $=q.update(o);v.put(q.id,r,!0,function(nt){$t(nt,v,s)&&($?v.put(D,q.toBuffer(),!0,function(ut){$t(ut,v,s)&&v.commit(s)}):v.commit(s))})}})})},t.prototype.makeRootDirectory=function(e){var r=this.store.beginTransaction("readwrite");r.get(Ue,function(o,s){if(o||s===void 0){var l=new Date().getTime(),v=new de(Dn(),4096,511|C.DIRECTORY,l,l,l);r.put(v.id,Ni(),!1,function(E){$t(E,r,e)&&r.put(Ue,v.toBuffer(),!1,function(D){D?r.abort(function(){e(D)}):r.commit(e)})})}else r.commit(e)})},t.prototype._findINode=function(e,r,o,s){var l=this,v=function(E,D,M){E?s(E):M[o]?s(null,M[o]):s(u.ENOENT(g.resolve(r,o)))};r==="/"?o===""?s(null,Ue):this.getINode(e,r,Ue,function(E,D){ve(E,s)&&l.getDirListing(e,r,D,function(M,q){v(M,D,q)})}):this.findINodeAndDirListing(e,r,v)},t.prototype.findINode=function(e,r,o){var s=this;this._findINode(e,g.dirname(r),g.basename(r),function(l,v){ve(l,o)&&s.getINode(e,r,v,o)})},t.prototype.getINode=function(e,r,o,s){e.get(o,function(l,v){ve(l,s)&&(v===void 0?s(u.ENOENT(r)):s(null,de.fromBuffer(v)))})},t.prototype.getDirListing=function(e,r,o,s){o.isDirectory()?e.get(o.id,function(l,v){if(ve(l,s))try{s(null,JSON.parse(v.toString()))}catch{s(u.ENOENT(r))}}):s(u.ENOTDIR(r))},t.prototype.findINodeAndDirListing=function(e,r,o){var s=this;this.findINode(e,r,function(l,v){ve(l,o)&&s.getDirListing(e,r,v,function(E,D){ve(E,o)&&o(null,v,D)})})},t.prototype.addNewNode=function(e,r,o){var s=0,l,v=function(){++s===5?o(new u(a.EIO,"Unable to commit data to key-value store.")):(l=Dn(),e.put(l,r,!1,function(E,D){E||!D?v():o(null,l)}))};v()},t.prototype.commitNewFile=function(e,r,o,s,l,v){var E=this,D=g.dirname(r),M=g.basename(r),q=new Date().getTime();if(r==="/")return v(u.EEXIST(r));this.findINodeAndDirListing(e,D,function($,nt,ut){$t($,e,v)&&(ut[M]?e.abort(function(){v(u.EEXIST(r))}):E.addNewNode(e,l,function(yt,It){if($t(yt,e,v)){var Gt=new de(It,l.length,s|o,q,q,q);E.addNewNode(e,Gt.toBuffer(),function(ae,Fe){$t(ae,e,v)&&(ut[M]=Fe,e.put(nt.id,m.from(JSON.stringify(ut)),!0,function(Te){$t(Te,e,v)&&e.commit(function(un){$t(un,e,v)&&v(null,Gt)})}))})}}))})},t.prototype.removeEntry=function(e,r,o){var s=this,l=this.store.beginTransaction("readwrite"),v=g.dirname(e),E=g.basename(e);this.findINodeAndDirListing(l,v,function(D,M,q){if($t(D,l,o))if(!q[E])l.abort(function(){o(u.ENOENT(e))});else{var $=q[E];delete q[E],s.getINode(l,e,$,function(nt,ut){$t(nt,l,o)&&(!r&&ut.isDirectory()?l.abort(function(){o(u.EISDIR(e))}):r&&!ut.isDirectory()?l.abort(function(){o(u.ENOTDIR(e))}):l.del(ut.id,function(yt){$t(yt,l,o)&&l.del($,function(It){$t(It,l,o)&&l.put(M.id,m.from(JSON.stringify(q)),!0,function(Gt){$t(Gt,l,o)&&l.commit(o)})})}))})}})},t})(Q),Xe=function(){this.store={}};Xe.prototype.name=function(){return rn.Name},Xe.prototype.clear=function(){this.store={}},Xe.prototype.beginTransaction=function(t){return new Ce(this)},Xe.prototype.get=function(t){return this.store[t]},Xe.prototype.put=function(t,n,e){return!e&&this.store.hasOwnProperty(t)?!1:(this.store[t]=n,!0)},Xe.prototype.del=function(t){delete this.store[t]};var rn=(function(i){function t(){i.call(this,{store:new Xe})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){r(null,new t)},t})(Ci);rn.Name="InMemory",rn.Options={};var $n=Jt.indexedDB||Jt.mozIndexedDB||Jt.webkitIndexedDB||Jt.msIndexedDB;function pn(i,t){switch(t===void 0&&(t=i.toString()),i.name){case"NotFoundError":return new u(a.ENOENT,t);case"QuotaExceededError":return new u(a.ENOSPC,t);default:return new u(a.EIO,t)}}function dn(i,t,n){return t===void 0&&(t=a.EIO),n===void 0&&(n=null),function(e){e.preventDefault(),i(new u(t,n!==null?n:void 0))}}var ti=function(t,n){this.tx=t,this.store=n};ti.prototype.get=function(t,n){try{var e=this.store.get(t);e.onerror=dn(n),e.onsuccess=function(r){var o=r.target.result;o===void 0?n(null,o):n(null,_t(o))}}catch(r){n(pn(r))}};var is=(function(i){function t(n,e){i.call(this,n,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.put=function(e,r,o,s){try{var l=K(r),v;o?v=this.store.put(l,e):v=this.store.add(l,e),v.onerror=dn(s),v.onsuccess=function(E){s(null,!0)}}catch(E){s(pn(E))}},t.prototype.del=function(e,r){try{var o=this.store.delete(e);o.onerror=dn(r),o.onsuccess=function(s){r()}}catch(s){r(pn(s))}},t.prototype.commit=function(e){setTimeout(e,0)},t.prototype.abort=function(e){var r=null;try{this.tx.abort()}catch(o){r=pn(o)}finally{e(r)}},t})(ti),Cn=function(t,n){var e=this;n===void 0&&(n="browserfs"),this.storeName=n;var r=$n.open(this.storeName,1);r.onupgradeneeded=function(o){var s=o.target.result;s.objectStoreNames.contains(e.storeName)&&s.deleteObjectStore(e.storeName),s.createObjectStore(e.storeName)},r.onsuccess=function(o){e.db=o.target.result,t(null,e)},r.onerror=dn(t,a.EACCES)};Cn.prototype.name=function(){return yn.Name+" - "+this.storeName},Cn.prototype.clear=function(t){try{var n=this.db.transaction(this.storeName,"readwrite"),e=n.objectStore(this.storeName),r=e.clear();r.onsuccess=function(o){setTimeout(t,0)},r.onerror=dn(t)}catch(o){t(pn(o))}},Cn.prototype.beginTransaction=function(t){t===void 0&&(t="readonly");var n=this.db.transaction(this.storeName,t),e=n.objectStore(this.storeName);if(t==="readwrite")return new is(n,e);if(t==="readonly")return new ti(n,e);throw new u(a.EINVAL,"Invalid transaction type.")};var yn=(function(i){function t(n,e,r){var o=this;r===void 0&&(r=!0),i.call(this),this.store=new Cn(function(s){s?n(s):o.init(o.store,function(l){n(l,o)})},e),Lt(r,t.Name,{storeName:e})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){new t(r,e.storeName,!1)},t.isAvailable=function(){try{return typeof $n<"u"&&$n.open("__browserfs_test__")!==null}catch{return!1}},t})(ns);yn.Name="IndexedDB",yn.Options={storeName:{type:"string",optional:!0,description:"The name of this file system. You can have multiple IndexedDB file systems operating at once, but each must have a different name."}};var ei=!1,mn;try{Jt.localStorage.setItem("__test__","\uD800"),ei=Jt.localStorage.getItem("__test__")==="\uD800"}catch{ei=!1}mn=ei?"binary_string":"binary_string_ie",m.isEncoding(mn)||(mn="base64");var Ye=function(){};Ye.prototype.name=function(){return vn.Name},Ye.prototype.clear=function(){Jt.localStorage.clear()},Ye.prototype.beginTransaction=function(t){return new Ce(this)},Ye.prototype.get=function(t){try{var n=Jt.localStorage.getItem(t);if(n!==null)return m.from(n,mn)}catch{}},Ye.prototype.put=function(t,n,e){try{return!e&&Jt.localStorage.getItem(t)!==null?!1:(Jt.localStorage.setItem(t,n.toString(mn)),!0)}catch{throw new u(a.ENOSPC,"LocalStorage is full.")}},Ye.prototype.del=function(t){try{Jt.localStorage.removeItem(t)}catch(n){throw new u(a.EIO,"Unable to delete key "+t+": "+n)}};var vn=(function(i){function t(){i.call(this,{store:new Ye})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){r(null,new t)},t.isAvailable=function(){return typeof Jt.localStorage<"u"},t})(Ci);vn.Name="LocalStorage",vn.Options={};var on=(function(i){function t(){i.call(this),this.mountList=[],this.mntMap={},this.rootFs=new rn}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){var o=new t;Object.keys(e).forEach(function(s){o.mount(s,e[s])}),r(null,o)},t.isAvailable=function(){return!0},t.prototype.mount=function(e,r){if(e[0]!=="/"&&(e="/"+e),e=g.resolve(e),this.mntMap[e])throw new u(a.EINVAL,"Mount point "+e+" is already taken.");U(e,511,this.rootFs),this.mntMap[e]=r,this.mountList.push(e),this.mountList=this.mountList.sort(function(o,s){return s.length-o.length})},t.prototype.umount=function(e){var r=this;if(e[0]!=="/"&&(e="/"+e),e=g.resolve(e),!this.mntMap[e])throw new u(a.EINVAL,"Mount point "+e+" is already unmounted.");for(delete this.mntMap[e],this.mountList.splice(this.mountList.indexOf(e),1);e!=="/"&&r.rootFs.readdirSync(e).length===0;)r.rootFs.rmdirSync(e),e=g.dirname(e)},t.prototype._getFs=function(e){for(var r=this,o=this.mountList,s=o.length,l=0;l<s;l++){var v=o[l];if(v.length<=e.length&&e.indexOf(v)===0)return e=e.substr(v.length>1?v.length:0),e===""&&(e="/"),{fs:r.mntMap[v],path:e}}return{fs:this.rootFs,path:e}},t.prototype.getName=function(){return t.Name},t.prototype.diskSpace=function(e,r){r(0,0)},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.standardizeError=function(e,r,o){var s=e.message.indexOf(r);return s!==-1&&(e.message=e.message.substr(0,s)+o+e.message.substr(s+r.length),e.path=o),e},t.prototype.rename=function(e,r,o){var s=this,l=this._getFs(e),v=this._getFs(r);return l.fs===v.fs?l.fs.rename(l.path,v.path,function(E){E&&s.standardizeError(s.standardizeError(E,l.path,e),v.path,r),o(E)}):lt.readFile(e,function(E,D){if(E)return o(E);lt.writeFile(r,D,function(M){if(M)return o(M);lt.unlink(e,o)})})},t.prototype.renameSync=function(e,r){var o=this._getFs(e),s=this._getFs(r);if(o.fs===s.fs)try{return o.fs.renameSync(o.path,s.path)}catch(v){throw this.standardizeError(this.standardizeError(v,o.path,e),s.path,r),v}var l=lt.readFileSync(e);return lt.writeFileSync(r,l),lt.unlinkSync(e)},t.prototype.readdirSync=function(e){var r=this._getFs(e),o=null;if(r.fs!==this.rootFs)try{o=this.rootFs.readdirSync(e)}catch{}try{var s=r.fs.readdirSync(r.path);return o===null?s:s.concat(o.filter(function(l){return s.indexOf(l)===-1}))}catch(l){if(o===null)throw this.standardizeError(l,r.path,e);return o}},t.prototype.readdir=function(e,r){var o=this,s=this._getFs(e);s.fs.readdir(s.path,function(l,v){if(s.fs!==o.rootFs)try{var E=o.rootFs.readdirSync(e);v?v=v.concat(E.filter(function(D){return v.indexOf(D)===-1})):v=E}catch{if(l)return r(o.standardizeError(l,s.path,e))}else if(l)return r(o.standardizeError(l,s.path,e));r(null,v)})},t.prototype.rmdirSync=function(e){var r=this._getFs(e);if(this._containsMountPt(e))throw u.ENOTEMPTY(e);try{r.fs.rmdirSync(r.path)}catch(o){throw this.standardizeError(o,r.path,e)}},t.prototype.rmdir=function(e,r){var o=this,s=this._getFs(e);this._containsMountPt(e)?r(u.ENOTEMPTY(e)):s.fs.rmdir(s.path,function(l){r(l?o.standardizeError(l,s.path,e):null)})},t.prototype._containsMountPt=function(e){for(var r=this.mountList,o=r.length,s=0;s<o;s++){var l=r[s];if(l.length>=e.length&&l.slice(0,e.length)===e)return!0}return!1},t})(Q);on.Name="MountableFileSystem",on.Options={};function Mi(i,t,n){return t?function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];var o=e[0],s=this._getFs(o);e[0]=s.path;try{return s.fs[i].apply(s.fs,e)}catch(l){throw this.standardizeError(l,s.path,o),l}}:function(){for(var e=this,r=[],o=arguments.length;o--;)r[o]=arguments[o];var s=r[0],l=this._getFs(s);if(r[0]=l.path,typeof r[r.length-1]=="function"){var v=r[r.length-1];r[r.length-1]=function(){for(var E=[],D=arguments.length;D--;)E[D]=arguments[D];E.length>0&&E[0]instanceof u&&e.standardizeError(E[0],l.path,s),v.apply(null,E)}}return l.fs[i].apply(l.fs,r)}}for(var Pi=[["exists","unlink","readlink"],["stat","mkdir","realpath","truncate"],["open","readFile","chmod","utimes"],["chown"],["writeFile","appendFile"]],ni=0;ni<Pi.length;ni++)for(var rs=Pi[ni],ii=0,Bi=rs;ii<Bi.length;ii+=1){var An=Bi[ii];on.prototype[An]=Mi(An,!1),on.prototype[An+"Sync"]=Mi(An+"Sync",!0)}var gn;if(typeof setImmediate<"u")gn=setImmediate;else{var Ee=Jt,sn=[],Ui="zero-timeout-message",os=function(){if(typeof Ee.importScripts<"u"||!Ee.postMessage)return!1;var i=!0,t=Ee.onmessage;return Ee.onmessage=function(){i=!1},Ee.postMessage("","*"),Ee.onmessage=t,i};if(os()){gn=function(i){sn.push(i),Ee.postMessage(Ui,"*")};var zi=function(i){if(i.source===self&&i.data===Ui&&(i.stopPropagation?i.stopPropagation():i.cancelBubble=!0,sn.length>0)){var t=sn.shift();return t()}};Ee.addEventListener?Ee.addEventListener("message",zi,!0):Ee.attachEvent("onmessage",zi)}else if(Ee.MessageChannel){var ji=new Ee.MessageChannel;ji.port1.onmessage=function(i){if(sn.length>0)return sn.shift()()},gn=function(i){sn.push(i),ji.port2.postMessage("")}}else gn=function(i){return setTimeout(i,0)}}var ri=gn,wn=function(){this._locked=!1,this._waiters=[]};wn.prototype.lock=function(t){if(this._locked){this._waiters.push(t);return}this._locked=!0,t()},wn.prototype.unlock=function(){if(!this._locked)throw new Error("unlock of a non-locked mutex");var t=this._waiters.shift();if(t){ri(t);return}this._locked=!1},wn.prototype.tryLock=function(){return this._locked?!1:(this._locked=!0,!0)},wn.prototype.isLocked=function(){return this._locked};var wt=function(t){this._fs=t,this._mu=new wn};wt.prototype.getName=function(){return"LockedFS<"+this._fs.getName()+">"},wt.prototype.getFSUnlocked=function(){return this._fs},wt.prototype.initialize=function(t){this._fs.initialize(t)},wt.prototype.diskSpace=function(t,n){this._fs.diskSpace(t,n)},wt.prototype.isReadOnly=function(){return this._fs.isReadOnly()},wt.prototype.supportsLinks=function(){return this._fs.supportsLinks()},wt.prototype.supportsProps=function(){return this._fs.supportsProps()},wt.prototype.supportsSynch=function(){return this._fs.supportsSynch()},wt.prototype.rename=function(t,n,e){var r=this;this._mu.lock(function(){r._fs.rename(t,n,function(o){r._mu.unlock(),e(o)})})},wt.prototype.renameSync=function(t,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.renameSync(t,n)},wt.prototype.stat=function(t,n,e){var r=this;this._mu.lock(function(){r._fs.stat(t,n,function(o,s){r._mu.unlock(),e(o,s)})})},wt.prototype.statSync=function(t,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.statSync(t,n)},wt.prototype.open=function(t,n,e,r){var o=this;this._mu.lock(function(){o._fs.open(t,n,e,function(s,l){o._mu.unlock(),r(s,l)})})},wt.prototype.openSync=function(t,n,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.openSync(t,n,e)},wt.prototype.unlink=function(t,n){var e=this;this._mu.lock(function(){e._fs.unlink(t,function(r){e._mu.unlock(),n(r)})})},wt.prototype.unlinkSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.unlinkSync(t)},wt.prototype.rmdir=function(t,n){var e=this;this._mu.lock(function(){e._fs.rmdir(t,function(r){e._mu.unlock(),n(r)})})},wt.prototype.rmdirSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.rmdirSync(t)},wt.prototype.mkdir=function(t,n,e){var r=this;this._mu.lock(function(){r._fs.mkdir(t,n,function(o){r._mu.unlock(),e(o)})})},wt.prototype.mkdirSync=function(t,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.mkdirSync(t,n)},wt.prototype.readdir=function(t,n){var e=this;this._mu.lock(function(){e._fs.readdir(t,function(r,o){e._mu.unlock(),n(r,o)})})},wt.prototype.readdirSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readdirSync(t)},wt.prototype.exists=function(t,n){var e=this;this._mu.lock(function(){e._fs.exists(t,function(r){e._mu.unlock(),n(r)})})},wt.prototype.existsSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.existsSync(t)},wt.prototype.realpath=function(t,n,e){var r=this;this._mu.lock(function(){r._fs.realpath(t,n,function(o,s){r._mu.unlock(),e(o,s)})})},wt.prototype.realpathSync=function(t,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.realpathSync(t,n)},wt.prototype.truncate=function(t,n,e){var r=this;this._mu.lock(function(){r._fs.truncate(t,n,function(o){r._mu.unlock(),e(o)})})},wt.prototype.truncateSync=function(t,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.truncateSync(t,n)},wt.prototype.readFile=function(t,n,e,r){var o=this;this._mu.lock(function(){o._fs.readFile(t,n,e,function(s,l){o._mu.unlock(),r(s,l)})})},wt.prototype.readFileSync=function(t,n,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readFileSync(t,n,e)},wt.prototype.writeFile=function(t,n,e,r,o,s){var l=this;this._mu.lock(function(){l._fs.writeFile(t,n,e,r,o,function(v){l._mu.unlock(),s(v)})})},wt.prototype.writeFileSync=function(t,n,e,r,o){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.writeFileSync(t,n,e,r,o)},wt.prototype.appendFile=function(t,n,e,r,o,s){var l=this;this._mu.lock(function(){l._fs.appendFile(t,n,e,r,o,function(v){l._mu.unlock(),s(v)})})},wt.prototype.appendFileSync=function(t,n,e,r,o){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.appendFileSync(t,n,e,r,o)},wt.prototype.chmod=function(t,n,e,r){var o=this;this._mu.lock(function(){o._fs.chmod(t,n,e,function(s){o._mu.unlock(),r(s)})})},wt.prototype.chmodSync=function(t,n,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chmodSync(t,n,e)},wt.prototype.chown=function(t,n,e,r,o){var s=this;this._mu.lock(function(){s._fs.chown(t,n,e,r,function(l){s._mu.unlock(),o(l)})})},wt.prototype.chownSync=function(t,n,e,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chownSync(t,n,e,r)},wt.prototype.utimes=function(t,n,e,r){var o=this;this._mu.lock(function(){o._fs.utimes(t,n,e,function(s){o._mu.unlock(),r(s)})})},wt.prototype.utimesSync=function(t,n,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.utimesSync(t,n,e)},wt.prototype.link=function(t,n,e){var r=this;this._mu.lock(function(){r._fs.link(t,n,function(o){r._mu.unlock(),e(o)})})},wt.prototype.linkSync=function(t,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.linkSync(t,n)},wt.prototype.symlink=function(t,n,e,r){var o=this;this._mu.lock(function(){o._fs.symlink(t,n,e,function(s){o._mu.unlock(),r(s)})})},wt.prototype.symlinkSync=function(t,n,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.symlinkSync(t,n,e)},wt.prototype.readlink=function(t,n){var e=this;this._mu.lock(function(){e._fs.readlink(t,function(r,o){e._mu.unlock(),n(r,o)})})},wt.prototype.readlinkSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readlinkSync(t)};var Ae="/.deletedFiles.log";function Wi(i){return 146|i}function ge(i){return O.getFileFlag(i)}var Hi=(function(i){function t(n,e,r,o,s){i.call(this,n,e,r,o,s)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var r=this;if(!this.isDirty()){e(null);return}this._fs._syncAsync(this,function(o){r.resetDirty(),e(o)})},t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},t.prototype.close=function(e){this.sync(e)},t.prototype.closeSync=function(){this.syncSync()},t})(oe),qi=(function(i){function t(n,e){if(i.call(this),this._isInitialized=!1,this._initializeCallbacks=[],this._deletedFiles={},this._deleteLog="",this._deleteLogUpdatePending=!1,this._deleteLogUpdateNeeded=!1,this._deleteLogError=null,this._writable=n,this._readable=e,this._writable.isReadOnly())throw new u(a.EINVAL,"Writable file system must be writable.")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.getOverlayedFileSystems=function(){return{readable:this._readable,writable:this._writable}},t.prototype._syncAsync=function(e,r){var o=this;this.createParentDirectoriesAsync(e.getPath(),function(s){if(s)return r(s);o._writable.writeFile(e.getPath(),e.getBuffer(),null,ge("w"),e.getStats().mode,r)})},t.prototype._syncSync=function(e){this.createParentDirectories(e.getPath()),this._writable.writeFileSync(e.getPath(),e.getBuffer(),null,ge("w"),e.getStats().mode)},t.prototype.getName=function(){return Sn.Name},t.prototype.initialize=function(e){var r=this,o=this._initializeCallbacks,s=function(l){r._isInitialized=!l,r._initializeCallbacks=[],o.forEach((function(v){return v(l)}))};if(this._isInitialized)return e();o.push(e),o.length===1&&this._writable.readFile(Ae,"utf8",ge("r"),function(l,v){if(l){if(l.errno!==a.ENOENT)return s(l)}else r._deleteLog=v;r._reparseDeletionLog(),s()})},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSynch=function(){return this._readable.supportsSynch()&&this._writable.supportsSynch()},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return this._readable.supportsProps()&&this._writable.supportsProps()},t.prototype.getDeletionLog=function(){return this._deleteLog},t.prototype.restoreDeletionLog=function(e){this._deleteLog=e,this._reparseDeletionLog(),this.updateLog("")},t.prototype.rename=function(e,r,o){var s=this;if(!(!this.checkInitAsync(o)||this.checkPathAsync(e,o)||this.checkPathAsync(r,o))){if(e===Ae||r===Ae)return o(u.EPERM("Cannot rename deletion log."));if(e===r)return o();this.stat(e,!1,function(l,v){return l?o(l):s.stat(r,!1,function(E,D){var M=s;function q(nt){var ut=nt.shift();if(!ut)return o();var yt=g.resolve(e,ut),It=g.resolve(r,ut);M.rename(yt,It,function(Gt){if(Gt)return o(Gt);q(nt)})}var $=511;if(v.isDirectory()){if(E)return E.errno!==a.ENOENT?o(E):s._writable.exists(e,function(nt){if(nt)return s._writable.rename(e,r,o);s._writable.mkdir(r,$,function(ut){if(ut)return o(ut);s._readable.readdir(e,function(yt,It){if(yt)return o();q(It)})})});if($=D.mode,!D.isDirectory())return o(u.ENOTDIR(r));s.readdir(r,function(nt,ut){if(ut&&ut.length)return o(u.ENOTEMPTY(r));s._readable.readdir(e,function(yt,It){if(yt)return o();q(It)})})}if(D&&D.isDirectory())return o(u.EISDIR(r));s.readFile(e,null,ge("r"),function(nt,ut){return nt?o(nt):s.writeFile(r,ut,null,ge("w"),v.mode,function(yt){return yt?o(yt):s.unlink(e,o)})})})})}},t.prototype.renameSync=function(e,r){var o=this;if(this.checkInitialized(),this.checkPath(e),this.checkPath(r),e===Ae||r===Ae)throw u.EPERM("Cannot rename deletion log.");var s=this.statSync(e,!1);if(s.isDirectory()){if(e===r)return;var l=511;if(this.existsSync(r)){var v=this.statSync(r,!1);if(l=v.mode,v.isDirectory()){if(this.readdirSync(r).length>0)throw u.ENOTEMPTY(r)}else throw u.ENOTDIR(r)}this._writable.existsSync(e)?this._writable.renameSync(e,r):this._writable.existsSync(r)||this._writable.mkdirSync(r,l),this._readable.existsSync(e)&&this._readable.readdirSync(e).forEach(function(E){o.renameSync(g.resolve(e,E),g.resolve(r,E))})}else{if(this.existsSync(r)&&this.statSync(r,!1).isDirectory())throw u.EISDIR(r);this.writeFileSync(r,this.readFileSync(e,null,ge("r")),null,ge("w"),s.mode)}e!==r&&this.existsSync(e)&&this.unlinkSync(e)},t.prototype.stat=function(e,r,o){var s=this;this.checkInitAsync(o)&&this._writable.stat(e,r,function(l,v){l&&l.errno===a.ENOENT?(s._deletedFiles[e]&&o(u.ENOENT(e)),s._readable.stat(e,r,function(E,D){D&&(D=D.clone(),D.mode=Wi(D.mode)),o(E,D)})):o(l,v)})},t.prototype.statSync=function(e,r){this.checkInitialized();try{return this._writable.statSync(e,r)}catch{if(this._deletedFiles[e])throw u.ENOENT(e);var o=this._readable.statSync(e,r).clone();return o.mode=Wi(o.mode),o}},t.prototype.open=function(e,r,o,s){var l=this;!this.checkInitAsync(s)||this.checkPathAsync(e,s)||this.stat(e,!1,function(v,E){if(E)switch(r.pathExistsAction()){case x.TRUNCATE_FILE:return l.createParentDirectoriesAsync(e,function(D){if(D)return s(D);l._writable.open(e,r,o,s)});case x.NOP:return l._writable.exists(e,function(D){D?l._writable.open(e,r,o,s):(E=E.clone(),E.mode=o,l._readable.readFile(e,null,ge("r"),function(M,q){if(M)return s(M);E.size===-1&&(E.size=q.length);var $=new Hi(l,e,r,E,q);s(null,$)}))});default:return s(u.EEXIST(e))}else return r.pathNotExistsAction()===x.CREATE_FILE?l.createParentDirectoriesAsync(e,function(D){return D?s(D):l._writable.open(e,r,o,s)}):s(u.ENOENT(e))})},t.prototype.openSync=function(e,r,o){if(this.checkInitialized(),this.checkPath(e),e===Ae)throw u.EPERM("Cannot open deletion log.");if(this.existsSync(e))switch(r.pathExistsAction()){case x.TRUNCATE_FILE:return this.createParentDirectories(e),this._writable.openSync(e,r,o);case x.NOP:if(this._writable.existsSync(e))return this._writable.openSync(e,r,o);var s=this._readable.readFileSync(e,null,ge("r")),l=this._readable.statSync(e,!1).clone();return l.mode=o,new Hi(this,e,r,l,s);default:throw u.EEXIST(e)}else{if(r.pathNotExistsAction()===x.CREATE_FILE)return this.createParentDirectories(e),this._writable.openSync(e,r,o);throw u.ENOENT(e)}},t.prototype.unlink=function(e,r){var o=this;!this.checkInitAsync(r)||this.checkPathAsync(e,r)||this.exists(e,function(s){if(!s)return r(u.ENOENT(e));o._writable.exists(e,function(l){if(l)return o._writable.unlink(e,function(v){if(v)return r(v);o.exists(e,function(E){E&&o.deletePath(e),r(null)})});o.deletePath(e),r(null)})})},t.prototype.unlinkSync=function(e){if(this.checkInitialized(),this.checkPath(e),this.existsSync(e))this._writable.existsSync(e)&&this._writable.unlinkSync(e),this.existsSync(e)&&this.deletePath(e);else throw u.ENOENT(e)},t.prototype.rmdir=function(e,r){var o=this;if(this.checkInitAsync(r)){var s=function(){o.readdir(e,function(l,v){if(l)return r(l);if(v.length)return r(u.ENOTEMPTY(e));o.deletePath(e),r(null)})};this.exists(e,function(l){if(!l)return r(u.ENOENT(e));o._writable.exists(e,function(v){v?o._writable.rmdir(e,function(E){if(E)return r(E);o._readable.exists(e,function(D){D?s():r()})}):s()})})}},t.prototype.rmdirSync=function(e){if(this.checkInitialized(),this.existsSync(e)){if(this._writable.existsSync(e)&&this._writable.rmdirSync(e),this.existsSync(e)){if(this.readdirSync(e).length>0)throw u.ENOTEMPTY(e);this.deletePath(e)}}else throw u.ENOENT(e)},t.prototype.mkdir=function(e,r,o){var s=this;this.checkInitAsync(o)&&this.exists(e,function(l){if(l)return o(u.EEXIST(e));s.createParentDirectoriesAsync(e,function(v){if(v)return o(v);s._writable.mkdir(e,r,o)})})},t.prototype.mkdirSync=function(e,r){if(this.checkInitialized(),this.existsSync(e))throw u.EEXIST(e);this.createParentDirectories(e),this._writable.mkdirSync(e,r)},t.prototype.readdir=function(e,r){var o=this;this.checkInitAsync(r)&&this.stat(e,!1,function(s,l){if(s)return r(s);if(!l.isDirectory())return r(u.ENOTDIR(e));o._writable.readdir(e,function(v,E){if(v&&v.code!=="ENOENT")return r(v);(v||!E)&&(E=[]),o._readable.readdir(e,function(D,M){(D||!M)&&(M=[]);var q={},$=E.concat(M.filter(function(nt){return!o._deletedFiles[e+"/"+nt]})).filter(function(nt){var ut=!q[nt];return q[nt]=!0,ut});r(null,$)})})})},t.prototype.readdirSync=function(e){var r=this;this.checkInitialized();var o=this.statSync(e,!1);if(!o.isDirectory())throw u.ENOTDIR(e);var s=[];try{s=s.concat(this._writable.readdirSync(e))}catch{}try{s=s.concat(this._readable.readdirSync(e).filter(function(v){return!r._deletedFiles[e+"/"+v]}))}catch{}var l={};return s.filter(function(v){var E=!l[v];return l[v]=!0,E})},t.prototype.exists=function(e,r){var o=this;this.checkInitialized(),this._writable.exists(e,function(s){if(s)return r(!0);o._readable.exists(e,function(l){r(l&&o._deletedFiles[e]!==!0)})})},t.prototype.existsSync=function(e){return this.checkInitialized(),this._writable.existsSync(e)||this._readable.existsSync(e)&&this._deletedFiles[e]!==!0},t.prototype.chmod=function(e,r,o,s){var l=this;this.checkInitAsync(s)&&this.operateOnWritableAsync(e,function(v){if(v)return s(v);l._writable.chmod(e,r,o,s)})},t.prototype.chmodSync=function(e,r,o){var s=this;this.checkInitialized(),this.operateOnWritable(e,function(){s._writable.chmodSync(e,r,o)})},t.prototype.chown=function(e,r,o,s,l){var v=this;this.checkInitAsync(l)&&this.operateOnWritableAsync(e,function(E){if(E)return l(E);v._writable.chown(e,r,o,s,l)})},t.prototype.chownSync=function(e,r,o,s){var l=this;this.checkInitialized(),this.operateOnWritable(e,function(){l._writable.chownSync(e,r,o,s)})},t.prototype.utimes=function(e,r,o,s){var l=this;this.checkInitAsync(s)&&this.operateOnWritableAsync(e,function(v){if(v)return s(v);l._writable.utimes(e,r,o,s)})},t.prototype.utimesSync=function(e,r,o){var s=this;this.checkInitialized(),this.operateOnWritable(e,function(){s._writable.utimesSync(e,r,o)})},t.prototype.deletePath=function(e){this._deletedFiles[e]=!0,this.updateLog("d"+e+`
`)},t.prototype.updateLog=function(e){var r=this;this._deleteLog+=e,this._deleteLogUpdatePending?this._deleteLogUpdateNeeded=!0:(this._deleteLogUpdatePending=!0,this._writable.writeFile(Ae,this._deleteLog,"utf8",O.getFileFlag("w"),420,function(o){r._deleteLogUpdatePending=!1,o?r._deleteLogError=o:r._deleteLogUpdateNeeded&&(r._deleteLogUpdateNeeded=!1,r.updateLog(""))}))},t.prototype._reparseDeletionLog=function(){var e=this;this._deletedFiles={},this._deleteLog.split(`
`).forEach(function(r){e._deletedFiles[r.slice(1)]=r.slice(0,1)==="d"})},t.prototype.checkInitialized=function(){if(this._isInitialized){if(this._deleteLogError!==null){var e=this._deleteLogError;throw this._deleteLogError=null,e}}else throw new u(a.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")},t.prototype.checkInitAsync=function(e){if(this._isInitialized){if(this._deleteLogError!==null){var r=this._deleteLogError;return this._deleteLogError=null,e(r),!1}}else return e(new u(a.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")),!1;return!0},t.prototype.checkPath=function(e){if(e===Ae)throw u.EPERM(e)},t.prototype.checkPathAsync=function(e,r){return e===Ae?(r(u.EPERM(e)),!0):!1},t.prototype.createParentDirectoriesAsync=function(e,r){var o=g.dirname(e),s=[],l=this;this._writable.stat(o,!1,v);function v(D,M){D?(s.push(o),o=g.dirname(o),l._writable.stat(o,!1,v)):E()}function E(){if(!s.length)return r();var D=s.pop();l._readable.stat(D,!1,function(M,q){if(!q)return r();l._writable.mkdir(D,q.mode,function($){if($)return r($);E()})})}},t.prototype.createParentDirectories=function(e){for(var r=this,o=g.dirname(e),s=[];!this._writable.existsSync(o);)s.push(o),o=g.dirname(o);s=s.reverse(),s.forEach(function(l){r._writable.mkdirSync(l,r.statSync(l,!1).mode)})},t.prototype.operateOnWritable=function(e,r){if(this.existsSync(e))this._writable.existsSync(e)||this.copyToWritable(e),r();else throw u.ENOENT(e)},t.prototype.operateOnWritableAsync=function(e,r){var o=this;this.exists(e,function(s){if(!s)return r(u.ENOENT(e));o._writable.exists(e,function(l){if(l)r();else return o.copyToWritableAsync(e,r)})})},t.prototype.copyToWritable=function(e){var r=this.statSync(e,!1);r.isDirectory()?this._writable.mkdirSync(e,r.mode):this.writeFileSync(e,this._readable.readFileSync(e,null,ge("r")),null,ge("w"),this.statSync(e,!1).mode)},t.prototype.copyToWritableAsync=function(e,r){var o=this;this.stat(e,!1,function(s,l){if(s)return r(s);if(l.isDirectory())return o._writable.mkdir(e,l.mode,r);o._readable.readFile(e,null,ge("r"),function(v,E){if(v)return r(v);o.writeFile(e,E,null,ge("w"),l.mode,r)})})},t})(Q),Sn=(function(i){function t(n,e,r){r===void 0&&(r=!0),i.call(this,new qi(n,e)),Lt(r,t.Name,{readable:"readable file system",writable:"writable file system"})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){try{var o=new t(e.writable,e.readable,!1);o.initialize(function(s){r(s,o)},!1)}catch(s){r(s)}},t.isAvailable=function(){return qi.isAvailable()},t.prototype.initialize=function(e,r){r===void 0&&(r=!0),r&&console.warn("[OverlayFS] OverlayFS.initialize() is deprecated and will be removed in the next major release. Please use 'OverlayFS.Create({readable: readable file system instance, writable: writable file system instance}, cb)' to create and initialize OverlayFS instances."),i.prototype.initialize.call(this,e)},t.prototype.getOverlayedFileSystems=function(){return i.prototype.getFSUnlocked.call(this).getOverlayedFileSystems()},t.prototype.unwrap=function(){return i.prototype.getFSUnlocked.call(this)},t})(wt);Sn.Name="OverlayFS",Sn.Options={writable:{type:"object",description:"The file system to write modified files to."},readable:{type:"object",description:"The file system that initially populates this file system."}};var qt;(function(i){i[i.CB=0]="CB",i[i.FD=1]="FD",i[i.API_ERROR=2]="API_ERROR",i[i.STATS=3]="STATS",i[i.PROBE=4]="PROBE",i[i.FILEFLAG=5]="FILEFLAG",i[i.BUFFER=6]="BUFFER",i[i.ERROR=7]="ERROR"})(qt||(qt={}));var oi=function(){this._callbacks={},this._nextId=0};oi.prototype.toRemoteArg=function(t){var n=this._nextId++;return this._callbacks[n]=t,{type:qt.CB,id:n}},oi.prototype.toLocalArg=function(t){var n=this._callbacks[t];return delete this._callbacks[t],n};var Mn=function(){this._fileDescriptors={},this._nextId=0};Mn.prototype.toRemoteArg=function(t,n,e,r){var o=this._nextId++,s,l;this._fileDescriptors[o]=t,t.stat(function(v,E){v?r(v):(l=Ze(E.toBuffer()),e.isReadable()?t.read(m.alloc(E.size),0,E.size,0,function(D,M,q){D?r(D):(s=Ze(q),r(null,{type:qt.FD,id:o,data:s,stat:l,path:n,flag:e.getFlagString()}))}):r(null,{type:qt.FD,id:o,data:new ArrayBuffer(0),stat:l,path:n,flag:e.getFlagString()}))})},Mn.prototype.applyFdAPIRequest=function(t,n){var e=this,r=t.args[0];this._applyFdChanges(r,function(o,s){o?n(o):s[t.method](function(l){t.method==="close"&&delete e._fileDescriptors[r.id],n(l)})})},Mn.prototype._applyFdChanges=function(t,n){var e=this._fileDescriptors[t.id],r=Ve(t.data),o=A.fromBuffer(Ve(t.stat)),s=O.getFileFlag(t.flag);s.isWriteable()?e.write(r,0,r.length,s.isAppendable()?e.getPos():0,function(l){function v(){e.stat(function(E,D){E?n(E):D.mode!==o.mode?e.chmod(o.mode,function(M){n(M,e)}):n(E,e)})}l?n(l):s.isAppendable()?v():e.truncate(r.length,function(){v()})}):n(null,e)};function Pn(i){return{type:qt.API_ERROR,errorData:Ze(i.writeToBuffer())}}function Gi(i){return u.fromBuffer(Ve(i.errorData))}function Xi(i){return{type:qt.ERROR,name:i.name,message:i.message,stack:i.stack}}function Yi(i){var t=Jt[i.name];typeof t!="function"&&(t=Error);var n=new t(i.message);return n.stack=i.stack,n}function Zi(i){return{type:qt.STATS,statsData:Ze(i.toBuffer())}}function Vi(i){return A.fromBuffer(Ve(i.statsData))}function Ki(i){return{type:qt.FILEFLAG,flagStr:i.getFlagString()}}function Ji(i){return O.getFileFlag(i.flagStr)}function Ze(i){return K(i)}function Ve(i){return _t(i)}function Qi(i){return{type:qt.BUFFER,data:Ze(i)}}function $i(i){return Ve(i.data)}function ss(i){return i&&typeof i=="object"&&i.hasOwnProperty("browserfsMessage")&&i.browserfsMessage}function as(i){return i&&typeof i=="object"&&i.hasOwnProperty("browserfsMessage")&&i.browserfsMessage}var tr=(function(i){function t(n,e,r,o,s,l){i.call(this,n,e,r,o,l),this._remoteFdId=s}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.getRemoteFdId=function(){return this._remoteFdId},t.prototype.toRemoteArg=function(){return{type:qt.FD,id:this._remoteFdId,data:Ze(this.getBuffer()),stat:Ze(this.getStats().toBuffer()),path:this.getPath(),flag:this.getFlag().getFlagString()}},t.prototype.sync=function(e){this._syncClose("sync",e)},t.prototype.close=function(e){this._syncClose("close",e)},t.prototype._syncClose=function(e,r){var o=this;this.isDirty()?this._fs.syncClose(e,this,function(s){s||o.resetDirty(),r(s)}):r()},t})(oe),Bn=(function(i){function t(n,e){var r=this;e===void 0&&(e=!0),i.call(this),this._callbackConverter=new oi,this._isInitialized=!1,this._isReadOnly=!1,this._supportLinks=!1,this._supportProps=!1,this._worker=n,Lt(e,t.Name,{worker:"Web Worker instance"}),this._worker.addEventListener("message",function(o){var s=o.data;if(as(s)){var l,v=s.args,E=new Array(v.length);for(l=0;l<E.length;l++)E[l]=r._argRemote2Local(v[l]);r._callbackConverter.toLocalArg(s.cbId).apply(null,E)}})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){var o=new t(e.worker,!1);o.initialize(function(){r(null,o)})},t.isAvailable=function(){return typeof importScripts<"u"||typeof Worker<"u"},t.attachRemoteListener=function(e){var r=new Mn;function o(l,v,E){typeof l==="object"?l instanceof A?E(null,Zi(l)):l instanceof u?E(null,Pn(l)):l instanceof vt?E(null,r.toRemoteArg(l,v[0],v[1],E)):l instanceof O?E(null,Ki(l)):l instanceof m?E(null,Qi(l)):l instanceof Error?E(null,Xi(l)):E(null,l):E(null,l)}function s(l,v){if(!l)return l;switch(typeof l){case"object":if(typeof l.type=="number"){var E=l;switch(E.type){case qt.CB:var D=l.id;return function(){var M=arguments,q,$=new Array(arguments.length),nt,ut=arguments.length;function yt(It){ut>0&&(ut=-1,nt={browserfsMessage:!0,cbId:D,args:[Pn(It)]},e.postMessage(nt))}for(q=0;q<arguments.length;q++)(function(It,Gt){o(Gt,v,function(ae,Fe){$[It]=Fe,ae?yt(ae):--ut===0&&(nt={browserfsMessage:!0,cbId:D,args:$},e.postMessage(nt))})})(q,M[q]);arguments.length===0&&(nt={browserfsMessage:!0,cbId:D,args:$},e.postMessage(nt))};case qt.API_ERROR:return Gi(E);case qt.STATS:return Vi(E);case qt.FILEFLAG:return Ji(E);case qt.BUFFER:return $i(E);case qt.ERROR:return Yi(E);default:return l}}else return l;default:return l}}e.addEventListener("message",function(l){var v=l.data;if(ss(v)){var E=v.args,D=new Array(E.length);switch(v.method){case"close":case"sync":(function(){var $=E[1];r.applyFdAPIRequest(v,function(nt){var ut={browserfsMessage:!0,cbId:$.id,args:nt?[Pn(nt)]:[]};e.postMessage(ut)})})();break;case"probe":(function(){var $=lt.getRootFS(),nt=E[1],ut={type:qt.PROBE,isReadOnly:$.isReadOnly(),supportsLinks:$.supportsLinks(),supportsProps:$.supportsProps()},yt={browserfsMessage:!0,cbId:nt.id,args:[ut]};e.postMessage(yt)})();break;default:for(var M=0;M<E.length;M++)D[M]=s(E[M],D);var q=lt.getRootFS();q[v.method].apply(q,D);break}}})},t.prototype.getName=function(){return t.Name},t.prototype.initialize=function(e){var r=this;if(this._isInitialized)e();else{var o={browserfsMessage:!0,method:"probe",args:[this._argLocal2Remote(Mt()),this._callbackConverter.toRemoteArg(function(s){r._isInitialized=!0,r._isReadOnly=s.isReadOnly,r._supportLinks=s.supportsLinks,r._supportProps=s.supportsProps,e()})]};this._worker.postMessage(o)}},t.prototype.isReadOnly=function(){return this._isReadOnly},t.prototype.supportsSynch=function(){return!1},t.prototype.supportsLinks=function(){return this._supportLinks},t.prototype.supportsProps=function(){return this._supportProps},t.prototype.rename=function(e,r,o){this._rpc("rename",arguments)},t.prototype.stat=function(e,r,o){this._rpc("stat",arguments)},t.prototype.open=function(e,r,o,s){this._rpc("open",arguments)},t.prototype.unlink=function(e,r){this._rpc("unlink",arguments)},t.prototype.rmdir=function(e,r){this._rpc("rmdir",arguments)},t.prototype.mkdir=function(e,r,o){this._rpc("mkdir",arguments)},t.prototype.readdir=function(e,r){this._rpc("readdir",arguments)},t.prototype.exists=function(e,r){this._rpc("exists",arguments)},t.prototype.realpath=function(e,r,o){this._rpc("realpath",arguments)},t.prototype.truncate=function(e,r,o){this._rpc("truncate",arguments)},t.prototype.readFile=function(e,r,o,s){this._rpc("readFile",arguments)},t.prototype.writeFile=function(e,r,o,s,l,v){this._rpc("writeFile",arguments)},t.prototype.appendFile=function(e,r,o,s,l,v){this._rpc("appendFile",arguments)},t.prototype.chmod=function(e,r,o,s){this._rpc("chmod",arguments)},t.prototype.chown=function(e,r,o,s,l){this._rpc("chown",arguments)},t.prototype.utimes=function(e,r,o,s){this._rpc("utimes",arguments)},t.prototype.link=function(e,r,o){this._rpc("link",arguments)},t.prototype.symlink=function(e,r,o,s){this._rpc("symlink",arguments)},t.prototype.readlink=function(e,r){this._rpc("readlink",arguments)},t.prototype.syncClose=function(e,r,o){this._worker.postMessage({browserfsMessage:!0,method:e,args:[r.toRemoteArg(),this._callbackConverter.toRemoteArg(o)]})},t.prototype._argRemote2Local=function(e){if(!e)return e;switch(typeof e){case"object":if(typeof e.type=="number"){var r=e;switch(r.type){case qt.API_ERROR:return Gi(r);case qt.FD:var o=r;return new tr(this,o.path,O.getFileFlag(o.flag),A.fromBuffer(Ve(o.stat)),o.id,Ve(o.data));case qt.STATS:return Vi(r);case qt.FILEFLAG:return Ji(r);case qt.BUFFER:return $i(r);case qt.ERROR:return Yi(r);default:return e}}else return e;default:return e}},t.prototype._rpc=function(e,r){for(var o=this,s=new Array(r.length),l=0;l<r.length;l++)s[l]=o._argLocal2Remote(r[l]);var v={browserfsMessage:!0,method:e,args:s};this._worker.postMessage(v)},t.prototype._argLocal2Remote=function(e){if(!e)return e;switch(typeof e){case"object":return e instanceof A?Zi(e):e instanceof u?Pn(e):e instanceof tr?e.toRemoteArg():e instanceof O?Ki(e):e instanceof m?Qi(e):e instanceof Error?Xi(e):"Unknown argument";case"function":return this._callbackConverter.toRemoteArg(e);default:return e}},t})(Q);Bn.Name="WorkerFS",Bn.Options={worker:{type:"object",description:"The target worker that you want to connect to, or the current worker if in a worker context.",validator:function(i,t){i.postMessage?t():t(new u(a.EINVAL,"option must be a Web Worker instance."))}}};function cs(i,t,n){var e=new XMLHttpRequest;e.open("GET",i,!0);var r=!0;switch(t){case"buffer":e.responseType="arraybuffer";break;case"json":try{e.responseType="json",r=e.responseType==="json"}catch{r=!1}break;default:return n(new u(a.EINVAL,"Invalid download type: "+t))}e.onreadystatechange=function(o){if(e.readyState===4)if(e.status===200)switch(t){case"buffer":return n(null,e.response?m.from(e.response):Mt());case"json":return r?n(null,e.response):n(null,JSON.parse(e.responseText))}else return n(new u(e.status,"XHR error."))},e.send()}function ls(i,t){var n=new XMLHttpRequest;n.open("GET",i,!1);var e=null,r=null;if(n.overrideMimeType("text/plain; charset=x-user-defined"),n.onreadystatechange=function(o){if(n.readyState===4)if(n.status===200)switch(t){case"buffer":var s=n.responseText;e=m.alloc(s.length);for(var l=0;l<s.length;l++)e[l]=s.charCodeAt(l);return;case"json":e=JSON.parse(n.responseText);return}else{r=new u(n.status,"XHR error.");return}},n.send(),r)throw r;return e}function us(i,t){var n=new XMLHttpRequest;switch(n.open("GET",i,!1),t){case"buffer":n.responseType="arraybuffer";break;case"json":break;default:throw new u(a.EINVAL,"Invalid download type: "+t)}var e,r;if(n.onreadystatechange=function(o){if(n.readyState===4)if(n.status===200)switch(t){case"buffer":e=m.from(n.response);break;case"json":e=JSON.parse(n.response);break}else r=new u(n.status,"XHR error.")},n.send(),r)throw r;return e}function er(i,t,n){var e=new XMLHttpRequest;e.open("HEAD",t,i),e.onreadystatechange=function(r){if(e.readyState===4)if(e.status===200)try{return n(null,parseInt(e.getResponseHeader("Content-Length")||"-1",10))}catch{return n(new u(a.EIO,"XHR HEAD error: Could not read content-length."))}else return n(new u(e.status,"XHR HEAD error."))},e.send()}var nr=cs,fs=Et&&typeof Blob<"u"?us:ls;function hs(i){var t=-1;return er(!1,i,function(n,e){if(n)throw n;t=e}),t}function ps(i,t){er(!0,i,t)}var _e=function(){this._index={},this.addPath("/",new ye)};_e.fromListing=function(t){var n=new _e,e=new ye;n._index["/"]=e;for(var r=[["",t,e]];r.length>0;){var o=void 0,s=r.pop(),l=s[0],v=s[1],E=s[2];for(var D in v)if(v.hasOwnProperty(D)){var M=v[D],q=l+"/"+D;M?(n._index[q]=o=new ye,r.push([q,M,o])):o=new an(new A(C.FILE,-1,365)),E&&(E._ls[D]=o)}}return n},_e.prototype.fileIterator=function(t){var n=this;for(var e in n._index)if(n._index.hasOwnProperty(e))for(var r=n._index[e],o=r.getListing(),s=0,l=o;s<l.length;s+=1){var v=l[s],E=r.getItem(v);Me(E)&&t(E.getData())}},_e.prototype.addPath=function(t,n){if(!n)throw new Error("Inode must be specified");if(t[0]!=="/")throw new Error("Path must be absolute, got: "+t);if(this._index.hasOwnProperty(t))return this._index[t]===n;var e=this._split_path(t),r=e[0],o=e[1],s=this._index[r];return s===void 0&&t!=="/"&&(s=new ye,!this.addPath(r,s))||t!=="/"&&!s.addItem(o,n)?!1:(ze(n)&&(this._index[t]=n),!0)},_e.prototype.addPathFast=function(t,n){var e=t.lastIndexOf("/"),r=e===0?"/":t.substring(0,e),o=t.substring(e+1),s=this._index[r];return s===void 0&&(s=new ye,this.addPathFast(r,s)),s.addItem(o,n)?(n.isDir()&&(this._index[t]=n),!0):!1},_e.prototype.removePath=function(t){var n=this,e=this._split_path(t),r=e[0],o=e[1],s=this._index[r];if(s===void 0)return null;var l=s.remItem(o);if(l===null)return null;if(ze(l)){for(var v=l.getListing(),E=0,D=v;E<D.length;E+=1){var M=D[E];n.removePath(t+"/"+M)}t!=="/"&&delete this._index[t]}return l},_e.prototype.ls=function(t){var n=this._index[t];return n===void 0?null:n.getListing()},_e.prototype.getInode=function(t){var n=this._split_path(t),e=n[0],r=n[1],o=this._index[e];return o===void 0?null:e===t?o:o.getItem(r)},_e.prototype._split_path=function(t){var n=g.dirname(t),e=t.substr(n.length+(n==="/"?0:1));return[n,e]};var an=function(t){this.data=t};an.prototype.isFile=function(){return!0},an.prototype.isDir=function(){return!1},an.prototype.getData=function(){return this.data},an.prototype.setData=function(t){this.data=t};var ye=function(t){t===void 0&&(t=null),this.data=t,this._ls={}};ye.prototype.isFile=function(){return!1},ye.prototype.isDir=function(){return!0},ye.prototype.getData=function(){return this.data},ye.prototype.getStats=function(){return new A(C.DIRECTORY,4096,365)},ye.prototype.getListing=function(){return Object.keys(this._ls)},ye.prototype.getItem=function(t){var n=this._ls[t];return n||null},ye.prototype.addItem=function(t,n){return t in this._ls?!1:(this._ls[t]=n,!0)},ye.prototype.remItem=function(t){var n=this._ls[t];return n===void 0?null:(delete this._ls[t],n)};function Me(i){return!!i&&i.isFile()}function ze(i){return!!i&&i.isDir()}function ds(i,t,n){try{n(null,i.toString(t))}catch(e){n(e)}}var Un=(function(i){function t(n,e,r){e===void 0&&(e=""),r===void 0&&(r=!0),i.call(this),n||(n="index.json"),e.length>0&&e.charAt(e.length-1)!=="/"&&(e=e+"/"),this.prefixUrl=e;var o=null;if(typeof n=="string"){if(o=this._requestFileSync(n,"json"),!o)throw new Error("Unable to find listing at URL: ${listingUrlOrObj}")}else o=n;Lt(r,t.Name,{index:typeof n=="string"?n:"file index as an object",baseUrl:e}),this._index=_e.fromListing(o)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){e.index===void 0&&(e.index="index.json"),typeof e.index=="string"?t.FromURL(e.index,r,e.baseUrl,!1):r(null,new t(e.index,e.baseUrl,!1))},t.isAvailable=function(){return typeof XMLHttpRequest<"u"&&XMLHttpRequest!==null},t.FromURL=function(e,r,o,s){o===void 0&&(o=e.slice(0,e.lastIndexOf("/")+1)),s===void 0&&(s=!0),s&&console.warn(`[XmlHttpRequest] XmlHttpRequest.FromURL() is deprecated and will be removed in the next major release. Please use 'XmlHttpRequest.Create({ index: "`+e+'", baseUrl: "'+o+`" }, cb)' instead.`),nr(e,"json",function(l,v){l?r(l):r(null,new t(v,o,!1))})},t.prototype.empty=function(){this._index.fileIterator(function(e){e.fileData=null})},t.prototype.getName=function(){return t.Name},t.prototype.diskSpace=function(e,r){r(0,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.preloadFile=function(e,r){var o=this._index.getInode(e);if(Me(o)){if(o===null)throw u.ENOENT(e);var s=o.getData();s.size=r.length,s.fileData=r}else throw u.EISDIR(e)},t.prototype.stat=function(e,r,o){var s=this._index.getInode(e);if(s===null)return o(u.ENOENT(e));var l;Me(s)?(l=s.getData(),l.size<0?this._requestFileSizeAsync(e,function(v,E){if(v)return o(v);l.size=E,o(null,l.clone())}):o(null,l.clone())):ze(s)?(l=s.getStats(),o(null,l)):o(u.FileError(a.EINVAL,e))},t.prototype.statSync=function(e,r){var o=this._index.getInode(e);if(o===null)throw u.ENOENT(e);var s;if(Me(o))s=o.getData(),s.size<0&&(s.size=this._requestFileSizeSync(e));else if(ze(o))s=o.getStats();else throw u.FileError(a.EINVAL,e);return s},t.prototype.open=function(e,r,o,s){if(r.isWriteable())return s(new u(a.EPERM,e));var l=this,v=this._index.getInode(e);if(v===null)return s(u.ENOENT(e));if(Me(v)){var E=v.getData();switch(r.pathExistsAction()){case x.THROW_EXCEPTION:case x.TRUNCATE_FILE:return s(u.EEXIST(e));case x.NOP:if(E.fileData)return s(null,new le(l,e,r,E.clone(),E.fileData));this._requestFileAsync(e,"buffer",function(D,M){return D?s(D):(E.size=M.length,E.fileData=M,s(null,new le(l,e,r,E.clone(),M)))});break;default:return s(new u(a.EINVAL,"Invalid FileMode object."))}}else return s(u.EISDIR(e))},t.prototype.openSync=function(e,r,o){if(r.isWriteable())throw new u(a.EPERM,e);var s=this._index.getInode(e);if(s===null)throw u.ENOENT(e);if(Me(s)){var l=s.getData();switch(r.pathExistsAction()){case x.THROW_EXCEPTION:case x.TRUNCATE_FILE:throw u.EEXIST(e);case x.NOP:if(l.fileData)return new le(this,e,r,l.clone(),l.fileData);var v=this._requestFileSync(e,"buffer");return l.size=v.length,l.fileData=v,new le(this,e,r,l.clone(),v);default:throw new u(a.EINVAL,"Invalid FileMode object.")}}else throw u.EISDIR(e)},t.prototype.readdir=function(e,r){try{r(null,this.readdirSync(e))}catch(o){r(o)}},t.prototype.readdirSync=function(e){var r=this._index.getInode(e);if(r===null)throw u.ENOENT(e);if(ze(r))return r.getListing();throw u.ENOTDIR(e)},t.prototype.readFile=function(e,r,o,s){var l=s;this.open(e,o,420,function(v,E){if(v)return s(v);s=function(q,$){E.close(function(nt){return q||(q=nt),l(q,$)})};var D=E,M=D.getBuffer();r===null?s(v,Tt(M)):ds(M,r,s)})},t.prototype.readFileSync=function(e,r,o){var s=this.openSync(e,o,420);try{var l=s,v=l.getBuffer();return r===null?Tt(v):v.toString(r)}finally{s.closeSync()}},t.prototype.getXhrPath=function(e){return e.charAt(0)==="/"&&(e=e.slice(1)),this.prefixUrl+e},t.prototype._requestFileAsync=function(e,r,o){nr(this.getXhrPath(e),r,o)},t.prototype._requestFileSync=function(e,r){return fs(this.getXhrPath(e),r)},t.prototype._requestFileSizeAsync=function(e,r){ps(this.getXhrPath(e),r)},t.prototype._requestFileSizeSync=function(e){return hs(this.getXhrPath(e))},t})(Q);Un.Name="XmlHttpRequest",Un.Options={index:{type:["string","object"],optional:!0,description:"URL to a file index as a JSON file or the file index object itself, generated with the make_xhrfs_index script. Defaults to `index.json`."},baseUrl:{type:"string",optional:!0,description:"Used as the URL prefix for fetched files. Default: Fetch files relative to the index."}};var Ke=function(){};Ke.str2byte=function(t,n){for(var e=t.length>n.length?n.length:t.length,r=0;r<e;r++){var o=t.charCodeAt(r);if(o>127){var s=Ke.extendedChars.indexOf(t.charAt(r));s>-1&&(o=s+128)}n[o]=r}return e},Ke.byte2str=function(t){for(var n=new Array(t.length),e=0;e<t.length;e++){var r=t[e];r>127?n[e]=Ke.extendedChars[r-128]:n[e]=String.fromCharCode(r)}return n.join("")},Ke.byteLength=function(t){return t.length},Ke.extendedChars=["Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","ø","£","Ø","×","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","®","¬","½","¼","¡","«","»","_","_","_","¦","¦","Á","Â","À","©","¦","¦","+","+","¢","¥","+","+","-","-","+","-","+","ã","Ã","+","+","-","-","¦","-","+","¤","ð","Ð","Ê","Ë","È","i","Í","Î","Ï","+","+","_","_","¦","Ì","_","Ó","ß","Ô","Ò","õ","Õ","µ","þ","Þ","Ú","Û","Ù","ý","Ý","¯","´","­","±","_","¾","¶","§","÷","¸","°","¨","·","¹","³","²","_"," "];var ys=y(31).inflateRaw,ir={},rr;(function(i){i[i.MSDOS=0]="MSDOS",i[i.AMIGA=1]="AMIGA",i[i.OPENVMS=2]="OPENVMS",i[i.UNIX=3]="UNIX",i[i.VM_CMS=4]="VM_CMS",i[i.ATARI_ST=5]="ATARI_ST",i[i.OS2_HPFS=6]="OS2_HPFS",i[i.MAC=7]="MAC",i[i.Z_SYSTEM=8]="Z_SYSTEM",i[i.CP_M=9]="CP_M",i[i.NTFS=10]="NTFS",i[i.MVS=11]="MVS",i[i.VSE=12]="VSE",i[i.ACORN_RISC=13]="ACORN_RISC",i[i.VFAT=14]="VFAT",i[i.ALT_MVS=15]="ALT_MVS",i[i.BEOS=16]="BEOS",i[i.TANDEM=17]="TANDEM",i[i.OS_400=18]="OS_400",i[i.OSX=19]="OSX"})(rr||(rr={}));var cn;(function(i){i[i.STORED=0]="STORED",i[i.SHRUNK=1]="SHRUNK",i[i.REDUCED_1=2]="REDUCED_1",i[i.REDUCED_2=3]="REDUCED_2",i[i.REDUCED_3=4]="REDUCED_3",i[i.REDUCED_4=5]="REDUCED_4",i[i.IMPLODE=6]="IMPLODE",i[i.DEFLATE=8]="DEFLATE",i[i.DEFLATE64=9]="DEFLATE64",i[i.TERSE_OLD=10]="TERSE_OLD",i[i.BZIP2=12]="BZIP2",i[i.LZMA=14]="LZMA",i[i.TERSE_NEW=18]="TERSE_NEW",i[i.LZ77=19]="LZ77",i[i.WAVPACK=97]="WAVPACK",i[i.PPMD=98]="PPMD"})(cn||(cn={}));function or(i,t){var n=t&31,e=(t>>5&15)-1,r=(t>>9)+1980,o=i&31,s=i>>5&63,l=i>>11;return new Date(r,e,n,l,s,o)}function zn(i,t,n,e){return e===0?"":t?i.toString("utf8",n,n+e):Ke.byte2str(i.slice(n,n+e))}var we=function(t){if(this.data=t,t.readUInt32LE(0)!==67324752)throw new u(a.EINVAL,"Invalid Zip file: Local file header has invalid signature: "+this.data.readUInt32LE(0))};we.prototype.versionNeeded=function(){return this.data.readUInt16LE(4)},we.prototype.flags=function(){return this.data.readUInt16LE(6)},we.prototype.compressionMethod=function(){return this.data.readUInt16LE(8)},we.prototype.lastModFileTime=function(){return or(this.data.readUInt16LE(10),this.data.readUInt16LE(12))},we.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(10)},we.prototype.crc32=function(){return this.data.readUInt32LE(14)},we.prototype.fileNameLength=function(){return this.data.readUInt16LE(26)},we.prototype.extraFieldLength=function(){return this.data.readUInt16LE(28)},we.prototype.fileName=function(){return zn(this.data,this.useUTF8(),30,this.fileNameLength())},we.prototype.extraField=function(){var t=30+this.fileNameLength();return this.data.slice(t,t+this.extraFieldLength())},we.prototype.totalSize=function(){return 30+this.fileNameLength()+this.extraFieldLength()},we.prototype.useUTF8=function(){return(this.flags()&2048)===2048};var En=function(t,n,e){this.header=t,this.record=n,this.data=e};En.prototype.decompress=function(){var t=this.header.compressionMethod(),n=ir[t];if(n)return n(this.data,this.record.compressedSize(),this.record.uncompressedSize(),this.record.flag());var e=cn[t];throw e||(e="Unknown: "+t),new u(a.EINVAL,"Invalid compression method on file '"+this.header.fileName()+"': "+e)},En.prototype.getHeader=function(){return this.header},En.prototype.getRecord=function(){return this.record},En.prototype.getRawData=function(){return this.data};var Nt=function(t,n){if(this.zipData=t,this.data=n,this.data.readUInt32LE(0)!==33639248)throw new u(a.EINVAL,"Invalid Zip file: Central directory record has invalid signature: "+this.data.readUInt32LE(0));this._filename=this.produceFilename()};Nt.prototype.versionMadeBy=function(){return this.data.readUInt16LE(4)},Nt.prototype.versionNeeded=function(){return this.data.readUInt16LE(6)},Nt.prototype.flag=function(){return this.data.readUInt16LE(8)},Nt.prototype.compressionMethod=function(){return this.data.readUInt16LE(10)},Nt.prototype.lastModFileTime=function(){return or(this.data.readUInt16LE(12),this.data.readUInt16LE(14))},Nt.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(12)},Nt.prototype.crc32=function(){return this.data.readUInt32LE(16)},Nt.prototype.compressedSize=function(){return this.data.readUInt32LE(20)},Nt.prototype.uncompressedSize=function(){return this.data.readUInt32LE(24)},Nt.prototype.fileNameLength=function(){return this.data.readUInt16LE(28)},Nt.prototype.extraFieldLength=function(){return this.data.readUInt16LE(30)},Nt.prototype.fileCommentLength=function(){return this.data.readUInt16LE(32)},Nt.prototype.diskNumberStart=function(){return this.data.readUInt16LE(34)},Nt.prototype.internalAttributes=function(){return this.data.readUInt16LE(36)},Nt.prototype.externalAttributes=function(){return this.data.readUInt32LE(38)},Nt.prototype.headerRelativeOffset=function(){return this.data.readUInt32LE(42)},Nt.prototype.produceFilename=function(){var t=zn(this.data,this.useUTF8(),46,this.fileNameLength());return t.replace(/\\/g,"/")},Nt.prototype.fileName=function(){return this._filename},Nt.prototype.rawFileName=function(){return this.data.slice(46,46+this.fileNameLength())},Nt.prototype.extraField=function(){var t=44+this.fileNameLength();return this.data.slice(t,t+this.extraFieldLength())},Nt.prototype.fileComment=function(){var t=46+this.fileNameLength()+this.extraFieldLength();return zn(this.data,this.useUTF8(),t,this.fileCommentLength())},Nt.prototype.rawFileComment=function(){var t=46+this.fileNameLength()+this.extraFieldLength();return this.data.slice(t,t+this.fileCommentLength())},Nt.prototype.totalSize=function(){return 46+this.fileNameLength()+this.extraFieldLength()+this.fileCommentLength()},Nt.prototype.isDirectory=function(){var t=this.fileName();return!!(this.externalAttributes()&16)||t.charAt(t.length-1)==="/"},Nt.prototype.isFile=function(){return!this.isDirectory()},Nt.prototype.useUTF8=function(){return(this.flag()&2048)===2048},Nt.prototype.isEncrypted=function(){return(this.flag()&1)===1},Nt.prototype.getFileData=function(){var t=this.headerRelativeOffset(),n=new we(this.zipData.slice(t));return new En(n,this,this.zipData.slice(t+n.totalSize()))},Nt.prototype.getData=function(){return this.getFileData().decompress()},Nt.prototype.getRawData=function(){return this.getFileData().getRawData()},Nt.prototype.getStats=function(){return new A(C.FILE,this.uncompressedSize(),365,new Date,this.lastModFileTime())};var Le=function(t){if(this.data=t,this.data.readUInt32LE(0)!==101010256)throw new u(a.EINVAL,"Invalid Zip file: End of central directory record has invalid signature: "+this.data.readUInt32LE(0))};Le.prototype.diskNumber=function(){return this.data.readUInt16LE(4)},Le.prototype.cdDiskNumber=function(){return this.data.readUInt16LE(6)},Le.prototype.cdDiskEntryCount=function(){return this.data.readUInt16LE(8)},Le.prototype.cdTotalEntryCount=function(){return this.data.readUInt16LE(10)},Le.prototype.cdSize=function(){return this.data.readUInt32LE(12)},Le.prototype.cdOffset=function(){return this.data.readUInt32LE(16)},Le.prototype.cdZipCommentLength=function(){return this.data.readUInt16LE(20)},Le.prototype.cdZipComment=function(){return zn(this.data,!0,22,this.cdZipCommentLength())},Le.prototype.rawCdZipComment=function(){return this.data.slice(22,22+this.cdZipCommentLength())};var sr=function(t,n,e,r){this.index=t,this.directoryEntries=n,this.eocd=e,this.data=r},Je=(function(i){function t(n,e,r){e===void 0&&(e=""),r===void 0&&(r=!0),i.call(this),this.name=e,this._index=new _e,this._directoryEntries=[],this._eocd=null,Lt(r,t.Name,{zipData:"zip data as a Buffer",name:e}),n instanceof sr?(this._index=n.index,this._directoryEntries=n.directoryEntries,this._eocd=n.eocd,this.data=n.data):(this.data=n,this.populateIndex())}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){try{t.computeIndex(e.zipData,function(o){var s=new t(o,e.name,!1);r(null,s)},!1)}catch(o){r(o)}},t.isAvailable=function(){return!0},t.RegisterDecompressionMethod=function(e,r){ir[e]=r},t.computeIndex=function(e,r,o){o===void 0&&(o=!0),o&&console.warn("[ZipFS] ZipFS.computeIndex is now deprecated, and will be removed in the next major release. Please update your code to use 'ZipFS.Create({ zipData: zip file as a Buffer}, cb)' instead.");var s=new _e,l=t.getEOCD(e);if(l.diskNumber()!==l.cdDiskNumber())throw new u(a.EINVAL,"ZipFS does not support spanned zip files.");var v=l.cdOffset();if(v===4294967295)throw new u(a.EINVAL,"ZipFS does not support Zip64.");var E=v+l.cdSize();t.computeIndexResponsive(e,s,v,E,r,[],l)},t.getEOCD=function(e){for(var r=22,o=Math.min(r+65535,e.length-1),s=r;s<o;s++)if(e.readUInt32LE(e.length-s)===101010256)return new Le(e.slice(e.length-s));throw new u(a.EINVAL,"Invalid ZIP file: Could not locate End of Central Directory signature.")},t.addToIndex=function(e,r){var o=e.fileName();if(o.charAt(0)==="/")throw new Error("WHY IS THIS ABSOLUTE");o.charAt(o.length-1)==="/"&&(o=o.substr(0,o.length-1)),e.isDirectory()?r.addPathFast("/"+o,new ye(e)):r.addPathFast("/"+o,new an(e))},t.computeIndexResponsive=function(e,r,o,s,l,v,E){if(o<s){for(var D=0;D++<200&&o<s;){var M=new Nt(e,e.slice(o));t.addToIndex(M,r),o+=M.totalSize(),v.push(M)}ri(function(){t.computeIndexResponsive(e,r,o,s,l,v,E)})}else l(new sr(r,v,E,e))},t.prototype.getName=function(){return t.Name+(this.name!==""?" "+this.name:"")},t.prototype.getCentralDirectoryEntry=function(e){var r=this._index.getInode(e);if(r===null)throw u.ENOENT(e);if(Me(r))return r.getData();if(ze(r))return r.getData();throw u.EPERM("Invalid inode: "+r)},t.prototype.getCentralDirectoryEntryAt=function(e){var r=this._directoryEntries[e];if(!r)throw new RangeError("Invalid directory index: "+e+".");return r},t.prototype.getNumberOfCentralDirectoryEntries=function(){return this._directoryEntries.length},t.prototype.getEndOfCentralDirectory=function(){return this._eocd},t.prototype.diskSpace=function(e,r){r(this.data.length,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.statSync=function(e,r){var o=this._index.getInode(e);if(o===null)throw u.ENOENT(e);var s;if(Me(o))s=o.getData().getStats();else if(ze(o))s=o.getStats();else throw new u(a.EINVAL,"Invalid inode.");return s},t.prototype.openSync=function(e,r,o){if(r.isWriteable())throw new u(a.EPERM,e);var s=this._index.getInode(e);if(s)if(Me(s)){var l=s.getData(),v=l.getStats();switch(r.pathExistsAction()){case x.THROW_EXCEPTION:case x.TRUNCATE_FILE:throw u.EEXIST(e);case x.NOP:return new le(this,e,r,v,l.getData());default:throw new u(a.EINVAL,"Invalid FileMode object.")}}else throw u.EISDIR(e);else throw u.ENOENT(e)},t.prototype.readdirSync=function(e){var r=this._index.getInode(e);if(r){if(ze(r))return r.getListing();throw u.ENOTDIR(e)}else throw u.ENOENT(e)},t.prototype.readFileSync=function(e,r,o){var s=this.openSync(e,o,420);try{var l=s,v=l.getBuffer();return r===null?Tt(v):v.toString(r)}finally{s.closeSync()}},t.prototype.populateIndex=function(){var e=this,r=this._eocd=t.getEOCD(this.data);if(r.diskNumber()!==r.cdDiskNumber())throw new u(a.EINVAL,"ZipFS does not support spanned zip files.");var o=r.cdOffset();if(o===4294967295)throw new u(a.EINVAL,"ZipFS does not support Zip64.");for(var s=o+r.cdSize();o<s;){var l=new Nt(e.data,e.data.slice(o));o+=l.totalSize(),t.addToIndex(l,e._index),e._directoryEntries.push(l)}},t})(ne);Je.Name="ZipFS",Je.Options={zipData:{type:"object",description:"The zip file as a Buffer object.",validator:F},name:{type:"string",optional:!0,description:"The name of the zip file (optional)."}},Je.CompressionMethod=cn,Je.RegisterDecompressionMethod(cn.DEFLATE,function(i,t,n){return Rt(ys(i.slice(0,t),{chunkSize:n}))}),Je.RegisterDecompressionMethod(cn.STORED,function(i,t,n){return Tt(i,0,n)});var ms="IEEE_P1282";function me(i,t,n){return i.toString("ascii",t,t+n).trim()}function si(i,t,n){if(n===1)return String.fromCharCode(i[t]);for(var e=Math.floor(n/2),r=new Array(e),o=0;o<e;o++){var s=t+(o<<1);r[o]=String.fromCharCode(i[s+1]|i[s]<<8)}return r.join("")}function xe(i,t){var n=parseInt(me(i,t,4),10),e=parseInt(me(i,t+4,2),10),r=parseInt(me(i,t+6,2),10),o=parseInt(me(i,t+8,2),10),s=parseInt(me(i,t+10,2),10),l=parseInt(me(i,t+12,2),10),v=parseInt(me(i,t+14,2),10);return new Date(n,e,r,o,s,l,v*100)}function Qe(i,t){var n=i[t],e=i[t+1],r=i[t+2],o=i[t+3],s=i[t+4],l=i[t+5];return new Date(n,e-1,r,o,s,l)}function vs(i,t){var n=i.slice(t),e=new Qt(n);switch(e.signatureWord()){case 17221:return new fr(n);case 20548:return new Ss(n);case 21328:return new hr(n);case 21332:return new pr(n);case 17746:return new dr(n);case 17747:return new Es(n);case 20568:return new mr(n);case 20558:return new _s(n);case 21324:return new ai(n);case 20045:return new vr(n);case 17228:return new ci(n);case 20556:return new bs(n);case 21061:return new gr(n);case 21574:return new wr(n);case 21318:return new ks(n);case 21074:return new yr(n);default:return e}}function ar(i,t,n,e){n=n-4;for(var r=new Array;t<n;){var o=vs(i,t),s=o.length();if(s===0)return r;if(t+=s,o instanceof pr)break;o instanceof fr?r=r.concat(o.getEntries(e)):r.push(o)}return r}var ln=function(t){this._data=t};ln.prototype.type=function(){return this._data[0]},ln.prototype.standardIdentifier=function(){return me(this._data,1,5)},ln.prototype.version=function(){return this._data[6]},ln.prototype.data=function(){return this._data.slice(7,2048)};var cr=(function(i){function t(n){i.call(this,n),this._root=null}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.systemIdentifier=function(){return this._getString32(8)},t.prototype.volumeIdentifier=function(){return this._getString32(40)},t.prototype.volumeSpaceSize=function(){return this._data.readUInt32LE(80)},t.prototype.volumeSetSize=function(){return this._data.readUInt16LE(120)},t.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(124)},t.prototype.logicalBlockSize=function(){return this._data.readUInt16LE(128)},t.prototype.pathTableSize=function(){return this._data.readUInt32LE(132)},t.prototype.locationOfTypeLPathTable=function(){return this._data.readUInt32LE(140)},t.prototype.locationOfOptionalTypeLPathTable=function(){return this._data.readUInt32LE(144)},t.prototype.locationOfTypeMPathTable=function(){return this._data.readUInt32BE(148)},t.prototype.locationOfOptionalTypeMPathTable=function(){return this._data.readUInt32BE(152)},t.prototype.rootDirectoryEntry=function(e){return this._root===null&&(this._root=this._constructRootDirectoryRecord(this._data.slice(156)),this._root.rootCheckForRockRidge(e)),this._root},t.prototype.volumeSetIdentifier=function(){return this._getString(190,128)},t.prototype.publisherIdentifier=function(){return this._getString(318,128)},t.prototype.dataPreparerIdentifier=function(){return this._getString(446,128)},t.prototype.applicationIdentifier=function(){return this._getString(574,128)},t.prototype.copyrightFileIdentifier=function(){return this._getString(702,38)},t.prototype.abstractFileIdentifier=function(){return this._getString(740,36)},t.prototype.bibliographicFileIdentifier=function(){return this._getString(776,37)},t.prototype.volumeCreationDate=function(){return xe(this._data,813)},t.prototype.volumeModificationDate=function(){return xe(this._data,830)},t.prototype.volumeExpirationDate=function(){return xe(this._data,847)},t.prototype.volumeEffectiveDate=function(){return xe(this._data,864)},t.prototype.fileStructureVersion=function(){return this._data[881]},t.prototype.applicationUsed=function(){return this._data.slice(883,1395)},t.prototype.reserved=function(){return this._data.slice(1395,2048)},t.prototype._getString32=function(e){return this._getString(e,32)},t})(ln),gs=(function(i){function t(n){if(i.call(this,n),this.type()!==1)throw new u(a.EIO,"Invalid primary volume descriptor.")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.name=function(){return"ISO9660"},t.prototype._constructRootDirectoryRecord=function(e){return new lr(e,-1)},t.prototype._getString=function(e,r){return this._getString(e,r)},t})(cr),ws=(function(i){function t(n){if(i.call(this,n),this.type()!==2)throw new u(a.EIO,"Invalid supplementary volume descriptor.");var e=this.escapeSequence(),r=e[2];if(e[0]!==37||e[1]!==47||r!==64&&r!==67&&r!==69)throw new u(a.EIO,"Unrecognized escape sequence for SupplementaryVolumeDescriptor: "+e.toString())}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.name=function(){return"Joliet"},t.prototype.escapeSequence=function(){return this._data.slice(88,120)},t.prototype._constructRootDirectoryRecord=function(e){return new ur(e,-1)},t.prototype._getString=function(e,r){return si(this._data,e,r)},t})(cr),jt=function(t,n){this._suEntries=null,this._fileOrDir=null,this._data=t,this._rockRidgeOffset=n};jt.prototype.hasRockRidge=function(){return this._rockRidgeOffset>-1},jt.prototype.getRockRidgeOffset=function(){return this._rockRidgeOffset},jt.prototype.rootCheckForRockRidge=function(t){var n=this.getDirectory(t);this._rockRidgeOffset=n.getDotEntry(t)._getRockRidgeOffset(t),this._rockRidgeOffset>-1&&(this._fileOrDir=null)},jt.prototype.length=function(){return this._data[0]},jt.prototype.extendedAttributeRecordLength=function(){return this._data[1]},jt.prototype.lba=function(){return this._data.readUInt32LE(2)*2048},jt.prototype.dataLength=function(){return this._data.readUInt32LE(10)},jt.prototype.recordingDate=function(){return Qe(this._data,18)},jt.prototype.fileFlags=function(){return this._data[25]},jt.prototype.fileUnitSize=function(){return this._data[26]},jt.prototype.interleaveGapSize=function(){return this._data[27]},jt.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(28)},jt.prototype.identifier=function(){return this._getString(33,this._data[32])},jt.prototype.fileName=function(t){if(this.hasRockRidge()){var n=this._rockRidgeFilename(t);if(n!==null)return n}var e=this.identifier();if(this.isDirectory(t))return e;var r=e.indexOf(";");return r===-1?e:e[r-1]==="."?e.slice(0,r-1):e.slice(0,r)},jt.prototype.isDirectory=function(t){var n=!!(this.fileFlags()&2);return!n&&this.hasRockRidge()&&(n=this.getSUEntries(t).filter(function(e){return e instanceof ci}).length>0),n},jt.prototype.isSymlink=function(t){return this.hasRockRidge()&&this.getSUEntries(t).filter(function(n){return n instanceof ai}).length>0},jt.prototype.getSymlinkPath=function(t){for(var n="",e=this.getSUEntries(t),r=this._getGetString(),o=0,s=e;o<s.length;o+=1){var l=s[o];if(l instanceof ai){for(var v=l.componentRecords(),E=0,D=v;E<D.length;E+=1){var M=D[E],q=M.flags();q&2?n+="./":q&4?n+="../":q&8?n+="/":(n+=M.content(r),q&1||(n+="/"))}if(!l.continueFlag())break}}return n.length>1&&n[n.length-1]==="/"?n.slice(0,n.length-1):n},jt.prototype.getFile=function(t){if(this.isDirectory(t))throw new Error("Tried to get a File from a directory.");return this._fileOrDir===null&&(this._fileOrDir=t.slice(this.lba(),this.lba()+this.dataLength())),this._fileOrDir},jt.prototype.getDirectory=function(t){if(!this.isDirectory(t))throw new Error("Tried to get a Directory from a file.");return this._fileOrDir===null&&(this._fileOrDir=this._constructDirectory(t)),this._fileOrDir},jt.prototype.getSUEntries=function(t){return this._suEntries||this._constructSUEntries(t),this._suEntries},jt.prototype._rockRidgeFilename=function(t){var n=this.getSUEntries(t).filter(function(v){return v instanceof vr});if(n.length===0||n[0].flags()&6)return null;for(var e="",r=this._getGetString(),o=0,s=n;o<s.length;o+=1){var l=s[o];if(e+=l.name(r),!(l.flags()&1))break}return e},jt.prototype._constructSUEntries=function(t){var n=33+this._data[32];n%2===1&&n++,n+=this._rockRidgeOffset,this._suEntries=ar(this._data,n,this.length(),t)},jt.prototype._getRockRidgeOffset=function(t){this._rockRidgeOffset=0;var n=this.getSUEntries(t);if(n.length>0){var e=n[0];if(e instanceof hr&&e.checkBytesPass())for(var r=1;r<n.length;r++){var o=n[r];if(o instanceof yr||o instanceof dr&&o.extensionIdentifier()===ms)return e.bytesSkipped()}}return this._rockRidgeOffset=-1,-1};var lr=(function(i){function t(n,e){i.call(this,n,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._getString=function(e,r){return me(this._data,e,r)},t.prototype._constructDirectory=function(e){return new Is(this,e)},t.prototype._getGetString=function(){return me},t})(jt),ur=(function(i){function t(n,e){i.call(this,n,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._getString=function(e,r){return si(this._data,e,r)},t.prototype._constructDirectory=function(e){return new Rs(this,e)},t.prototype._getGetString=function(){return si},t})(jt),Qt=function(t){this._data=t};Qt.prototype.signatureWord=function(){return this._data.readUInt16BE(0)},Qt.prototype.signatureWordString=function(){return me(this._data,0,2)},Qt.prototype.length=function(){return this._data[2]},Qt.prototype.suVersion=function(){return this._data[3]};var fr=(function(i){function t(n){i.call(this,n),this._entries=null}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.continuationLba=function(){return this._data.readUInt32LE(4)},t.prototype.continuationLbaOffset=function(){return this._data.readUInt32LE(12)},t.prototype.continuationLength=function(){return this._data.readUInt32LE(20)},t.prototype.getEntries=function(e){if(!this._entries){var r=this.continuationLba()*2048+this.continuationLbaOffset();this._entries=ar(e,r,this.continuationLength(),e)}return this._entries},t})(Qt),Ss=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t})(Qt),hr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.checkBytesPass=function(){return this._data[4]===190&&this._data[5]===239},t.prototype.bytesSkipped=function(){return this._data[6]},t})(Qt),pr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t})(Qt),dr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.identifierLength=function(){return this._data[4]},t.prototype.descriptorLength=function(){return this._data[5]},t.prototype.sourceLength=function(){return this._data[6]},t.prototype.extensionVersion=function(){return this._data[7]},t.prototype.extensionIdentifier=function(){return me(this._data,8,this.identifierLength())},t.prototype.extensionDescriptor=function(){return me(this._data,8+this.identifierLength(),this.descriptorLength())},t.prototype.extensionSource=function(){return me(this._data,8+this.identifierLength()+this.descriptorLength(),this.sourceLength())},t})(Qt),Es=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.extensionSequence=function(){return this._data[4]},t})(Qt),yr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t})(Qt),mr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.mode=function(){return this._data.readUInt32LE(4)},t.prototype.fileLinks=function(){return this._data.readUInt32LE(12)},t.prototype.uid=function(){return this._data.readUInt32LE(20)},t.prototype.gid=function(){return this._data.readUInt32LE(28)},t.prototype.inode=function(){return this._data.readUInt32LE(36)},t})(Qt),_s=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.devTHigh=function(){return this._data.readUInt32LE(4)},t.prototype.devTLow=function(){return this._data.readUInt32LE(12)},t})(Qt),ai=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.continueFlag=function(){return this.flags()&1},t.prototype.componentRecords=function(){for(var e=this,r=new Array,o=5;o<this.length();){var s=new _n(e._data.slice(o));r.push(s),o+=s.length()}return r},t})(Qt),_n=function(t){this._data=t};_n.prototype.flags=function(){return this._data[0]},_n.prototype.length=function(){return 2+this.componentLength()},_n.prototype.componentLength=function(){return this._data[1]},_n.prototype.content=function(t){return t(this._data,2,this.componentLength())};var vr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.name=function(e){return e(this._data,5,this.length()-5)},t})(Qt),ci=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.childDirectoryLba=function(){return this._data.readUInt32LE(4)},t})(Qt),bs=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.parentDirectoryLba=function(){return this._data.readUInt32LE(4)},t})(Qt),gr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t})(Qt),wr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.creation=function(){return this.flags()&1?this._longFormDates()?xe(this._data,5):Qe(this._data,5):null},t.prototype.modify=function(){if(this.flags()&2){var e=this.flags()&1?1:0;return this._longFormDates?xe(this._data,5+e*17):Qe(this._data,5+e*7)}else return null},t.prototype.access=function(){if(this.flags()&4){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,this._longFormDates?xe(this._data,5+e*17):Qe(this._data,5+e*7)}else return null},t.prototype.backup=function(){if(this.flags()&16){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,e+=this.flags()&4?1:0,this._longFormDates?xe(this._data,5+e*17):Qe(this._data,5+e*7)}else return null},t.prototype.expiration=function(){if(this.flags()&32){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,e+=this.flags()&4?1:0,e+=this.flags()&16?1:0,this._longFormDates?xe(this._data,5+e*17):Qe(this._data,5+e*7)}else return null},t.prototype.effective=function(){if(this.flags()&64){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,e+=this.flags()&4?1:0,e+=this.flags()&16?1:0,e+=this.flags()&32?1:0,this._longFormDates?xe(this._data,5+e*17):Qe(this._data,5+e*7)}else return null},t.prototype._longFormDates=function(){return!!this.flags()},t})(Qt),ks=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.virtualSizeHigh=function(){return this._data.readUInt32LE(4)},t.prototype.virtualSizeLow=function(){return this._data.readUInt32LE(12)},t.prototype.tableDepth=function(){return this._data[20]},t})(Qt),bn=function(t,n){var e=this;this._fileList=[],this._fileMap={},this._record=t;var r=t.lba(),o=r+t.dataLength();if(!(t.fileFlags()&2)){var s=t.getSUEntries(n).filter(function(D){return D instanceof ci})[0];r=s.childDirectoryLba()*2048,o=1/0}for(;r<o;){var l=n[r];if(l===0){r++;continue}var v=e._constructDirectoryRecord(n.slice(r)),E=v.fileName(n);E!=="\0"&&E!==""?(!v.hasRockRidge()||v.getSUEntries(n).filter(function(D){return D instanceof gr}).length===0)&&(e._fileMap[E]=v,e._fileList.push(E)):o===1/0&&(o=r+v.dataLength()),r+=v.length()}};bn.prototype.getRecord=function(t){return this._fileMap[t]},bn.prototype.getFileList=function(){return this._fileList},bn.prototype.getDotEntry=function(t){return this._constructDirectoryRecord(t.slice(this._record.lba()))};var Is=(function(i){function t(n,e){i.call(this,n,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._constructDirectoryRecord=function(e){return new lr(e,this._record.getRockRidgeOffset())},t})(bn),Rs=(function(i){function t(n,e){i.call(this,n,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._constructDirectoryRecord=function(e){return new ur(e,this._record.getRockRidgeOffset())},t})(bn),jn=(function(i){function t(n,e,r){var o=this;e===void 0&&(e=""),r===void 0&&(r=!0),i.call(this),this._data=n,Lt(r,t.Name,{data:"ISO data as a Buffer",name:e});for(var s=!1,l=16*2048,v=new Array;!s;){var E=n.slice(l),D=new ln(E);switch(D.type()){case 1:v.push(new gs(E));break;case 2:v.push(new ws(E));break;case 255:s=!0;break}l+=2048}if(v.length===0)throw new u(a.EIO,"Unable to find a suitable volume descriptor.");v.forEach(function(M){(!o._pvd||o._pvd.type()!==2)&&(o._pvd=M)}),this._root=this._pvd.rootDirectoryEntry(n),this._name=e}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){var o,s;try{o=new t(e.data,e.name,!1)}catch(l){l=l}finally{r(s,o)}},t.isAvailable=function(){return!0},t.prototype.getName=function(){var e="IsoFS"+this._name+(this._pvd?"-"+this._pvd.name():"");return this._root&&this._root.hasRockRidge()&&(e+="-RockRidge"),e},t.prototype.diskSpace=function(e,r){r(this._data.length,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.statSync=function(e,r){var o=this._getDirectoryRecord(e);if(o===null)throw u.ENOENT(e);return this._getStats(e,o)},t.prototype.openSync=function(e,r,o){if(r.isWriteable())throw new u(a.EPERM,e);var s=this._getDirectoryRecord(e);if(s){if(s.isSymlink(this._data))return this.openSync(g.resolve(e,s.getSymlinkPath(this._data)),r,o);if(s.isDirectory(this._data))throw u.EISDIR(e);var l=s.getFile(this._data),v=this._getStats(e,s);switch(r.pathExistsAction()){case x.THROW_EXCEPTION:case x.TRUNCATE_FILE:throw u.EEXIST(e);case x.NOP:return new le(this,e,r,v,l);default:throw new u(a.EINVAL,"Invalid FileMode object.")}}else throw u.ENOENT(e)},t.prototype.readdirSync=function(e){var r=this._getDirectoryRecord(e);if(r){if(r.isDirectory(this._data))return r.getDirectory(this._data).getFileList().slice(0);throw u.ENOTDIR(e)}else throw u.ENOENT(e)},t.prototype.readFileSync=function(e,r,o){var s=this.openSync(e,o,420);try{var l=s,v=l.getBuffer();return r===null?Tt(v):v.toString(r)}finally{s.closeSync()}},t.prototype._getDirectoryRecord=function(e){var r=this;if(e==="/")return this._root;for(var o=e.split("/").slice(1),s=this._root,l=0,v=o;l<v.length;l+=1){var E=v[l];if(s.isDirectory(r._data)){if(s=s.getDirectory(r._data).getRecord(E),!s)return null}else return null}return s},t.prototype._getStats=function(e,r){if(r.isSymlink(this._data)){var o=g.resolve(e,r.getSymlinkPath(this._data)),s=this._getDirectoryRecord(o);return s?this._getStats(o,s):null}else{var l=r.dataLength(),v=365,E=r.recordingDate(),D=E,M=E,q=E;if(r.hasRockRidge())for(var $=r.getSUEntries(this._data),nt=0,ut=$;nt<ut.length;nt+=1){var yt=ut[nt];if(yt instanceof mr)v=yt.mode();else if(yt instanceof wr){var It=yt.flags();It&4&&(D=yt.access()),It&2&&(M=yt.modify()),It&1&&(q=yt.creation())}}return v=v&365,new A(r.isDirectory(this._data)?C.DIRECTORY:C.FILE,l,v,D,M,q)}},t})(ne);jn.Name="IsoFS",jn.Options={data:{type:"object",description:"The ISO file in a buffer",validator:F}},[R,Fn,Tn,nn,Nn,rn,yn,jn,vn,on,Sn,Bn,Un,Je].forEach(function(i){var t=i.Create;i.Create=function(n,e){var r=typeof n=="function",o=r?n:e,s=r?{}:n;function l(v){v?o(v):t.call(i,s,o)}T(i,s,l)}});var Wn={AsyncMirror:R,Dropbox:Fn,Emscripten:Tn,FolderAdapter:nn,HTML5FS:Nn,InMemory:rn,IndexedDB:yn,IsoFS:jn,LocalStorage:vn,MountableFileSystem:on,OverlayFS:Sn,WorkerFS:Bn,XmlHttpRequest:Un,ZipFS:Je};I.initializeTTYs&&I.initializeTTYs();function Ls(i){i.Buffer=m,i.process=I;var t=i.require?i.require:null;i.require=function(n){var e=Sr(n);return e||t.apply(null,Array.prototype.slice.call(arguments,0))}}function xs(i,t){Wn[i]=t}function Sr(i){switch(i){case"fs":return lt;case"path":return g;case"buffer":return S;case"process":return I;case"bfs_utils":return Z;default:return Wn[i]}}function Er(i){return lt.initialize(i)}function Fs(i,t){li(i,function(n,e){e?(Er(e),t()):t(n)})}function li(i,t){var n=i.fs;if(!n)return t(new u(a.EPERM,'Missing "fs" property on configuration object.'));var e=i.options,r=0,o=!1;function s(){if(!o){o=!0;var E=Wn[n];E?E.Create(e,t):t(new u(a.EPERM,"File system "+n+" is not available in BrowserFS."))}}if(e!==null&&typeof e=="object"){var l=!1,v=Object.keys(e).filter(function(E){return E!=="fs"});v.forEach(function(E){var D=e[E];D!==null&&typeof D=="object"&&D.fs&&(r++,li(D,function(M,q){if(r--,M){if(o)return;o=!0,t(M)}else e[E]=q,r===0&&l&&s()}))}),l=!0}r===0&&s()}"ab".substr(-1)!=="b"&&(String.prototype.substr=(function(i){return function(t,n){return t<0&&(t=this.length+t),i.call(this,t,n)}})(String.prototype.substr)),typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&(Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(i,t){i===void 0&&(i=0),t===void 0&&(t=this.length);var n=this;return i<0&&(i=this.length+i,i<0&&(i=0)),t<0&&(t=this.length+t,t<0&&(t=0)),t<i&&(t=i),new Uint8Array(n.buffer,n.byteOffset+i,t-i)})),p.install=Ls,p.registerFileSystem=xs,p.BFSRequire=Sr,p.initialize=Er,p.configure=Fs,p.getFileSystem=li,p.EmscriptenFS=bt,p.FileSystem=Wn,p.Errors=N,p.setImmediate=ri}).call(p,y(1),(function(){return this})(),y(5)(f),y(6))},function(f,p,y){f.exports=y(2).Buffer},function(f,p,y){(function(a){var k=y(3),w=y(4);p.Buffer=a,p.SlowBuffer=H,p.INSPECT_MAX_BYTES=50;var I=2147483647;p.kMaxLength=I,a.TYPED_ARRAY_SUPPORT=S(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function S(){try{var R=new Uint8Array(1);return R.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},R.foo()===42}catch{return!1}}function g(R){if(R>I)throw new RangeError("Invalid typed array length");var h=new Uint8Array(R);return h.__proto__=a.prototype,h}function a(R,h,d){if(typeof R=="number"){if(typeof h=="string")throw new Error("If encoding is specified then the first argument must be a string");return x(R)}return _(R,h,d)}typeof Symbol<"u"&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),a.poolSize=8192;function _(R,h,d){if(typeof R=="number")throw new TypeError('"value" argument must not be a number');return oe(R)?A(R,h,d):typeof R=="string"?O(R,h):J(R)}a.from=function(R,h,d){return _(R,h,d)},a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array;function u(R){if(typeof R!="number")throw new TypeError('"size" argument must be a number');if(R<0)throw new RangeError('"size" argument must not be negative')}function N(R,h,d){return u(R),R<=0?g(R):h!==void 0?typeof d=="string"?g(R).fill(h,d):g(R).fill(h):g(R)}a.alloc=function(R,h,d){return N(R,h,d)};function x(R){return u(R),g(R<0?0:B(R)|0)}a.allocUnsafe=function(R){return x(R)},a.allocUnsafeSlow=function(R){return x(R)};function O(R,h){if((typeof h!="string"||h==="")&&(h="utf8"),!a.isEncoding(h))throw new TypeError('"encoding" must be a valid string encoding');var d=St(R,h)|0,L=g(d),P=L.write(R,h);return P!==d&&(L=L.slice(0,P)),L}function C(R){for(var h=R.length<0?0:B(R.length)|0,d=g(h),L=0;L<h;L+=1)d[L]=R[L]&255;return d}function A(R,h,d){if(h<0||R.byteLength<h)throw new RangeError("'offset' is out of bounds");if(R.byteLength<h+(d||0))throw new RangeError("'length' is out of bounds");var L;return h===void 0&&d===void 0?L=new Uint8Array(R):d===void 0?L=new Uint8Array(R,h):L=new Uint8Array(R,h,d),L.__proto__=a.prototype,L}function J(R){if(a.isBuffer(R)){var h=B(R.length)|0,d=g(h);return d.length===0||R.copy(d,0,0,h),d}if(R){if(le(R)||"length"in R)return typeof R.length!="number"||be(R.length)?g(0):C(R);if(R.type==="Buffer"&&Array.isArray(R.data))return C(R.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function B(R){if(R>=I)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+I.toString(16)+" bytes");return R|0}function H(R){return+R!=R&&(R=0),a.alloc(+R)}a.isBuffer=function(h){return h!=null&&h._isBuffer===!0},a.compare=function(h,d){if(!a.isBuffer(h)||!a.isBuffer(d))throw new TypeError("Arguments must be Buffers");if(h===d)return 0;for(var L=h.length,P=d.length,G=0,V=Math.min(L,P);G<V;++G)if(h[G]!==d[G]){L=h[G],P=d[G];break}return L<P?-1:P<L?1:0},a.isEncoding=function(h){switch(String(h).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(h,d){if(!Array.isArray(h))throw new TypeError('"list" argument must be an Array of Buffers');if(h.length===0)return a.alloc(0);var L;if(d===void 0)for(d=0,L=0;L<h.length;++L)d+=h[L].length;var P=a.allocUnsafe(d),G=0;for(L=0;L<h.length;++L){var V=h[L];if(!a.isBuffer(V))throw new TypeError('"list" argument must be an Array of Buffers');V.copy(P,G),G+=V.length}return P};function St(R,h){if(a.isBuffer(R))return R.length;if(le(R)||oe(R))return R.byteLength;typeof R!="string"&&(R=""+R);var d=R.length;if(d===0)return 0;for(var L=!1;;)switch(h){case"ascii":case"latin1":case"binary":return d;case"utf8":case"utf-8":case void 0:return pt(R).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return d*2;case"hex":return d>>>1;case"base64":return ne(R).length;default:if(L)return pt(R).length;h=(""+h).toLowerCase(),L=!0}}a.byteLength=St;function tt(R,h,d){var L=!1;if((h===void 0||h<0)&&(h=0),h>this.length||((d===void 0||d>this.length)&&(d=this.length),d<=0)||(d>>>=0,h>>>=0,d<=h))return"";for(R||(R="utf8");;)switch(R){case"hex":return Rt(this,h,d);case"utf8":case"utf-8":return Zt(this,h,d);case"ascii":return K(this,h,d);case"latin1":case"binary":return ft(this,h,d);case"base64":return Et(this,h,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return gt(this,h,d);default:if(L)throw new TypeError("Unknown encoding: "+R);R=(R+"").toLowerCase(),L=!0}}a.prototype._isBuffer=!0;function kt(R,h,d){var L=R[h];R[h]=R[d],R[d]=L}a.prototype.swap16=function(){var h=this.length;if(h%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var d=0;d<h;d+=2)kt(this,d,d+1);return this},a.prototype.swap32=function(){var h=this.length;if(h%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var d=0;d<h;d+=4)kt(this,d,d+3),kt(this,d+1,d+2);return this},a.prototype.swap64=function(){var h=this.length;if(h%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var d=0;d<h;d+=8)kt(this,d,d+7),kt(this,d+1,d+6),kt(this,d+2,d+5),kt(this,d+3,d+4);return this},a.prototype.toString=function(){var h=this.length;return h===0?"":arguments.length===0?Zt(this,0,h):tt.apply(this,arguments)},a.prototype.equals=function(h){if(!a.isBuffer(h))throw new TypeError("Argument must be a Buffer");return this===h?!0:a.compare(this,h)===0},a.prototype.inspect=function(){var h="",d=p.INSPECT_MAX_BYTES;return this.length>0&&(h=this.toString("hex",0,d).match(/.{2}/g).join(" "),this.length>d&&(h+=" ... ")),"<Buffer "+h+">"},a.prototype.compare=function(h,d,L,P,G){if(!a.isBuffer(h))throw new TypeError("Argument must be a Buffer");if(d===void 0&&(d=0),L===void 0&&(L=h?h.length:0),P===void 0&&(P=0),G===void 0&&(G=this.length),d<0||L>h.length||P<0||G>this.length)throw new RangeError("out of range index");if(P>=G&&d>=L)return 0;if(P>=G)return-1;if(d>=L)return 1;if(d>>>=0,L>>>=0,P>>>=0,G>>>=0,this===h)return 0;for(var V=G-P,xt=L-d,Dt=Math.min(V,xt),Pt=this.slice(P,G),Vt=h.slice(d,L),At=0;At<Dt;++At)if(Pt[At]!==Vt[At]){V=Pt[At],xt=Vt[At];break}return V<xt?-1:xt<V?1:0};function dt(R,h,d,L,P){if(R.length===0)return-1;if(typeof d=="string"?(L=d,d=0):d>2147483647?d=2147483647:d<-2147483648&&(d=-2147483648),d=+d,be(d)&&(d=P?0:R.length-1),d<0&&(d=R.length+d),d>=R.length){if(P)return-1;d=R.length-1}else if(d<0)if(P)d=0;else return-1;if(typeof h=="string"&&(h=a.from(h,L)),a.isBuffer(h))return h.length===0?-1:z(R,h,d,L,P);if(typeof h=="number")return h=h&255,typeof Uint8Array.prototype.indexOf=="function"?P?Uint8Array.prototype.indexOf.call(R,h,d):Uint8Array.prototype.lastIndexOf.call(R,h,d):z(R,[h],d,L,P);throw new TypeError("val must be string, number or Buffer")}function z(R,h,d,L,P){var G=1,V=R.length,xt=h.length;if(L!==void 0&&(L=String(L).toLowerCase(),L==="ucs2"||L==="ucs-2"||L==="utf16le"||L==="utf-16le")){if(R.length<2||h.length<2)return-1;G=2,V/=2,xt/=2,d/=2}function Dt($e,We){return G===1?$e[We]:$e.readUInt16BE(We*G)}var Pt;if(P){var Vt=-1;for(Pt=d;Pt<V;Pt++)if(Dt(R,Pt)===Dt(h,Vt===-1?0:Pt-Vt)){if(Vt===-1&&(Vt=Pt),Pt-Vt+1===xt)return Vt*G}else Vt!==-1&&(Pt-=Pt-Vt),Vt=-1}else for(d+xt>V&&(d=V-xt),Pt=d;Pt>=0;Pt--){for(var At=!0,ke=0;ke<xt;ke++)if(Dt(R,Pt+ke)!==Dt(h,ke)){At=!1;break}if(At)return Pt}return-1}a.prototype.includes=function(h,d,L){return this.indexOf(h,d,L)!==-1},a.prototype.indexOf=function(h,d,L){return dt(this,h,d,L,!0)},a.prototype.lastIndexOf=function(h,d,L){return dt(this,h,d,L,!1)};function et(R,h,d,L){d=Number(d)||0;var P=R.length-d;L?(L=Number(L),L>P&&(L=P)):L=P;var G=h.length;if(G%2!==0)throw new TypeError("Invalid hex string");L>G/2&&(L=G/2);for(var V=0;V<L;++V){var xt=parseInt(h.substr(V*2,2),16);if(be(xt))return V;R[d+V]=xt}return V}function lt(R,h,d,L){return vt(pt(h,R.length-d),R,d,L)}function Ft(R,h,d,L){return vt(bt(h),R,d,L)}function mt(R,h,d,L){return Ft(R,h,d,L)}function Ct(R,h,d,L){return vt(ne(h),R,d,L)}function Lt(R,h,d,L){return vt(Q(h,R.length-d),R,d,L)}a.prototype.write=function(h,d,L,P){if(d===void 0)P="utf8",L=this.length,d=0;else if(L===void 0&&typeof d=="string")P=d,L=this.length,d=0;else if(isFinite(d))d=d>>>0,isFinite(L)?(L=L>>>0,P===void 0&&(P="utf8")):(P=L,L=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var G=this.length-d;if((L===void 0||L>G)&&(L=G),h.length>0&&(L<0||d<0)||d>this.length)throw new RangeError("Attempt to write outside buffer bounds");P||(P="utf8");for(var V=!1;;)switch(P){case"hex":return et(this,h,d,L);case"utf8":case"utf-8":return lt(this,h,d,L);case"ascii":return Ft(this,h,d,L);case"latin1":case"binary":return mt(this,h,d,L);case"base64":return Ct(this,h,d,L);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Lt(this,h,d,L);default:if(V)throw new TypeError("Unknown encoding: "+P);P=(""+P).toLowerCase(),V=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Et(R,h,d){return h===0&&d===R.length?k.fromByteArray(R):k.fromByteArray(R.slice(h,d))}function Zt(R,h,d){d=Math.min(R.length,d);for(var L=[],P=h;P<d;){var G=R[P],V=null,xt=G>239?4:G>223?3:G>191?2:1;if(P+xt<=d){var Dt,Pt,Vt,At;switch(xt){case 1:G<128&&(V=G);break;case 2:Dt=R[P+1],(Dt&192)===128&&(At=(G&31)<<6|Dt&63,At>127&&(V=At));break;case 3:Dt=R[P+1],Pt=R[P+2],(Dt&192)===128&&(Pt&192)===128&&(At=(G&15)<<12|(Dt&63)<<6|Pt&63,At>2047&&(At<55296||At>57343)&&(V=At));break;case 4:Dt=R[P+1],Pt=R[P+2],Vt=R[P+3],(Dt&192)===128&&(Pt&192)===128&&(Vt&192)===128&&(At=(G&15)<<18|(Dt&63)<<12|(Pt&63)<<6|Vt&63,At>65535&&At<1114112&&(V=At))}}V===null?(V=65533,xt=1):V>65535&&(V-=65536,L.push(V>>>10&1023|55296),V=56320|V&1023),L.push(V),P+=xt}return U(L)}var j=4096;function U(R){var h=R.length;if(h<=j)return String.fromCharCode.apply(String,R);for(var d="",L=0;L<h;)d+=String.fromCharCode.apply(String,R.slice(L,L+=j));return d}function K(R,h,d){var L="";d=Math.min(R.length,d);for(var P=h;P<d;++P)L+=String.fromCharCode(R[P]&127);return L}function ft(R,h,d){var L="";d=Math.min(R.length,d);for(var P=h;P<d;++P)L+=String.fromCharCode(R[P]);return L}function Rt(R,h,d){var L=R.length;(!h||h<0)&&(h=0),(!d||d<0||d>L)&&(d=L);for(var P="",G=h;G<d;++G)P+=it(R[G]);return P}function gt(R,h,d){for(var L=R.slice(h,d),P="",G=0;G<L.length;G+=2)P+=String.fromCharCode(L[G]+L[G+1]*256);return P}a.prototype.slice=function(h,d){var L=this.length;h=~~h,d=d===void 0?L:~~d,h<0?(h+=L,h<0&&(h=0)):h>L&&(h=L),d<0?(d+=L,d<0&&(d=0)):d>L&&(d=L),d<h&&(d=h);var P=this.subarray(h,d);return P.__proto__=a.prototype,P};function _t(R,h,d){if(R%1!==0||R<0)throw new RangeError("offset is not uint");if(R+h>d)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUIntLE=function(h,d,L){h=h>>>0,d=d>>>0,L||_t(h,d,this.length);for(var P=this[h],G=1,V=0;++V<d&&(G*=256);)P+=this[h+V]*G;return P},a.prototype.readUIntBE=function(h,d,L){h=h>>>0,d=d>>>0,L||_t(h,d,this.length);for(var P=this[h+--d],G=1;d>0&&(G*=256);)P+=this[h+--d]*G;return P},a.prototype.readUInt8=function(h,d){return h=h>>>0,d||_t(h,1,this.length),this[h]},a.prototype.readUInt16LE=function(h,d){return h=h>>>0,d||_t(h,2,this.length),this[h]|this[h+1]<<8},a.prototype.readUInt16BE=function(h,d){return h=h>>>0,d||_t(h,2,this.length),this[h]<<8|this[h+1]},a.prototype.readUInt32LE=function(h,d){return h=h>>>0,d||_t(h,4,this.length),(this[h]|this[h+1]<<8|this[h+2]<<16)+this[h+3]*16777216},a.prototype.readUInt32BE=function(h,d){return h=h>>>0,d||_t(h,4,this.length),this[h]*16777216+(this[h+1]<<16|this[h+2]<<8|this[h+3])},a.prototype.readIntLE=function(h,d,L){h=h>>>0,d=d>>>0,L||_t(h,d,this.length);for(var P=this[h],G=1,V=0;++V<d&&(G*=256);)P+=this[h+V]*G;return G*=128,P>=G&&(P-=Math.pow(2,8*d)),P},a.prototype.readIntBE=function(h,d,L){h=h>>>0,d=d>>>0,L||_t(h,d,this.length);for(var P=d,G=1,V=this[h+--P];P>0&&(G*=256);)V+=this[h+--P]*G;return G*=128,V>=G&&(V-=Math.pow(2,8*d)),V},a.prototype.readInt8=function(h,d){return h=h>>>0,d||_t(h,1,this.length),this[h]&128?(255-this[h]+1)*-1:this[h]},a.prototype.readInt16LE=function(h,d){h=h>>>0,d||_t(h,2,this.length);var L=this[h]|this[h+1]<<8;return L&32768?L|4294901760:L},a.prototype.readInt16BE=function(h,d){h=h>>>0,d||_t(h,2,this.length);var L=this[h+1]|this[h]<<8;return L&32768?L|4294901760:L},a.prototype.readInt32LE=function(h,d){return h=h>>>0,d||_t(h,4,this.length),this[h]|this[h+1]<<8|this[h+2]<<16|this[h+3]<<24},a.prototype.readInt32BE=function(h,d){return h=h>>>0,d||_t(h,4,this.length),this[h]<<24|this[h+1]<<16|this[h+2]<<8|this[h+3]},a.prototype.readFloatLE=function(h,d){return h=h>>>0,d||_t(h,4,this.length),w.read(this,h,!0,23,4)},a.prototype.readFloatBE=function(h,d){return h=h>>>0,d||_t(h,4,this.length),w.read(this,h,!1,23,4)},a.prototype.readDoubleLE=function(h,d){return h=h>>>0,d||_t(h,8,this.length),w.read(this,h,!0,52,8)},a.prototype.readDoubleBE=function(h,d){return h=h>>>0,d||_t(h,8,this.length),w.read(this,h,!1,52,8)};function Tt(R,h,d,L,P,G){if(!a.isBuffer(R))throw new TypeError('"buffer" argument must be a Buffer instance');if(h>P||h<G)throw new RangeError('"value" argument is out of bounds');if(d+L>R.length)throw new RangeError("Index out of range")}a.prototype.writeUIntLE=function(h,d,L,P){if(h=+h,d=d>>>0,L=L>>>0,!P){var G=Math.pow(2,8*L)-1;Tt(this,h,d,L,G,0)}var V=1,xt=0;for(this[d]=h&255;++xt<L&&(V*=256);)this[d+xt]=h/V&255;return d+L},a.prototype.writeUIntBE=function(h,d,L,P){if(h=+h,d=d>>>0,L=L>>>0,!P){var G=Math.pow(2,8*L)-1;Tt(this,h,d,L,G,0)}var V=L-1,xt=1;for(this[d+V]=h&255;--V>=0&&(xt*=256);)this[d+V]=h/xt&255;return d+L},a.prototype.writeUInt8=function(h,d,L){return h=+h,d=d>>>0,L||Tt(this,h,d,1,255,0),this[d]=h&255,d+1},a.prototype.writeUInt16LE=function(h,d,L){return h=+h,d=d>>>0,L||Tt(this,h,d,2,65535,0),this[d]=h&255,this[d+1]=h>>>8,d+2},a.prototype.writeUInt16BE=function(h,d,L){return h=+h,d=d>>>0,L||Tt(this,h,d,2,65535,0),this[d]=h>>>8,this[d+1]=h&255,d+2},a.prototype.writeUInt32LE=function(h,d,L){return h=+h,d=d>>>0,L||Tt(this,h,d,4,4294967295,0),this[d+3]=h>>>24,this[d+2]=h>>>16,this[d+1]=h>>>8,this[d]=h&255,d+4},a.prototype.writeUInt32BE=function(h,d,L){return h=+h,d=d>>>0,L||Tt(this,h,d,4,4294967295,0),this[d]=h>>>24,this[d+1]=h>>>16,this[d+2]=h>>>8,this[d+3]=h&255,d+4},a.prototype.writeIntLE=function(h,d,L,P){if(h=+h,d=d>>>0,!P){var G=Math.pow(2,8*L-1);Tt(this,h,d,L,G-1,-G)}var V=0,xt=1,Dt=0;for(this[d]=h&255;++V<L&&(xt*=256);)h<0&&Dt===0&&this[d+V-1]!==0&&(Dt=1),this[d+V]=(h/xt>>0)-Dt&255;return d+L},a.prototype.writeIntBE=function(h,d,L,P){if(h=+h,d=d>>>0,!P){var G=Math.pow(2,8*L-1);Tt(this,h,d,L,G-1,-G)}var V=L-1,xt=1,Dt=0;for(this[d+V]=h&255;--V>=0&&(xt*=256);)h<0&&Dt===0&&this[d+V+1]!==0&&(Dt=1),this[d+V]=(h/xt>>0)-Dt&255;return d+L},a.prototype.writeInt8=function(h,d,L){return h=+h,d=d>>>0,L||Tt(this,h,d,1,127,-128),h<0&&(h=255+h+1),this[d]=h&255,d+1},a.prototype.writeInt16LE=function(h,d,L){return h=+h,d=d>>>0,L||Tt(this,h,d,2,32767,-32768),this[d]=h&255,this[d+1]=h>>>8,d+2},a.prototype.writeInt16BE=function(h,d,L){return h=+h,d=d>>>0,L||Tt(this,h,d,2,32767,-32768),this[d]=h>>>8,this[d+1]=h&255,d+2},a.prototype.writeInt32LE=function(h,d,L){return h=+h,d=d>>>0,L||Tt(this,h,d,4,2147483647,-2147483648),this[d]=h&255,this[d+1]=h>>>8,this[d+2]=h>>>16,this[d+3]=h>>>24,d+4},a.prototype.writeInt32BE=function(h,d,L){return h=+h,d=d>>>0,L||Tt(this,h,d,4,2147483647,-2147483648),h<0&&(h=4294967295+h+1),this[d]=h>>>24,this[d+1]=h>>>16,this[d+2]=h>>>8,this[d+3]=h&255,d+4};function Wt(R,h,d,L,P,G){if(d+L>R.length)throw new RangeError("Index out of range");if(d<0)throw new RangeError("Index out of range")}function Mt(R,h,d,L,P){return h=+h,d=d>>>0,P||Wt(R,h,d,4),w.write(R,h,d,L,23,4),d+4}a.prototype.writeFloatLE=function(h,d,L){return Mt(this,h,d,!0,L)},a.prototype.writeFloatBE=function(h,d,L){return Mt(this,h,d,!1,L)};function F(R,h,d,L,P){return h=+h,d=d>>>0,P||Wt(R,h,d,8),w.write(R,h,d,L,52,8),d+8}a.prototype.writeDoubleLE=function(h,d,L){return F(this,h,d,!0,L)},a.prototype.writeDoubleBE=function(h,d,L){return F(this,h,d,!1,L)},a.prototype.copy=function(h,d,L,P){if(L||(L=0),!P&&P!==0&&(P=this.length),d>=h.length&&(d=h.length),d||(d=0),P>0&&P<L&&(P=L),P===L||h.length===0||this.length===0)return 0;if(d<0)throw new RangeError("targetStart out of bounds");if(L<0||L>=this.length)throw new RangeError("sourceStart out of bounds");if(P<0)throw new RangeError("sourceEnd out of bounds");P>this.length&&(P=this.length),h.length-d<P-L&&(P=h.length-d+L);var G=P-L,V;if(this===h&&L<d&&d<P)for(V=G-1;V>=0;--V)h[V+d]=this[V+L];else if(G<1e3)for(V=0;V<G;++V)h[V+d]=this[V+L];else Uint8Array.prototype.set.call(h,this.subarray(L,L+G),d);return G},a.prototype.fill=function(h,d,L,P){if(typeof h=="string"){if(typeof d=="string"?(P=d,d=0,L=this.length):typeof L=="string"&&(P=L,L=this.length),h.length===1){var G=h.charCodeAt(0);G<256&&(h=G)}if(P!==void 0&&typeof P!="string")throw new TypeError("encoding must be a string");if(typeof P=="string"&&!a.isEncoding(P))throw new TypeError("Unknown encoding: "+P)}else typeof h=="number"&&(h=h&255);if(d<0||this.length<d||this.length<L)throw new RangeError("Out of range index");if(L<=d)return this;d=d>>>0,L=L===void 0?this.length:L>>>0,h||(h=0);var V;if(typeof h=="number")for(V=d;V<L;++V)this[V]=h;else{var xt=a.isBuffer(h)?h:new a(h,P),Dt=xt.length;for(V=0;V<L-d;++V)this[V+d]=xt[V%Dt]}return this};var T=/[^+/0-9A-Za-z-_]/g;function Z(R){if(R=R.trim().replace(T,""),R.length<2)return"";for(;R.length%4!==0;)R=R+"=";return R}function it(R){return R<16?"0"+R.toString(16):R.toString(16)}function pt(R,h){h=h||1/0;for(var d,L=R.length,P=null,G=[],V=0;V<L;++V){if(d=R.charCodeAt(V),d>55295&&d<57344){if(!P){if(d>56319){(h-=3)>-1&&G.push(239,191,189);continue}else if(V+1===L){(h-=3)>-1&&G.push(239,191,189);continue}P=d;continue}if(d<56320){(h-=3)>-1&&G.push(239,191,189),P=d;continue}d=(P-55296<<10|d-56320)+65536}else P&&(h-=3)>-1&&G.push(239,191,189);if(P=null,d<128){if((h-=1)<0)break;G.push(d)}else if(d<2048){if((h-=2)<0)break;G.push(d>>6|192,d&63|128)}else if(d<65536){if((h-=3)<0)break;G.push(d>>12|224,d>>6&63|128,d&63|128)}else if(d<1114112){if((h-=4)<0)break;G.push(d>>18|240,d>>12&63|128,d>>6&63|128,d&63|128)}else throw new Error("Invalid code point")}return G}function bt(R){for(var h=[],d=0;d<R.length;++d)h.push(R.charCodeAt(d)&255);return h}function Q(R,h){for(var d,L,P,G=[],V=0;V<R.length&&!((h-=2)<0);++V)d=R.charCodeAt(V),L=d>>8,P=d%256,G.push(P),G.push(L);return G}function ne(R){return k.toByteArray(Z(R))}function vt(R,h,d,L){for(var P=0;P<L&&!(P+d>=h.length||P>=R.length);++P)h[P+d]=R[P];return P}function oe(R){return R instanceof ArrayBuffer||R!=null&&R.constructor!=null&&R.constructor.name==="ArrayBuffer"&&typeof R.byteLength=="number"}function le(R){return typeof ArrayBuffer.isView=="function"&&ArrayBuffer.isView(R)}function be(R){return R!==R}}).call(p,y(1))},function(f,p){p.byteLength=a,p.toByteArray=_,p.fromByteArray=x;for(var y=[],m=[],k=typeof Uint8Array<"u"?Uint8Array:Array,w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",I=0,S=w.length;I<S;++I)y[I]=w[I],m[w.charCodeAt(I)]=I;m[45]=62,m[95]=63;function g(O){var C=O.length;if(C%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return O[C-2]==="="?2:O[C-1]==="="?1:0}function a(O){return O.length*3/4-g(O)}function _(O){var C,A,J,B,H,St,tt=O.length;H=g(O),St=new k(tt*3/4-H),J=H>0?tt-4:tt;var kt=0;for(C=0,A=0;C<J;C+=4,A+=3)B=m[O.charCodeAt(C)]<<18|m[O.charCodeAt(C+1)]<<12|m[O.charCodeAt(C+2)]<<6|m[O.charCodeAt(C+3)],St[kt++]=B>>16&255,St[kt++]=B>>8&255,St[kt++]=B&255;return H===2?(B=m[O.charCodeAt(C)]<<2|m[O.charCodeAt(C+1)]>>4,St[kt++]=B&255):H===1&&(B=m[O.charCodeAt(C)]<<10|m[O.charCodeAt(C+1)]<<4|m[O.charCodeAt(C+2)]>>2,St[kt++]=B>>8&255,St[kt++]=B&255),St}function u(O){return y[O>>18&63]+y[O>>12&63]+y[O>>6&63]+y[O&63]}function N(O,C,A){for(var J,B=[],H=C;H<A;H+=3)J=(O[H]<<16)+(O[H+1]<<8)+O[H+2],B.push(u(J));return B.join("")}function x(O){for(var C,A=O.length,J=A%3,B="",H=[],St=16383,tt=0,kt=A-J;tt<kt;tt+=St)H.push(N(O,tt,tt+St>kt?kt:tt+St));return J===1?(C=O[A-1],B+=y[C>>2],B+=y[C<<4&63],B+="=="):J===2&&(C=(O[A-2]<<8)+O[A-1],B+=y[C>>10],B+=y[C>>4&63],B+=y[C<<2&63],B+="="),H.push(B),H.join("")}},function(f,p){p.read=function(y,m,k,w,I){var S,g,a=I*8-w-1,_=(1<<a)-1,u=_>>1,N=-7,x=k?I-1:0,O=k?-1:1,C=y[m+x];for(x+=O,S=C&(1<<-N)-1,C>>=-N,N+=a;N>0;S=S*256+y[m+x],x+=O,N-=8);for(g=S&(1<<-N)-1,S>>=-N,N+=w;N>0;g=g*256+y[m+x],x+=O,N-=8);if(S===0)S=1-u;else{if(S===_)return g?NaN:(C?-1:1)*(1/0);g=g+Math.pow(2,w),S=S-u}return(C?-1:1)*g*Math.pow(2,S-w)},p.write=function(y,m,k,w,I,S){var g,a,_,u=S*8-I-1,N=(1<<u)-1,x=N>>1,O=I===23?Math.pow(2,-24)-Math.pow(2,-77):0,C=w?0:S-1,A=w?1:-1,J=m<0||m===0&&1/m<0?1:0;for(m=Math.abs(m),isNaN(m)||m===1/0?(a=isNaN(m)?1:0,g=N):(g=Math.floor(Math.log(m)/Math.LN2),m*(_=Math.pow(2,-g))<1&&(g--,_*=2),g+x>=1?m+=O/_:m+=O*Math.pow(2,1-x),m*_>=2&&(g++,_/=2),g+x>=N?(a=0,g=N):g+x>=1?(a=(m*_-1)*Math.pow(2,I),g=g+x):(a=m*Math.pow(2,x-1)*Math.pow(2,I),g=0));I>=8;y[k+C]=a&255,C+=A,a/=256,I-=8);for(g=g<<I|a,u+=I;u>0;y[k+C]=g&255,C+=A,g/=256,u-=8);y[k+C-A]|=J*128}},function(f,p){f.exports=function(y){return y.webpackPolyfill||(y.deprecate=function(){},y.paths=[],y.children=[],y.webpackPolyfill=1),y}},function(f,p,y){var m=y(7),k=new m,w={};function I(g){w[g]||(typeof k[g]=="function"?w[g]=function(){return k[g].apply(k,arguments)}:w[g]=k[g])}for(var S in k)I(S);w.initializeTTYs=function(){k.stdin===null&&(k.initializeTTYs(),w.stdin=k.stdin,w.stdout=k.stdout,w.stderr=k.stderr)},k.nextTick(function(){w.initializeTTYs()}),f.exports=w},function(f,p,y){(function(m){var k=this&&this.__extends||function(_,u){for(var N in u)u.hasOwnProperty(N)&&(_[N]=u[N]);function x(){this.constructor=_}_.prototype=u===null?Object.create(u):(x.prototype=u.prototype,new x)},w=y(8),I=null,S=(function(){function _(u,N){this.fun=u,this.array=N}return _.prototype.run=function(){this.fun.apply(null,this.array)},_})(),g=(function(){function _(){this._queue=[],this._draining=!1,this._currentQueue=null,this._queueIndex=-1}return _.prototype.push=function(u){var N=this;this._queue.push(u)===1&&!this._draining&&setTimeout(function(){return N._drainQueue()},0)},_.prototype._cleanUpNextTick=function(){this._draining=!1,this._currentQueue&&this._currentQueue.length?this._queue=this._currentQueue.concat(this._queue):this._queueIndex=-1,this._queue.length&&this._drainQueue()},_.prototype._drainQueue=function(){var u=this;if(!this._draining){var N=setTimeout(function(){return u._cleanUpNextTick()});this._draining=!0;for(var x=this._queue.length;x;){for(this._currentQueue=this._queue,this._queue=[];++this._queueIndex<x;)this._currentQueue&&this._currentQueue[this._queueIndex].run();this._queueIndex=-1,x=this._queue.length}this._currentQueue=null,this._draining=!1,clearTimeout(N)}},_})(),a=(function(_){k(u,_);function u(){_.apply(this,arguments),this.startTime=Date.now(),this._cwd="/",this.platform="browser",this.argv=[],this.execArgv=[],this.stdout=null,this.stderr=null,this.stdin=null,this.domain=null,this._queue=new g,this.execPath=m,this.env={},this.exitCode=0,this._gid=1,this._uid=1,this.version="v5.0",this.versions={http_parser:"0.0",node:"5.0",v8:"0.0",uv:"0.0",zlib:"0.0",ares:"0.0",icu:"0.0",modules:"0",openssl:"0.0"},this.config={target_defaults:{cflags:[],default_configuration:"Release",defines:[],include_dirs:[],libraries:[]},variables:{clang:0,host_arch:"x32",node_install_npm:!1,node_install_waf:!1,node_prefix:"",node_shared_cares:!1,node_shared_http_parser:!1,node_shared_libuv:!1,node_shared_zlib:!1,node_shared_v8:!1,node_use_dtrace:!1,node_use_etw:!1,node_use_openssl:!1,node_shared_openssl:!1,strict_aliasing:!1,target_arch:"x32",v8_use_snapshot:!1,v8_no_strict_aliasing:0,visibility:""}},this.pid=Math.random()*1e3|0,this.title="node",this.arch="x32",this._mask=18,this.connected=void 0}return u.prototype.chdir=function(N){I===null&&(I=y(9)),this._cwd=I.resolve(N)},u.prototype.cwd=function(){return this._cwd},u.prototype.uptime=function(){return(Date.now()-this.startTime)/1e3|0},u.prototype.nextTick=function(N){for(var x=[],O=1;O<arguments.length;O++)x[O-1]=arguments[O];this._queue.push(new S(N,x))},u.prototype.abort=function(){this.emit("abort")},u.prototype.exit=function(N){this.exitCode=N,this.emit("exit",[N])},u.prototype.getgid=function(){return this._gid},u.prototype.setgid=function(N){typeof N=="number"?this._gid=N:this._gid=1},u.prototype.getuid=function(){return this._uid},u.prototype.setuid=function(N){typeof N=="number"?this._uid=N:this._uid=1},u.prototype.kill=function(N,x){this.emit("kill",[N,x])},u.prototype.memoryUsage=function(){return{rss:0,heapTotal:0,heapUsed:0}},u.prototype.umask=function(N){N===void 0&&(N=this._mask);var x=this._mask;return this._mask=N,this.emit("umask",[N]),x},u.prototype.hrtime=function(){var N;typeof performance<"u"?N=performance.now():Date.now?N=Date.now():N=new Date().getTime();var x=N/1e3|0;return N-=x*1e3,N=N*1e6|0,[x,N]},u.prototype.initializeTTYs=function(){if(this.stdout===null){var N=y(10);this.stdout=new N,this.stderr=new N,this.stdin=new N}},u.prototype.disconnect=function(){},u})(w.EventEmitter);f.exports=a}).call(p,"/")},function(f,p){function y(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}f.exports=y,y.EventEmitter=y,y.prototype._events=void 0,y.prototype._maxListeners=void 0,y.defaultMaxListeners=10,y.prototype.setMaxListeners=function(S){if(!k(S)||S<0||isNaN(S))throw TypeError("n must be a positive number");return this._maxListeners=S,this},y.prototype.emit=function(S){var g,a,_,u,N,x;if(this._events||(this._events={}),S==="error"&&(!this._events.error||w(this._events.error)&&!this._events.error.length)){if(g=arguments[1],g instanceof Error)throw g;var O=new Error('Uncaught, unspecified "error" event. ('+g+")");throw O.context=g,O}if(a=this._events[S],I(a))return!1;if(m(a))switch(arguments.length){case 1:a.call(this);break;case 2:a.call(this,arguments[1]);break;case 3:a.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),a.apply(this,u)}else if(w(a))for(u=Array.prototype.slice.call(arguments,1),x=a.slice(),_=x.length,N=0;N<_;N++)x[N].apply(this,u);return!0},y.prototype.addListener=function(S,g){var a;if(!m(g))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",S,m(g.listener)?g.listener:g),this._events[S]?w(this._events[S])?this._events[S].push(g):this._events[S]=[this._events[S],g]:this._events[S]=g,w(this._events[S])&&!this._events[S].warned&&(I(this._maxListeners)?a=y.defaultMaxListeners:a=this._maxListeners,a&&a>0&&this._events[S].length>a&&(this._events[S].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[S].length),typeof console.trace=="function"&&console.trace())),this},y.prototype.on=y.prototype.addListener,y.prototype.once=function(S,g){if(!m(g))throw TypeError("listener must be a function");var a=!1;function _(){this.removeListener(S,_),a||(a=!0,g.apply(this,arguments))}return _.listener=g,this.on(S,_),this},y.prototype.removeListener=function(S,g){var a,_,u,N;if(!m(g))throw TypeError("listener must be a function");if(!this._events||!this._events[S])return this;if(a=this._events[S],u=a.length,_=-1,a===g||m(a.listener)&&a.listener===g)delete this._events[S],this._events.removeListener&&this.emit("removeListener",S,g);else if(w(a)){for(N=u;N-- >0;)if(a[N]===g||a[N].listener&&a[N].listener===g){_=N;break}if(_<0)return this;a.length===1?(a.length=0,delete this._events[S]):a.splice(_,1),this._events.removeListener&&this.emit("removeListener",S,g)}return this},y.prototype.removeAllListeners=function(S){var g,a;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[S]&&delete this._events[S],this;if(arguments.length===0){for(g in this._events)g!=="removeListener"&&this.removeAllListeners(g);return this.removeAllListeners("removeListener"),this._events={},this}if(a=this._events[S],m(a))this.removeListener(S,a);else if(a)for(;a.length;)this.removeListener(S,a[a.length-1]);return delete this._events[S],this},y.prototype.listeners=function(S){var g;return!this._events||!this._events[S]?g=[]:m(this._events[S])?g=[this._events[S]]:g=this._events[S].slice(),g},y.prototype.listenerCount=function(S){if(this._events){var g=this._events[S];if(m(g))return 1;if(g)return g.length}return 0},y.listenerCount=function(S,g){return S.listenerCount(g)};function m(S){return typeof S=="function"}function k(S){return typeof S=="number"}function w(S){return typeof S=="object"&&S!==null}function I(S){return S===void 0}},function(f,p,y){(function(m){var k=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;function w(S){var g=k.exec(S);return g.shift(),g}var I=(function(){function S(){}return S.normalize=function(g){g===""&&(g=".");var a=g.charAt(0)===S.sep;g=S._removeDuplicateSeps(g);for(var _=g.split(S.sep),u=[],N=0;N<_.length;N++){var x=_[N];x!=="."&&(x===".."&&(a||!a&&u.length>0&&u[0]!=="..")?u.pop():u.push(x))}return!a&&u.length<2&&(u.length===1?u[0]===""&&u.unshift("."):u.push(".")),g=u.join(S.sep),a&&g.charAt(0)!==S.sep&&(g=S.sep+g),g},S.join=function(){for(var g=[],a=0;a<arguments.length;a++)g[a-0]=arguments[a];for(var _=[],u=0;u<g.length;u++){var N=g[u];if(typeof N!="string")throw new TypeError("Invalid argument type to path.join: "+typeof N);N!==""&&_.push(N)}return S.normalize(_.join(S.sep))},S.resolve=function(){for(var g=[],a=0;a<arguments.length;a++)g[a-0]=arguments[a];for(var _=[],u=0;u<g.length;u++){var N=g[u];if(typeof N!="string")throw new TypeError("Invalid argument type to path.join: "+typeof N);N!==""&&(N.charAt(0)===S.sep&&(_=[]),_.push(N))}var x=S.normalize(_.join(S.sep));if(x.length>1&&x.charAt(x.length-1)===S.sep)return x.substr(0,x.length-1);if(x.charAt(0)!==S.sep){x.charAt(0)==="."&&(x.length===1||x.charAt(1)===S.sep)&&(x=x.length===1?"":x.substr(2));var O=m.cwd();x!==""?x=this.normalize(O+(O!=="/"?S.sep:"")+x):x=O}return x},S.relative=function(g,a){var _;g=S.resolve(g),a=S.resolve(a);var u=g.split(S.sep),N=a.split(S.sep);N.shift(),u.shift();var x=0,O=[];for(_=0;_<u.length;_++){var C=u[_];if(C!==N[_]){x=u.length-_;break}}O=N.slice(_),u.length===1&&u[0]===""&&(x=0),x>u.length&&(x=u.length);var A="";for(_=0;_<x;_++)A+="../";return A+=O.join(S.sep),A.length>1&&A.charAt(A.length-1)===S.sep&&(A=A.substr(0,A.length-1)),A},S.dirname=function(g){g=S._removeDuplicateSeps(g);var a=g.charAt(0)===S.sep,_=g.split(S.sep);return _.pop()===""&&_.length>0&&_.pop(),_.length>1||_.length===1&&!a?_.join(S.sep):a?S.sep:"."},S.basename=function(g,a){if(a===void 0&&(a=""),g==="")return g;g=S.normalize(g);var _=g.split(S.sep),u=_[_.length-1];if(u===""&&_.length>1)return _[_.length-2];if(a.length>0){var N=u.substr(u.length-a.length);if(N===a)return u.substr(0,u.length-a.length)}return u},S.extname=function(g){g=S.normalize(g);var a=g.split(S.sep);if(g=a.pop(),g===""&&a.length>0&&(g=a.pop()),g==="..")return"";var _=g.lastIndexOf(".");return _===-1||_===0?"":g.substr(_)},S.isAbsolute=function(g){return g.length>0&&g.charAt(0)===S.sep},S._makeLong=function(g){return g},S.parse=function(g){var a=w(g);return{root:a[0],dir:a[0]+a[1].slice(0,-1),base:a[2],ext:a[3],name:a[2].slice(0,a[2].length-a[3].length)}},S.format=function(g){if(g===null||typeof g!="object")throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof g);var a=g.root||"";if(typeof a!="string")throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof g.root);var _=g.dir?g.dir+S.sep:"",u=g.base||"";return _+u},S._removeDuplicateSeps=function(g){return g=g.replace(this._replaceRegex,this.sep),g},S.sep="/",S._replaceRegex=new RegExp("//+","g"),S.delimiter=":",S.posix=S,S.win32=S,S})();f.exports=I}).call(p,y(6))},function(f,p,y){(function(m){var k=this&&this.__extends||function(S,g){for(var a in g)g.hasOwnProperty(a)&&(S[a]=g[a]);function _(){this.constructor=S}S.prototype=g===null?Object.create(g):(_.prototype=g.prototype,new _)},w=y(11),I=(function(S){k(g,S);function g(){S.call(this),this.isRaw=!1,this.columns=80,this.rows=120,this.isTTY=!0,this._bufferedWrites=[],this._waitingForWrites=!1}return g.prototype.setRawMode=function(a){this.isRaw!==a&&(this.isRaw=a,this.emit("modeChange"))},g.prototype.changeColumns=function(a){a!==this.columns&&(this.columns=a,this.emit("resize"))},g.prototype.changeRows=function(a){a!==this.rows&&(this.rows=a,this.emit("resize"))},g.isatty=function(a){return a&&a instanceof g},g.prototype._write=function(a,_,u){var N;try{var x;typeof a=="string"?x=new m(a,_):x=a,this._bufferedWrites.push(x),this._waitingForWrites&&this._read(1024)}catch(O){N=O}finally{u(N)}},g.prototype._read=function(a){if(this._bufferedWrites.length===0)this._waitingForWrites=!0;else for(;this._bufferedWrites.length>0&&(this._waitingForWrites=this.push(this._bufferedWrites.shift()),!!this._waitingForWrites););},g})(w.Duplex);f.exports=I}).call(p,y(1))},function(f,p,y){f.exports=w;var m=y(8).EventEmitter,k=y(12);k(w,m),w.Readable=y(13),w.Writable=y(27),w.Duplex=y(28),w.Transform=y(29),w.PassThrough=y(30),w.Stream=w;function w(){m.call(this)}w.prototype.pipe=function(I,S){var g=this;function a(A){I.writable&&I.write(A)===!1&&g.pause&&g.pause()}g.on("data",a);function _(){g.readable&&g.resume&&g.resume()}I.on("drain",_),!I._isStdio&&(!S||S.end!==!1)&&(g.on("end",N),g.on("close",x));var u=!1;function N(){u||(u=!0,I.end())}function x(){u||(u=!0,typeof I.destroy=="function"&&I.destroy())}function O(A){if(C(),m.listenerCount(this,"error")===0)throw A}g.on("error",O),I.on("error",O);function C(){g.removeListener("data",a),I.removeListener("drain",_),g.removeListener("end",N),g.removeListener("close",x),g.removeListener("error",O),I.removeListener("error",O),g.removeListener("end",C),g.removeListener("close",C),I.removeListener("close",C)}return g.on("end",C),g.on("close",C),I.on("close",C),I.emit("pipe",g),I}},function(f,p){typeof Object.create=="function"?f.exports=function(m,k){m.super_=k,m.prototype=Object.create(k.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}})}:f.exports=function(m,k){m.super_=k;var w=function(){};w.prototype=k.prototype,m.prototype=new w,m.prototype.constructor=m}},function(f,p,y){(function(m){var k=(function(){try{return y(11)}catch{}})();p=f.exports=y(14),p.Stream=k||p,p.Readable=p,p.Writable=y(22),p.Duplex=y(21),p.Transform=y(25),p.PassThrough=y(26),!m.browser&&m.env.READABLE_STREAM==="disable"&&k&&(f.exports=k)}).call(p,y(6))},function(f,p,y){(function(m){f.exports=B;var k=y(15),w=y(16),I;B.ReadableState=J,y(8).EventEmitter;var S=function(F,T){return F.listeners(T).length},g;(function(){try{g=y(11)}catch{}finally{g||(g=y(8).EventEmitter)}})();var a=y(2).Buffer,_=y(17),u=y(18);u.inherits=y(12);var N=y(19),x=void 0;N&&N.debuglog?x=N.debuglog("stream"):x=function(){};var O=y(20),C;u.inherits(B,g);function A(F,T,Z){if(typeof F.prependListener=="function")return F.prependListener(T,Z);!F._events||!F._events[T]?F.on(T,Z):w(F._events[T])?F._events[T].unshift(Z):F._events[T]=[Z,F._events[T]]}function J(F,T){I=I||y(21),F=F||{},this.objectMode=!!F.objectMode,T instanceof I&&(this.objectMode=this.objectMode||!!F.readableObjectMode);var Z=F.highWaterMark,it=this.objectMode?16:16*1024;this.highWaterMark=Z||Z===0?Z:it,this.highWaterMark=~~this.highWaterMark,this.buffer=new O,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=F.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,F.encoding&&(C||(C=y(24).StringDecoder),this.decoder=new C(F.encoding),this.encoding=F.encoding)}function B(F){if(I=I||y(21),!(this instanceof B))return new B(F);this._readableState=new J(F,this),this.readable=!0,F&&typeof F.read=="function"&&(this._read=F.read),g.call(this)}B.prototype.push=function(F,T){var Z=this._readableState;return!Z.objectMode&&typeof F=="string"&&(T=T||Z.defaultEncoding,T!==Z.encoding&&(F=_.from(F,T),T="")),H(this,Z,F,T,!1)},B.prototype.unshift=function(F){var T=this._readableState;return H(this,T,F,"",!0)},B.prototype.isPaused=function(){return this._readableState.flowing===!1};function H(F,T,Z,it,pt){var bt=z(T,Z);if(bt)F.emit("error",bt);else if(Z===null)T.reading=!1,et(F,T);else if(T.objectMode||Z&&Z.length>0)if(T.ended&&!pt){var Q=new Error("stream.push() after EOF");F.emit("error",Q)}else if(T.endEmitted&&pt){var ne=new Error("stream.unshift() after end event");F.emit("error",ne)}else{var vt;T.decoder&&!pt&&!it&&(Z=T.decoder.write(Z),vt=!T.objectMode&&Z.length===0),pt||(T.reading=!1),vt||(T.flowing&&T.length===0&&!T.sync?(F.emit("data",Z),F.read(0)):(T.length+=T.objectMode?1:Z.length,pt?T.buffer.unshift(Z):T.buffer.push(Z),T.needReadable&&lt(F))),mt(F,T)}else pt||(T.reading=!1);return St(T)}function St(F){return!F.ended&&(F.needReadable||F.length<F.highWaterMark||F.length===0)}B.prototype.setEncoding=function(F){return C||(C=y(24).StringDecoder),this._readableState.decoder=new C(F),this._readableState.encoding=F,this};var tt=8388608;function kt(F){return F>=tt?F=tt:(F--,F|=F>>>1,F|=F>>>2,F|=F>>>4,F|=F>>>8,F|=F>>>16,F++),F}function dt(F,T){return F<=0||T.length===0&&T.ended?0:T.objectMode?1:F!==F?T.flowing&&T.length?T.buffer.head.data.length:T.length:(F>T.highWaterMark&&(T.highWaterMark=kt(F)),F<=T.length?F:T.ended?T.length:(T.needReadable=!0,0))}B.prototype.read=function(F){x("read",F),F=parseInt(F,10);var T=this._readableState,Z=F;if(F!==0&&(T.emittedReadable=!1),F===0&&T.needReadable&&(T.length>=T.highWaterMark||T.ended))return x("read: emitReadable",T.length,T.ended),T.length===0&&T.ended?_t(this):lt(this),null;if(F=dt(F,T),F===0&&T.ended)return T.length===0&&_t(this),null;var it=T.needReadable;x("need readable",it),(T.length===0||T.length-F<T.highWaterMark)&&(it=!0,x("length less than watermark",it)),T.ended||T.reading?(it=!1,x("reading or ended",it)):it&&(x("do read"),T.reading=!0,T.sync=!0,T.length===0&&(T.needReadable=!0),this._read(T.highWaterMark),T.sync=!1,T.reading||(F=dt(Z,T)));var pt;return F>0?pt=K(F,T):pt=null,pt===null?(T.needReadable=!0,F=0):T.length-=F,T.length===0&&(T.ended||(T.needReadable=!0),Z!==F&&T.ended&&_t(this)),pt!==null&&this.emit("data",pt),pt};function z(F,T){var Z=null;return!a.isBuffer(T)&&typeof T!="string"&&T!==null&&T!==void 0&&!F.objectMode&&(Z=new TypeError("Invalid non-string/buffer chunk")),Z}function et(F,T){if(!T.ended){if(T.decoder){var Z=T.decoder.end();Z&&Z.length&&(T.buffer.push(Z),T.length+=T.objectMode?1:Z.length)}T.ended=!0,lt(F)}}function lt(F){var T=F._readableState;T.needReadable=!1,T.emittedReadable||(x("emitReadable",T.flowing),T.emittedReadable=!0,T.sync?k(Ft,F):Ft(F))}function Ft(F){x("emit readable"),F.emit("readable"),U(F)}function mt(F,T){T.readingMore||(T.readingMore=!0,k(Ct,F,T))}function Ct(F,T){for(var Z=T.length;!T.reading&&!T.flowing&&!T.ended&&T.length<T.highWaterMark&&(x("maybeReadMore read 0"),F.read(0),Z!==T.length);)Z=T.length;T.readingMore=!1}B.prototype._read=function(F){this.emit("error",new Error("_read() is not implemented"))},B.prototype.pipe=function(F,T){var Z=this,it=this._readableState;switch(it.pipesCount){case 0:it.pipes=F;break;case 1:it.pipes=[it.pipes,F];break;default:it.pipes.push(F);break}it.pipesCount+=1,x("pipe count=%d opts=%j",it.pipesCount,T);var pt=(!T||T.end!==!1)&&F!==m.stdout&&F!==m.stderr,bt=pt?ne:le;it.endEmitted?k(bt):Z.once("end",bt),F.on("unpipe",Q);function Q(G){x("onunpipe"),G===Z&&le()}function ne(){x("onend"),F.end()}var vt=Lt(Z);F.on("drain",vt);var oe=!1;function le(){x("cleanup"),F.removeListener("close",d),F.removeListener("finish",L),F.removeListener("drain",vt),F.removeListener("error",h),F.removeListener("unpipe",Q),Z.removeListener("end",ne),Z.removeListener("end",le),Z.removeListener("data",R),oe=!0,it.awaitDrain&&(!F._writableState||F._writableState.needDrain)&&vt()}var be=!1;Z.on("data",R);function R(G){x("ondata"),be=!1;var V=F.write(G);V===!1&&!be&&((it.pipesCount===1&&it.pipes===F||it.pipesCount>1&&Mt(it.pipes,F)!==-1)&&!oe&&(x("false write response, pause",Z._readableState.awaitDrain),Z._readableState.awaitDrain++,be=!0),Z.pause())}function h(G){x("onerror",G),P(),F.removeListener("error",h),S(F,"error")===0&&F.emit("error",G)}A(F,"error",h);function d(){F.removeListener("finish",L),P()}F.once("close",d);function L(){x("onfinish"),F.removeListener("close",d),P()}F.once("finish",L);function P(){x("unpipe"),Z.unpipe(F)}return F.emit("pipe",Z),it.flowing||(x("pipe resume"),Z.resume()),F};function Lt(F){return function(){var T=F._readableState;x("pipeOnDrain",T.awaitDrain),T.awaitDrain&&T.awaitDrain--,T.awaitDrain===0&&S(F,"data")&&(T.flowing=!0,U(F))}}B.prototype.unpipe=function(F){var T=this._readableState;if(T.pipesCount===0)return this;if(T.pipesCount===1)return F&&F!==T.pipes?this:(F||(F=T.pipes),T.pipes=null,T.pipesCount=0,T.flowing=!1,F&&F.emit("unpipe",this),this);if(!F){var Z=T.pipes,it=T.pipesCount;T.pipes=null,T.pipesCount=0,T.flowing=!1;for(var pt=0;pt<it;pt++)Z[pt].emit("unpipe",this);return this}var bt=Mt(T.pipes,F);return bt===-1?this:(T.pipes.splice(bt,1),T.pipesCount-=1,T.pipesCount===1&&(T.pipes=T.pipes[0]),F.emit("unpipe",this),this)},B.prototype.on=function(F,T){var Z=g.prototype.on.call(this,F,T);if(F==="data")this._readableState.flowing!==!1&&this.resume();else if(F==="readable"){var it=this._readableState;!it.endEmitted&&!it.readableListening&&(it.readableListening=it.needReadable=!0,it.emittedReadable=!1,it.reading?it.length&&lt(this):k(Et,this))}return Z},B.prototype.addListener=B.prototype.on;function Et(F){x("readable nexttick read 0"),F.read(0)}B.prototype.resume=function(){var F=this._readableState;return F.flowing||(x("resume"),F.flowing=!0,Zt(this,F)),this};function Zt(F,T){T.resumeScheduled||(T.resumeScheduled=!0,k(j,F,T))}function j(F,T){T.reading||(x("resume read 0"),F.read(0)),T.resumeScheduled=!1,T.awaitDrain=0,F.emit("resume"),U(F),T.flowing&&!T.reading&&F.read(0)}B.prototype.pause=function(){return x("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(x("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function U(F){var T=F._readableState;for(x("flow",T.flowing);T.flowing&&F.read()!==null;);}B.prototype.wrap=function(F){var T=this._readableState,Z=!1,it=this;F.on("end",function(){if(x("wrapped end"),T.decoder&&!T.ended){var Q=T.decoder.end();Q&&Q.length&&it.push(Q)}it.push(null)}),F.on("data",function(Q){if(x("wrapped data"),T.decoder&&(Q=T.decoder.write(Q)),!(T.objectMode&&Q==null)&&!(!T.objectMode&&(!Q||!Q.length))){var ne=it.push(Q);ne||(Z=!0,F.pause())}});for(var pt in F)this[pt]===void 0&&typeof F[pt]=="function"&&(this[pt]=(function(Q){return function(){return F[Q].apply(F,arguments)}})(pt));var bt=["error","close","destroy","pause","resume"];return Wt(bt,function(Q){F.on(Q,it.emit.bind(it,Q))}),it._read=function(Q){x("wrapped _read",Q),Z&&(Z=!1,F.resume())},it},B._fromList=K;function K(F,T){if(T.length===0)return null;var Z;return T.objectMode?Z=T.buffer.shift():!F||F>=T.length?(T.decoder?Z=T.buffer.join(""):T.buffer.length===1?Z=T.buffer.head.data:Z=T.buffer.concat(T.length),T.buffer.clear()):Z=ft(F,T.buffer,T.decoder),Z}function ft(F,T,Z){var it;return F<T.head.data.length?(it=T.head.data.slice(0,F),T.head.data=T.head.data.slice(F)):F===T.head.data.length?it=T.shift():it=Z?Rt(F,T):gt(F,T),it}function Rt(F,T){var Z=T.head,it=1,pt=Z.data;for(F-=pt.length;Z=Z.next;){var bt=Z.data,Q=F>bt.length?bt.length:F;if(Q===bt.length?pt+=bt:pt+=bt.slice(0,F),F-=Q,F===0){Q===bt.length?(++it,Z.next?T.head=Z.next:T.head=T.tail=null):(T.head=Z,Z.data=bt.slice(Q));break}++it}return T.length-=it,pt}function gt(F,T){var Z=_.allocUnsafe(F),it=T.head,pt=1;for(it.data.copy(Z),F-=it.data.length;it=it.next;){var bt=it.data,Q=F>bt.length?bt.length:F;if(bt.copy(Z,Z.length-F,0,Q),F-=Q,F===0){Q===bt.length?(++pt,it.next?T.head=it.next:T.head=T.tail=null):(T.head=it,it.data=bt.slice(Q));break}++pt}return T.length-=pt,Z}function _t(F){var T=F._readableState;if(T.length>0)throw new Error('"endReadable()" called on non-empty stream');T.endEmitted||(T.ended=!0,k(Tt,T,F))}function Tt(F,T){!F.endEmitted&&F.length===0&&(F.endEmitted=!0,T.readable=!1,T.emit("end"))}function Wt(F,T){for(var Z=0,it=F.length;Z<it;Z++)T(F[Z],Z)}function Mt(F,T){for(var Z=0,it=F.length;Z<it;Z++)if(F[Z]===T)return Z;return-1}}).call(p,y(6))},function(f,p,y){(function(m){!m.version||m.version.indexOf("v0.")===0||m.version.indexOf("v1.")===0&&m.version.indexOf("v1.8.")!==0?f.exports=k:f.exports=m.nextTick;function k(w,I,S,g){if(typeof w!="function")throw new TypeError('"callback" argument must be a function');var a=arguments.length,_,u;switch(a){case 0:case 1:return m.nextTick(w);case 2:return m.nextTick(function(){w.call(null,I)});case 3:return m.nextTick(function(){w.call(null,I,S)});case 4:return m.nextTick(function(){w.call(null,I,S,g)});default:for(_=new Array(a-1),u=0;u<_.length;)_[u++]=arguments[u];return m.nextTick(function(){w.apply(null,_)})}}}).call(p,y(6))},function(f,p){var y={}.toString;f.exports=Array.isArray||function(m){return y.call(m)=="[object Array]"}},function(f,p,y){(function(m){var k=y(2),w=k.Buffer,I=k.SlowBuffer,S=k.kMaxLength||2147483647;p.alloc=function(a,_,u){if(typeof w.alloc=="function")return w.alloc(a,_,u);if(typeof u=="number")throw new TypeError("encoding must not be number");if(typeof a!="number")throw new TypeError("size must be a number");if(a>S)throw new RangeError("size is too large");var N=u,x=_;x===void 0&&(N=void 0,x=0);var O=new w(a);if(typeof x=="string")for(var C=new w(x,N),A=C.length,J=-1;++J<a;)O[J]=C[J%A];else O.fill(x);return O},p.allocUnsafe=function(a){if(typeof w.allocUnsafe=="function")return w.allocUnsafe(a);if(typeof a!="number")throw new TypeError("size must be a number");if(a>S)throw new RangeError("size is too large");return new w(a)},p.from=function(a,_,u){if(typeof w.from=="function"&&(!m.Uint8Array||Uint8Array.from!==w.from))return w.from(a,_,u);if(typeof a=="number")throw new TypeError('"value" argument must not be a number');if(typeof a=="string")return new w(a,_);if(typeof ArrayBuffer<"u"&&a instanceof ArrayBuffer){var N=_;if(arguments.length===1)return new w(a);typeof N>"u"&&(N=0);var x=u;if(typeof x>"u"&&(x=a.byteLength-N),N>=a.byteLength)throw new RangeError("'offset' is out of bounds");if(x>a.byteLength-N)throw new RangeError("'length' is out of bounds");return new w(a.slice(N,N+x))}if(w.isBuffer(a)){var O=new w(a.length);return a.copy(O,0,0,a.length),O}if(a){if(Array.isArray(a)||typeof ArrayBuffer<"u"&&a.buffer instanceof ArrayBuffer||"length"in a)return new w(a);if(a.type==="Buffer"&&Array.isArray(a.data))return new w(a.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},p.allocUnsafeSlow=function(a){if(typeof w.allocUnsafeSlow=="function")return w.allocUnsafeSlow(a);if(typeof a!="number")throw new TypeError("size must be a number");if(a>=S)throw new RangeError("size is too large");return new I(a)}}).call(p,(function(){return this})())},function(f,p,y){(function(m){function k(H){return Array.isArray?Array.isArray(H):B(H)==="[object Array]"}p.isArray=k;function w(H){return typeof H=="boolean"}p.isBoolean=w;function I(H){return H===null}p.isNull=I;function S(H){return H==null}p.isNullOrUndefined=S;function g(H){return typeof H=="number"}p.isNumber=g;function a(H){return typeof H=="string"}p.isString=a;function _(H){return typeof H=="symbol"}p.isSymbol=_;function u(H){return H===void 0}p.isUndefined=u;function N(H){return B(H)==="[object RegExp]"}p.isRegExp=N;function x(H){return typeof H=="object"&&H!==null}p.isObject=x;function O(H){return B(H)==="[object Date]"}p.isDate=O;function C(H){return B(H)==="[object Error]"||H instanceof Error}p.isError=C;function A(H){return typeof H=="function"}p.isFunction=A;function J(H){return H===null||typeof H=="boolean"||typeof H=="number"||typeof H=="string"||typeof H=="symbol"||typeof H>"u"}p.isPrimitive=J,p.isBuffer=m.isBuffer;function B(H){return Object.prototype.toString.call(H)}}).call(p,y(1))},function(f,p){},function(f,p,y){y(2).Buffer;var m=y(17);f.exports=k;function k(){this.head=null,this.tail=null,this.length=0}k.prototype.push=function(w){var I={data:w,next:null};this.length>0?this.tail.next=I:this.head=I,this.tail=I,++this.length},k.prototype.unshift=function(w){var I={data:w,next:this.head};this.length===0&&(this.tail=I),this.head=I,++this.length},k.prototype.shift=function(){if(this.length!==0){var w=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,w}},k.prototype.clear=function(){this.head=this.tail=null,this.length=0},k.prototype.join=function(w){if(this.length===0)return"";for(var I=this.head,S=""+I.data;I=I.next;)S+=w+I.data;return S},k.prototype.concat=function(w){if(this.length===0)return m.alloc(0);if(this.length===1)return this.head.data;for(var I=m.allocUnsafe(w>>>0),S=this.head,g=0;S;)S.data.copy(I,g),g+=S.data.length,S=S.next;return I}},function(f,p,y){var m=Object.keys||function(O){var C=[];for(var A in O)C.push(A);return C};f.exports=u;var k=y(15),w=y(18);w.inherits=y(12);var I=y(14),S=y(22);w.inherits(u,I);for(var g=m(S.prototype),a=0;a<g.length;a++){var _=g[a];u.prototype[_]||(u.prototype[_]=S.prototype[_])}function u(O){if(!(this instanceof u))return new u(O);I.call(this,O),S.call(this,O),O&&O.readable===!1&&(this.readable=!1),O&&O.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,O&&O.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",N)}function N(){this.allowHalfOpen||this._writableState.ended||k(x,this)}function x(O){O.end()}},function(f,p,y){(function(m){f.exports=A;var k=y(15),w=!m.browser&&["v0.10","v0.9."].indexOf(m.version.slice(0,5))>-1?setImmediate:k,I;A.WritableState=O;var S=y(18);S.inherits=y(12);var g={deprecate:y(23)},a;(function(){try{a=y(11)}catch{}finally{a||(a=y(8).EventEmitter)}})();var _=y(2).Buffer,u=y(17);S.inherits(A,a);function N(){}function x(j,U,K){this.chunk=j,this.encoding=U,this.callback=K,this.next=null}function O(j,U){I=I||y(21),j=j||{},this.objectMode=!!j.objectMode,U instanceof I&&(this.objectMode=this.objectMode||!!j.writableObjectMode);var K=j.highWaterMark,ft=this.objectMode?16:16*1024;this.highWaterMark=K||K===0?K:ft,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var Rt=j.decodeStrings===!1;this.decodeStrings=!Rt,this.defaultEncoding=j.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(gt){z(U,gt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Zt(this)}O.prototype.getBuffer=function(){for(var U=this.bufferedRequest,K=[];U;)K.push(U),U=U.next;return K},(function(){try{Object.defineProperty(O.prototype,"buffer",{get:g.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch{}})();var C;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(C=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(j){return C.call(this,j)?!0:j&&j._writableState instanceof O}})):C=function(j){return j instanceof this};function A(j){if(I=I||y(21),!C.call(A,this)&&!(this instanceof I))return new A(j);this._writableState=new O(j,this),this.writable=!0,j&&(typeof j.write=="function"&&(this._write=j.write),typeof j.writev=="function"&&(this._writev=j.writev)),a.call(this)}A.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function J(j,U){var K=new Error("write after end");j.emit("error",K),k(U,K)}function B(j,U,K,ft){var Rt=!0,gt=!1;return K===null?gt=new TypeError("May not write null values to stream"):typeof K!="string"&&K!==void 0&&!U.objectMode&&(gt=new TypeError("Invalid non-string/buffer chunk")),gt&&(j.emit("error",gt),k(ft,gt),Rt=!1),Rt}A.prototype.write=function(j,U,K){var ft=this._writableState,Rt=!1,gt=_.isBuffer(j);return typeof U=="function"&&(K=U,U=null),gt?U="buffer":U||(U=ft.defaultEncoding),typeof K!="function"&&(K=N),ft.ended?J(this,K):(gt||B(this,ft,j,K))&&(ft.pendingcb++,Rt=St(this,ft,gt,j,U,K)),Rt},A.prototype.cork=function(){var j=this._writableState;j.corked++},A.prototype.uncork=function(){var j=this._writableState;j.corked&&(j.corked--,!j.writing&&!j.corked&&!j.finished&&!j.bufferProcessing&&j.bufferedRequest&&Ft(this,j))},A.prototype.setDefaultEncoding=function(U){if(typeof U=="string"&&(U=U.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((U+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+U);return this._writableState.defaultEncoding=U,this};function H(j,U,K){return!j.objectMode&&j.decodeStrings!==!1&&typeof U=="string"&&(U=u.from(U,K)),U}function St(j,U,K,ft,Rt,gt){K||(ft=H(U,ft,Rt),_.isBuffer(ft)&&(Rt="buffer"));var _t=U.objectMode?1:ft.length;U.length+=_t;var Tt=U.length<U.highWaterMark;if(Tt||(U.needDrain=!0),U.writing||U.corked){var Wt=U.lastBufferedRequest;U.lastBufferedRequest=new x(ft,Rt,gt),Wt?Wt.next=U.lastBufferedRequest:U.bufferedRequest=U.lastBufferedRequest,U.bufferedRequestCount+=1}else tt(j,U,!1,_t,ft,Rt,gt);return Tt}function tt(j,U,K,ft,Rt,gt,_t){U.writelen=ft,U.writecb=_t,U.writing=!0,U.sync=!0,K?j._writev(Rt,U.onwrite):j._write(Rt,gt,U.onwrite),U.sync=!1}function kt(j,U,K,ft,Rt){--U.pendingcb,K?k(Rt,ft):Rt(ft),j._writableState.errorEmitted=!0,j.emit("error",ft)}function dt(j){j.writing=!1,j.writecb=null,j.length-=j.writelen,j.writelen=0}function z(j,U){var K=j._writableState,ft=K.sync,Rt=K.writecb;if(dt(K),U)kt(j,K,ft,U,Rt);else{var gt=mt(K);!gt&&!K.corked&&!K.bufferProcessing&&K.bufferedRequest&&Ft(j,K),ft?w(et,j,K,gt,Rt):et(j,K,gt,Rt)}}function et(j,U,K,ft){K||lt(j,U),U.pendingcb--,ft(),Lt(j,U)}function lt(j,U){U.length===0&&U.needDrain&&(U.needDrain=!1,j.emit("drain"))}function Ft(j,U){U.bufferProcessing=!0;var K=U.bufferedRequest;if(j._writev&&K&&K.next){var ft=U.bufferedRequestCount,Rt=new Array(ft),gt=U.corkedRequestsFree;gt.entry=K;for(var _t=0;K;)Rt[_t]=K,K=K.next,_t+=1;tt(j,U,!0,U.length,Rt,"",gt.finish),U.pendingcb++,U.lastBufferedRequest=null,gt.next?(U.corkedRequestsFree=gt.next,gt.next=null):U.corkedRequestsFree=new Zt(U)}else{for(;K;){var Tt=K.chunk,Wt=K.encoding,Mt=K.callback,F=U.objectMode?1:Tt.length;if(tt(j,U,!1,F,Tt,Wt,Mt),K=K.next,U.writing)break}K===null&&(U.lastBufferedRequest=null)}U.bufferedRequestCount=0,U.bufferedRequest=K,U.bufferProcessing=!1}A.prototype._write=function(j,U,K){K(new Error("_write() is not implemented"))},A.prototype._writev=null,A.prototype.end=function(j,U,K){var ft=this._writableState;typeof j=="function"?(K=j,j=null,U=null):typeof U=="function"&&(K=U,U=null),j!=null&&this.write(j,U),ft.corked&&(ft.corked=1,this.uncork()),!ft.ending&&!ft.finished&&Et(this,ft,K)};function mt(j){return j.ending&&j.length===0&&j.bufferedRequest===null&&!j.finished&&!j.writing}function Ct(j,U){U.prefinished||(U.prefinished=!0,j.emit("prefinish"))}function Lt(j,U){var K=mt(U);return K&&(U.pendingcb===0?(Ct(j,U),U.finished=!0,j.emit("finish")):Ct(j,U)),K}function Et(j,U,K){U.ending=!0,Lt(j,U),K&&(U.finished?k(K):j.once("finish",K)),U.ended=!0,j.writable=!1}function Zt(j){var U=this;this.next=null,this.entry=null,this.finish=function(K){var ft=U.entry;for(U.entry=null;ft;){var Rt=ft.callback;j.pendingcb--,Rt(K),ft=ft.next}j.corkedRequestsFree?j.corkedRequestsFree.next=U:j.corkedRequestsFree=U}}}).call(p,y(6))},function(f,p){(function(y){f.exports=m;function m(w,I){if(k("noDeprecation"))return w;var S=!1;function g(){if(!S){if(k("throwDeprecation"))throw new Error(I);k("traceDeprecation")?console.trace(I):console.warn(I),S=!0}return w.apply(this,arguments)}return g}function k(w){try{if(!y.localStorage)return!1}catch{return!1}var I=y.localStorage[w];return I==null?!1:String(I).toLowerCase()==="true"}}).call(p,(function(){return this})())},function(f,p,y){var m=y(2).Buffer,k=m.isEncoding||function(_){switch(_&&_.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function w(_){if(_&&!k(_))throw new Error("Unknown encoding: "+_)}var I=p.StringDecoder=function(_){switch(this.encoding=(_||"utf8").toLowerCase().replace(/[-_]/,""),w(_),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=g;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=a;break;default:this.write=S;return}this.charBuffer=new m(6),this.charReceived=0,this.charLength=0};I.prototype.write=function(_){for(var u="";this.charLength;){var N=_.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:_.length;if(_.copy(this.charBuffer,this.charReceived,0,N),this.charReceived+=N,this.charReceived<this.charLength)return"";_=_.slice(N,_.length),u=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var O=u.charCodeAt(u.length-1);if(O>=55296&&O<=56319){this.charLength+=this.surrogateSize,u="";continue}if(this.charReceived=this.charLength=0,_.length===0)return u;break}this.detectIncompleteChar(_);var x=_.length;this.charLength&&(_.copy(this.charBuffer,0,_.length-this.charReceived,x),x-=this.charReceived),u+=_.toString(this.encoding,0,x);var x=u.length-1,O=u.charCodeAt(x);if(O>=55296&&O<=56319){var C=this.surrogateSize;return this.charLength+=C,this.charReceived+=C,this.charBuffer.copy(this.charBuffer,C,0,C),_.copy(this.charBuffer,0,0,C),u.substring(0,x)}return u},I.prototype.detectIncompleteChar=function(_){for(var u=_.length>=3?3:_.length;u>0;u--){var N=_[_.length-u];if(u==1&&N>>5==6){this.charLength=2;break}if(u<=2&&N>>4==14){this.charLength=3;break}if(u<=3&&N>>3==30){this.charLength=4;break}}this.charReceived=u},I.prototype.end=function(_){var u="";if(_&&_.length&&(u=this.write(_)),this.charReceived){var N=this.charReceived,x=this.charBuffer,O=this.encoding;u+=x.slice(0,N).toString(O)}return u};function S(_){return _.toString(this.encoding)}function g(_){this.charReceived=_.length%2,this.charLength=this.charReceived?2:0}function a(_){this.charReceived=_.length%3,this.charLength=this.charReceived?3:0}},function(f,p,y){f.exports=S;var m=y(21),k=y(18);k.inherits=y(12),k.inherits(S,m);function w(a){this.afterTransform=function(_,u){return I(a,_,u)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function I(a,_,u){var N=a._transformState;N.transforming=!1;var x=N.writecb;if(!x)return a.emit("error",new Error("no writecb in Transform class"));N.writechunk=null,N.writecb=null,u!=null&&a.push(u),x(_);var O=a._readableState;O.reading=!1,(O.needReadable||O.length<O.highWaterMark)&&a._read(O.highWaterMark)}function S(a){if(!(this instanceof S))return new S(a);m.call(this,a),this._transformState=new w(this);var _=this;this._readableState.needReadable=!0,this._readableState.sync=!1,a&&(typeof a.transform=="function"&&(this._transform=a.transform),typeof a.flush=="function"&&(this._flush=a.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(u,N){g(_,u,N)}):g(_)})}S.prototype.push=function(a,_){return this._transformState.needTransform=!1,m.prototype.push.call(this,a,_)},S.prototype._transform=function(a,_,u){throw new Error("_transform() is not implemented")},S.prototype._write=function(a,_,u){var N=this._transformState;if(N.writecb=u,N.writechunk=a,N.writeencoding=_,!N.transforming){var x=this._readableState;(N.needTransform||x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}},S.prototype._read=function(a){var _=this._transformState;_.writechunk!==null&&_.writecb&&!_.transforming?(_.transforming=!0,this._transform(_.writechunk,_.writeencoding,_.afterTransform)):_.needTransform=!0};function g(a,_,u){if(_)return a.emit("error",_);u!=null&&a.push(u);var N=a._writableState,x=a._transformState;if(N.length)throw new Error("Calling transform done when ws.length != 0");if(x.transforming)throw new Error("Calling transform done when still transforming");return a.push(null)}},function(f,p,y){f.exports=w;var m=y(25),k=y(18);k.inherits=y(12),k.inherits(w,m);function w(I){if(!(this instanceof w))return new w(I);m.call(this,I)}w.prototype._transform=function(I,S,g){g(null,I)}},function(f,p,y){f.exports=y(22)},function(f,p,y){f.exports=y(21)},function(f,p,y){f.exports=y(25)},function(f,p,y){f.exports=y(26)},function(f,p,y){var m=y(32),k=y(33),w=y(38),I=y(39),S=y(40),g=y(41),a=y(42),_=Object.prototype.toString;function u(O){if(!(this instanceof u))return new u(O);this.options=k.assign({chunkSize:16384,windowBits:0,to:""},O||{});var C=this.options;C.raw&&C.windowBits>=0&&C.windowBits<16&&(C.windowBits=-C.windowBits,C.windowBits===0&&(C.windowBits=-15)),C.windowBits>=0&&C.windowBits<16&&!(O&&O.windowBits)&&(C.windowBits+=32),C.windowBits>15&&C.windowBits<48&&(C.windowBits&15)===0&&(C.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var A=m.inflateInit2(this.strm,C.windowBits);if(A!==I.Z_OK)throw new Error(S[A]);this.header=new a,m.inflateGetHeader(this.strm,this.header)}u.prototype.push=function(O,C){var A=this.strm,J=this.options.chunkSize,B=this.options.dictionary,H,St,tt,kt,dt,z,et=!1;if(this.ended)return!1;St=C===~~C?C:C===!0?I.Z_FINISH:I.Z_NO_FLUSH,typeof O=="string"?A.input=w.binstring2buf(O):_.call(O)==="[object ArrayBuffer]"?A.input=new Uint8Array(O):A.input=O,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new k.Buf8(J),A.next_out=0,A.avail_out=J),H=m.inflate(A,I.Z_NO_FLUSH),H===I.Z_NEED_DICT&&B&&(typeof B=="string"?z=w.string2buf(B):_.call(B)==="[object ArrayBuffer]"?z=new Uint8Array(B):z=B,H=m.inflateSetDictionary(this.strm,z)),H===I.Z_BUF_ERROR&&et===!0&&(H=I.Z_OK,et=!1),H!==I.Z_STREAM_END&&H!==I.Z_OK)return this.onEnd(H),this.ended=!0,!1;A.next_out&&(A.avail_out===0||H===I.Z_STREAM_END||A.avail_in===0&&(St===I.Z_FINISH||St===I.Z_SYNC_FLUSH))&&(this.options.to==="string"?(tt=w.utf8border(A.output,A.next_out),kt=A.next_out-tt,dt=w.buf2string(A.output,tt),A.next_out=kt,A.avail_out=J-kt,kt&&k.arraySet(A.output,A.output,tt,kt,0),this.onData(dt)):this.onData(k.shrinkBuf(A.output,A.next_out))),A.avail_in===0&&A.avail_out===0&&(et=!0)}while((A.avail_in>0||A.avail_out===0)&&H!==I.Z_STREAM_END);return H===I.Z_STREAM_END&&(St=I.Z_FINISH),St===I.Z_FINISH?(H=m.inflateEnd(this.strm),this.onEnd(H),this.ended=!0,H===I.Z_OK):(St===I.Z_SYNC_FLUSH&&(this.onEnd(I.Z_OK),A.avail_out=0),!0)},u.prototype.onData=function(O){this.chunks.push(O)},u.prototype.onEnd=function(O){O===I.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=k.flattenChunks(this.chunks)),this.chunks=[],this.err=O,this.msg=this.strm.msg};function N(O,C){var A=new u(C);if(A.push(O,!0),A.err)throw A.msg||S[A.err];return A.result}function x(O,C){return C=C||{},C.raw=!0,N(O,C)}p.Inflate=u,p.inflate=N,p.inflateRaw=x,p.ungzip=N},function(f,p,y){var m=y(33),k=y(34),w=y(35),I=y(36),S=y(37),g=0,a=1,_=2,u=4,N=5,x=6,O=0,C=1,A=2,J=-2,B=-3,H=-4,St=-5,tt=8,kt=1,dt=2,z=3,et=4,lt=5,Ft=6,mt=7,Ct=8,Lt=9,Et=10,Zt=11,j=12,U=13,K=14,ft=15,Rt=16,gt=17,_t=18,Tt=19,Wt=20,Mt=21,F=22,T=23,Z=24,it=25,pt=26,bt=27,Q=28,ne=29,vt=30,oe=31,le=32,be=852,R=592,h=15,d=h;function L(W){return(W>>>24&255)+(W>>>8&65280)+((W&65280)<<8)+((W&255)<<24)}function P(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new m.Buf16(320),this.work=new m.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function G(W){var ot;return!W||!W.state?J:(ot=W.state,W.total_in=W.total_out=ot.total=0,W.msg="",ot.wrap&&(W.adler=ot.wrap&1),ot.mode=kt,ot.last=0,ot.havedict=0,ot.dmax=32768,ot.head=null,ot.hold=0,ot.bits=0,ot.lencode=ot.lendyn=new m.Buf32(be),ot.distcode=ot.distdyn=new m.Buf32(R),ot.sane=1,ot.back=-1,O)}function V(W){var ot;return!W||!W.state?J:(ot=W.state,ot.wsize=0,ot.whave=0,ot.wnext=0,G(W))}function xt(W,ot){var b,ct;return!W||!W.state||(ct=W.state,ot<0?(b=0,ot=-ot):(b=(ot>>4)+1,ot<48&&(ot&=15)),ot&&(ot<8||ot>15))?J:(ct.window!==null&&ct.wbits!==ot&&(ct.window=null),ct.wrap=b,ct.wbits=ot,V(W))}function Dt(W,ot){var b,ct;return W?(ct=new P,W.state=ct,ct.window=null,b=xt(W,ot),b!==O&&(W.state=null),b):J}function Pt(W){return Dt(W,d)}var Vt=!0,At,ke;function $e(W){if(Vt){var ot;for(At=new m.Buf32(512),ke=new m.Buf32(32),ot=0;ot<144;)W.lens[ot++]=8;for(;ot<256;)W.lens[ot++]=9;for(;ot<280;)W.lens[ot++]=7;for(;ot<288;)W.lens[ot++]=8;for(S(a,W.lens,0,288,At,0,W.work,{bits:9}),ot=0;ot<32;)W.lens[ot++]=5;S(_,W.lens,0,32,ke,0,W.work,{bits:5}),Vt=!1}W.lencode=At,W.lenbits=9,W.distcode=ke,W.distbits=5}function We(W,ot,b,ct){var Bt,rt=W.state;return rt.window===null&&(rt.wsize=1<<rt.wbits,rt.wnext=0,rt.whave=0,rt.window=new m.Buf8(rt.wsize)),ct>=rt.wsize?(m.arraySet(rt.window,ot,b-rt.wsize,rt.wsize,0),rt.wnext=0,rt.whave=rt.wsize):(Bt=rt.wsize-rt.wnext,Bt>ct&&(Bt=ct),m.arraySet(rt.window,ot,b-ct,Bt,rt.wnext),ct-=Bt,ct?(m.arraySet(rt.window,ot,b-ct,ct,0),rt.wnext=ct,rt.whave=rt.wsize):(rt.wnext+=Bt,rt.wnext===rt.wsize&&(rt.wnext=0),rt.whave<rt.wsize&&(rt.whave+=Bt))),0}function He(W,ot){var b,ct,Bt,rt,fe,at,Kt,Y,X,tn,Ut,ht,qe,De,Ht=0,Ot,ie,ue,re,en,Ge,Xt,he,te=new m.Buf8(4),Ie,Se,Rn=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!W||!W.state||!W.output||!W.input&&W.avail_in!==0)return J;b=W.state,b.mode===j&&(b.mode=U),fe=W.next_out,Bt=W.output,Kt=W.avail_out,rt=W.next_in,ct=W.input,at=W.avail_in,Y=b.hold,X=b.bits,tn=at,Ut=Kt,he=O;t:for(;;)switch(b.mode){case kt:if(b.wrap===0){b.mode=U;break}for(;X<16;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}if(b.wrap&2&&Y===35615){b.check=0,te[0]=Y&255,te[1]=Y>>>8&255,b.check=w(b.check,te,2,0),Y=0,X=0,b.mode=dt;break}if(b.flags=0,b.head&&(b.head.done=!1),!(b.wrap&1)||(((Y&255)<<8)+(Y>>8))%31){W.msg="incorrect header check",b.mode=vt;break}if((Y&15)!==tt){W.msg="unknown compression method",b.mode=vt;break}if(Y>>>=4,X-=4,Xt=(Y&15)+8,b.wbits===0)b.wbits=Xt;else if(Xt>b.wbits){W.msg="invalid window size",b.mode=vt;break}b.dmax=1<<Xt,W.adler=b.check=1,b.mode=Y&512?Et:j,Y=0,X=0;break;case dt:for(;X<16;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}if(b.flags=Y,(b.flags&255)!==tt){W.msg="unknown compression method",b.mode=vt;break}if(b.flags&57344){W.msg="unknown header flags set",b.mode=vt;break}b.head&&(b.head.text=Y>>8&1),b.flags&512&&(te[0]=Y&255,te[1]=Y>>>8&255,b.check=w(b.check,te,2,0)),Y=0,X=0,b.mode=z;case z:for(;X<32;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}b.head&&(b.head.time=Y),b.flags&512&&(te[0]=Y&255,te[1]=Y>>>8&255,te[2]=Y>>>16&255,te[3]=Y>>>24&255,b.check=w(b.check,te,4,0)),Y=0,X=0,b.mode=et;case et:for(;X<16;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}b.head&&(b.head.xflags=Y&255,b.head.os=Y>>8),b.flags&512&&(te[0]=Y&255,te[1]=Y>>>8&255,b.check=w(b.check,te,2,0)),Y=0,X=0,b.mode=lt;case lt:if(b.flags&1024){for(;X<16;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}b.length=Y,b.head&&(b.head.extra_len=Y),b.flags&512&&(te[0]=Y&255,te[1]=Y>>>8&255,b.check=w(b.check,te,2,0)),Y=0,X=0}else b.head&&(b.head.extra=null);b.mode=Ft;case Ft:if(b.flags&1024&&(ht=b.length,ht>at&&(ht=at),ht&&(b.head&&(Xt=b.head.extra_len-b.length,b.head.extra||(b.head.extra=new Array(b.head.extra_len)),m.arraySet(b.head.extra,ct,rt,ht,Xt)),b.flags&512&&(b.check=w(b.check,ct,ht,rt)),at-=ht,rt+=ht,b.length-=ht),b.length))break t;b.length=0,b.mode=mt;case mt:if(b.flags&2048){if(at===0)break t;ht=0;do Xt=ct[rt+ht++],b.head&&Xt&&b.length<65536&&(b.head.name+=String.fromCharCode(Xt));while(Xt&&ht<at);if(b.flags&512&&(b.check=w(b.check,ct,ht,rt)),at-=ht,rt+=ht,Xt)break t}else b.head&&(b.head.name=null);b.length=0,b.mode=Ct;case Ct:if(b.flags&4096){if(at===0)break t;ht=0;do Xt=ct[rt+ht++],b.head&&Xt&&b.length<65536&&(b.head.comment+=String.fromCharCode(Xt));while(Xt&&ht<at);if(b.flags&512&&(b.check=w(b.check,ct,ht,rt)),at-=ht,rt+=ht,Xt)break t}else b.head&&(b.head.comment=null);b.mode=Lt;case Lt:if(b.flags&512){for(;X<16;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}if(Y!==(b.check&65535)){W.msg="header crc mismatch",b.mode=vt;break}Y=0,X=0}b.head&&(b.head.hcrc=b.flags>>9&1,b.head.done=!0),W.adler=b.check=0,b.mode=j;break;case Et:for(;X<32;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}W.adler=b.check=L(Y),Y=0,X=0,b.mode=Zt;case Zt:if(b.havedict===0)return W.next_out=fe,W.avail_out=Kt,W.next_in=rt,W.avail_in=at,b.hold=Y,b.bits=X,A;W.adler=b.check=1,b.mode=j;case j:if(ot===N||ot===x)break t;case U:if(b.last){Y>>>=X&7,X-=X&7,b.mode=bt;break}for(;X<3;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}switch(b.last=Y&1,Y>>>=1,X-=1,Y&3){case 0:b.mode=K;break;case 1:if($e(b),b.mode=Wt,ot===x){Y>>>=2,X-=2;break t}break;case 2:b.mode=gt;break;case 3:W.msg="invalid block type",b.mode=vt}Y>>>=2,X-=2;break;case K:for(Y>>>=X&7,X-=X&7;X<32;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}if((Y&65535)!==(Y>>>16^65535)){W.msg="invalid stored block lengths",b.mode=vt;break}if(b.length=Y&65535,Y=0,X=0,b.mode=ft,ot===x)break t;case ft:b.mode=Rt;case Rt:if(ht=b.length,ht){if(ht>at&&(ht=at),ht>Kt&&(ht=Kt),ht===0)break t;m.arraySet(Bt,ct,rt,ht,fe),at-=ht,rt+=ht,Kt-=ht,fe+=ht,b.length-=ht;break}b.mode=j;break;case gt:for(;X<14;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}if(b.nlen=(Y&31)+257,Y>>>=5,X-=5,b.ndist=(Y&31)+1,Y>>>=5,X-=5,b.ncode=(Y&15)+4,Y>>>=4,X-=4,b.nlen>286||b.ndist>30){W.msg="too many length or distance symbols",b.mode=vt;break}b.have=0,b.mode=_t;case _t:for(;b.have<b.ncode;){for(;X<3;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}b.lens[Rn[b.have++]]=Y&7,Y>>>=3,X-=3}for(;b.have<19;)b.lens[Rn[b.have++]]=0;if(b.lencode=b.lendyn,b.lenbits=7,Ie={bits:b.lenbits},he=S(g,b.lens,0,19,b.lencode,0,b.work,Ie),b.lenbits=Ie.bits,he){W.msg="invalid code lengths set",b.mode=vt;break}b.have=0,b.mode=Tt;case Tt:for(;b.have<b.nlen+b.ndist;){for(;Ht=b.lencode[Y&(1<<b.lenbits)-1],Ot=Ht>>>24,ie=Ht>>>16&255,ue=Ht&65535,!(Ot<=X);){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}if(ue<16)Y>>>=Ot,X-=Ot,b.lens[b.have++]=ue;else{if(ue===16){for(Se=Ot+2;X<Se;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}if(Y>>>=Ot,X-=Ot,b.have===0){W.msg="invalid bit length repeat",b.mode=vt;break}Xt=b.lens[b.have-1],ht=3+(Y&3),Y>>>=2,X-=2}else if(ue===17){for(Se=Ot+3;X<Se;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}Y>>>=Ot,X-=Ot,Xt=0,ht=3+(Y&7),Y>>>=3,X-=3}else{for(Se=Ot+7;X<Se;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}Y>>>=Ot,X-=Ot,Xt=0,ht=11+(Y&127),Y>>>=7,X-=7}if(b.have+ht>b.nlen+b.ndist){W.msg="invalid bit length repeat",b.mode=vt;break}for(;ht--;)b.lens[b.have++]=Xt}}if(b.mode===vt)break;if(b.lens[256]===0){W.msg="invalid code -- missing end-of-block",b.mode=vt;break}if(b.lenbits=9,Ie={bits:b.lenbits},he=S(a,b.lens,0,b.nlen,b.lencode,0,b.work,Ie),b.lenbits=Ie.bits,he){W.msg="invalid literal/lengths set",b.mode=vt;break}if(b.distbits=6,b.distcode=b.distdyn,Ie={bits:b.distbits},he=S(_,b.lens,b.nlen,b.ndist,b.distcode,0,b.work,Ie),b.distbits=Ie.bits,he){W.msg="invalid distances set",b.mode=vt;break}if(b.mode=Wt,ot===x)break t;case Wt:b.mode=Mt;case Mt:if(at>=6&&Kt>=258){W.next_out=fe,W.avail_out=Kt,W.next_in=rt,W.avail_in=at,b.hold=Y,b.bits=X,I(W,Ut),fe=W.next_out,Bt=W.output,Kt=W.avail_out,rt=W.next_in,ct=W.input,at=W.avail_in,Y=b.hold,X=b.bits,b.mode===j&&(b.back=-1);break}for(b.back=0;Ht=b.lencode[Y&(1<<b.lenbits)-1],Ot=Ht>>>24,ie=Ht>>>16&255,ue=Ht&65535,!(Ot<=X);){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}if(ie&&(ie&240)===0){for(re=Ot,en=ie,Ge=ue;Ht=b.lencode[Ge+((Y&(1<<re+en)-1)>>re)],Ot=Ht>>>24,ie=Ht>>>16&255,ue=Ht&65535,!(re+Ot<=X);){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}Y>>>=re,X-=re,b.back+=re}if(Y>>>=Ot,X-=Ot,b.back+=Ot,b.length=ue,ie===0){b.mode=pt;break}if(ie&32){b.back=-1,b.mode=j;break}if(ie&64){W.msg="invalid literal/length code",b.mode=vt;break}b.extra=ie&15,b.mode=F;case F:if(b.extra){for(Se=b.extra;X<Se;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}b.length+=Y&(1<<b.extra)-1,Y>>>=b.extra,X-=b.extra,b.back+=b.extra}b.was=b.length,b.mode=T;case T:for(;Ht=b.distcode[Y&(1<<b.distbits)-1],Ot=Ht>>>24,ie=Ht>>>16&255,ue=Ht&65535,!(Ot<=X);){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}if((ie&240)===0){for(re=Ot,en=ie,Ge=ue;Ht=b.distcode[Ge+((Y&(1<<re+en)-1)>>re)],Ot=Ht>>>24,ie=Ht>>>16&255,ue=Ht&65535,!(re+Ot<=X);){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}Y>>>=re,X-=re,b.back+=re}if(Y>>>=Ot,X-=Ot,b.back+=Ot,ie&64){W.msg="invalid distance code",b.mode=vt;break}b.offset=ue,b.extra=ie&15,b.mode=Z;case Z:if(b.extra){for(Se=b.extra;X<Se;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}b.offset+=Y&(1<<b.extra)-1,Y>>>=b.extra,X-=b.extra,b.back+=b.extra}if(b.offset>b.dmax){W.msg="invalid distance too far back",b.mode=vt;break}b.mode=it;case it:if(Kt===0)break t;if(ht=Ut-Kt,b.offset>ht){if(ht=b.offset-ht,ht>b.whave&&b.sane){W.msg="invalid distance too far back",b.mode=vt;break}ht>b.wnext?(ht-=b.wnext,qe=b.wsize-ht):qe=b.wnext-ht,ht>b.length&&(ht=b.length),De=b.window}else De=Bt,qe=fe-b.offset,ht=b.length;ht>Kt&&(ht=Kt),Kt-=ht,b.length-=ht;do Bt[fe++]=De[qe++];while(--ht);b.length===0&&(b.mode=Mt);break;case pt:if(Kt===0)break t;Bt[fe++]=b.length,Kt--,b.mode=Mt;break;case bt:if(b.wrap){for(;X<32;){if(at===0)break t;at--,Y|=ct[rt++]<<X,X+=8}if(Ut-=Kt,W.total_out+=Ut,b.total+=Ut,Ut&&(W.adler=b.check=b.flags?w(b.check,Bt,Ut,fe-Ut):k(b.check,Bt,Ut,fe-Ut)),Ut=Kt,(b.flags?Y:L(Y))!==b.check){W.msg="incorrect data check",b.mode=vt;break}Y=0,X=0}b.mode=Q;case Q:if(b.wrap&&b.flags){for(;X<32;){if(at===0)break t;at--,Y+=ct[rt++]<<X,X+=8}if(Y!==(b.total&4294967295)){W.msg="incorrect length check",b.mode=vt;break}Y=0,X=0}b.mode=ne;case ne:he=C;break t;case vt:he=B;break t;case oe:return H;case le:default:return J}return W.next_out=fe,W.avail_out=Kt,W.next_in=rt,W.avail_in=at,b.hold=Y,b.bits=X,(b.wsize||Ut!==W.avail_out&&b.mode<vt&&(b.mode<bt||ot!==u))&&We(W,W.output,W.next_out,Ut-W.avail_out),tn-=W.avail_in,Ut-=W.avail_out,W.total_in+=tn,W.total_out+=Ut,b.total+=Ut,b.wrap&&Ut&&(W.adler=b.check=b.flags?w(b.check,Bt,Ut,W.next_out-Ut):k(b.check,Bt,Ut,W.next_out-Ut)),W.data_type=b.bits+(b.last?64:0)+(b.mode===j?128:0)+(b.mode===Wt||b.mode===ft?256:0),(tn===0&&Ut===0||ot===u)&&he===O&&(he=St),he}function Xn(W){if(!W||!W.state)return J;var ot=W.state;return ot.window&&(ot.window=null),W.state=null,O}function Yn(W,ot){var b;return!W||!W.state||(b=W.state,(b.wrap&2)===0)?J:(b.head=ot,ot.done=!1,O)}function Zn(W,ot){var b=ot.length,ct,Bt,rt;return!W||!W.state||(ct=W.state,ct.wrap!==0&&ct.mode!==Zt)?J:ct.mode===Zt&&(Bt=1,Bt=k(Bt,ot,b,0),Bt!==ct.check)?B:(rt=We(W,ot,b,b),rt?(ct.mode=oe,H):(ct.havedict=1,O))}p.inflateReset=V,p.inflateReset2=xt,p.inflateResetKeep=G,p.inflateInit=Pt,p.inflateInit2=Dt,p.inflate=He,p.inflateEnd=Xn,p.inflateGetHeader=Yn,p.inflateSetDictionary=Zn,p.inflateInfo="pako inflate (from Nodeca project)"},function(f,p){var y=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";p.assign=function(w){for(var I=Array.prototype.slice.call(arguments,1);I.length;){var S=I.shift();if(S){if(typeof S!="object")throw new TypeError(S+"must be non-object");for(var g in S)S.hasOwnProperty(g)&&(w[g]=S[g])}}return w},p.shrinkBuf=function(w,I){return w.length===I?w:w.subarray?w.subarray(0,I):(w.length=I,w)};var m={arraySet:function(w,I,S,g,a){if(I.subarray&&w.subarray){w.set(I.subarray(S,S+g),a);return}for(var _=0;_<g;_++)w[a+_]=I[S+_]},flattenChunks:function(w){var I,S,g,a,_,u;for(g=0,I=0,S=w.length;I<S;I++)g+=w[I].length;for(u=new Uint8Array(g),a=0,I=0,S=w.length;I<S;I++)_=w[I],u.set(_,a),a+=_.length;return u}},k={arraySet:function(w,I,S,g,a){for(var _=0;_<g;_++)w[a+_]=I[S+_]},flattenChunks:function(w){return[].concat.apply([],w)}};p.setTyped=function(w){w?(p.Buf8=Uint8Array,p.Buf16=Uint16Array,p.Buf32=Int32Array,p.assign(p,m)):(p.Buf8=Array,p.Buf16=Array,p.Buf32=Array,p.assign(p,k))},p.setTyped(y)},function(f,p){function y(m,k,w,I){for(var S=m&65535|0,g=m>>>16&65535|0,a=0;w!==0;){a=w>2e3?2e3:w,w-=a;do S=S+k[I++]|0,g=g+S|0;while(--a);S%=65521,g%=65521}return S|g<<16|0}f.exports=y},function(f,p){function y(){for(var w,I=[],S=0;S<256;S++){w=S;for(var g=0;g<8;g++)w=w&1?3988292384^w>>>1:w>>>1;I[S]=w}return I}var m=y();function k(w,I,S,g){var a=m,_=g+S;w^=-1;for(var u=g;u<_;u++)w=w>>>8^a[(w^I[u])&255];return w^-1}f.exports=k},function(f,p){var y=30,m=12;f.exports=function(w,I){var S,g,a,_,u,N,x,O,C,A,J,B,H,St,tt,kt,dt,z,et,lt,Ft,mt,Ct,Lt,Et;S=w.state,g=w.next_in,Lt=w.input,a=g+(w.avail_in-5),_=w.next_out,Et=w.output,u=_-(I-w.avail_out),N=_+(w.avail_out-257),x=S.dmax,O=S.wsize,C=S.whave,A=S.wnext,J=S.window,B=S.hold,H=S.bits,St=S.lencode,tt=S.distcode,kt=(1<<S.lenbits)-1,dt=(1<<S.distbits)-1;t:do{H<15&&(B+=Lt[g++]<<H,H+=8,B+=Lt[g++]<<H,H+=8),z=St[B&kt];e:for(;;){if(et=z>>>24,B>>>=et,H-=et,et=z>>>16&255,et===0)Et[_++]=z&65535;else if(et&16){lt=z&65535,et&=15,et&&(H<et&&(B+=Lt[g++]<<H,H+=8),lt+=B&(1<<et)-1,B>>>=et,H-=et),H<15&&(B+=Lt[g++]<<H,H+=8,B+=Lt[g++]<<H,H+=8),z=tt[B&dt];n:for(;;){if(et=z>>>24,B>>>=et,H-=et,et=z>>>16&255,et&16){if(Ft=z&65535,et&=15,H<et&&(B+=Lt[g++]<<H,H+=8,H<et&&(B+=Lt[g++]<<H,H+=8)),Ft+=B&(1<<et)-1,Ft>x){w.msg="invalid distance too far back",S.mode=y;break t}if(B>>>=et,H-=et,et=_-u,Ft>et){if(et=Ft-et,et>C&&S.sane){w.msg="invalid distance too far back",S.mode=y;break t}if(mt=0,Ct=J,A===0){if(mt+=O-et,et<lt){lt-=et;do Et[_++]=J[mt++];while(--et);mt=_-Ft,Ct=Et}}else if(A<et){if(mt+=O+A-et,et-=A,et<lt){lt-=et;do Et[_++]=J[mt++];while(--et);if(mt=0,A<lt){et=A,lt-=et;do Et[_++]=J[mt++];while(--et);mt=_-Ft,Ct=Et}}}else if(mt+=A-et,et<lt){lt-=et;do Et[_++]=J[mt++];while(--et);mt=_-Ft,Ct=Et}for(;lt>2;)Et[_++]=Ct[mt++],Et[_++]=Ct[mt++],Et[_++]=Ct[mt++],lt-=3;lt&&(Et[_++]=Ct[mt++],lt>1&&(Et[_++]=Ct[mt++]))}else{mt=_-Ft;do Et[_++]=Et[mt++],Et[_++]=Et[mt++],Et[_++]=Et[mt++],lt-=3;while(lt>2);lt&&(Et[_++]=Et[mt++],lt>1&&(Et[_++]=Et[mt++]))}}else if((et&64)===0){z=tt[(z&65535)+(B&(1<<et)-1)];continue n}else{w.msg="invalid distance code",S.mode=y;break t}break}}else if((et&64)===0){z=St[(z&65535)+(B&(1<<et)-1)];continue e}else if(et&32){S.mode=m;break t}else{w.msg="invalid literal/length code",S.mode=y;break t}break}}while(g<a&&_<N);lt=H>>3,g-=lt,H-=lt<<3,B&=(1<<H)-1,w.next_in=g,w.next_out=_,w.avail_in=g<a?5+(a-g):5-(g-a),w.avail_out=_<N?257+(N-_):257-(_-N),S.hold=B,S.bits=H}},function(f,p,y){var m=y(33),k=15,w=852,I=592,S=0,g=1,a=2,_=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],N=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],x=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];f.exports=function(C,A,J,B,H,St,tt,kt){var dt=kt.bits,z=0,et=0,lt=0,Ft=0,mt=0,Ct=0,Lt=0,Et=0,Zt=0,j=0,U,K,ft,Rt,gt,_t=null,Tt=0,Wt,Mt=new m.Buf16(k+1),F=new m.Buf16(k+1),T=null,Z=0,it,pt,bt;for(z=0;z<=k;z++)Mt[z]=0;for(et=0;et<B;et++)Mt[A[J+et]]++;for(mt=dt,Ft=k;Ft>=1&&Mt[Ft]===0;Ft--);if(mt>Ft&&(mt=Ft),Ft===0)return H[St++]=1<<24|64<<16|0,H[St++]=1<<24|64<<16|0,kt.bits=1,0;for(lt=1;lt<Ft&&Mt[lt]===0;lt++);for(mt<lt&&(mt=lt),Et=1,z=1;z<=k;z++)if(Et<<=1,Et-=Mt[z],Et<0)return-1;if(Et>0&&(C===S||Ft!==1))return-1;for(F[1]=0,z=1;z<k;z++)F[z+1]=F[z]+Mt[z];for(et=0;et<B;et++)A[J+et]!==0&&(tt[F[A[J+et]]++]=et);if(C===S?(_t=T=tt,Wt=19):C===g?(_t=_,Tt-=257,T=u,Z-=257,Wt=256):(_t=N,T=x,Wt=-1),j=0,et=0,z=lt,gt=St,Ct=mt,Lt=0,ft=-1,Zt=1<<mt,Rt=Zt-1,C===g&&Zt>w||C===a&&Zt>I)return 1;for(;;){it=z-Lt,tt[et]<Wt?(pt=0,bt=tt[et]):tt[et]>Wt?(pt=T[Z+tt[et]],bt=_t[Tt+tt[et]]):(pt=96,bt=0),U=1<<z-Lt,K=1<<Ct,lt=K;do K-=U,H[gt+(j>>Lt)+K]=it<<24|pt<<16|bt|0;while(K!==0);for(U=1<<z-1;j&U;)U>>=1;if(U!==0?(j&=U-1,j+=U):j=0,et++,--Mt[z]===0){if(z===Ft)break;z=A[J+tt[et]]}if(z>mt&&(j&Rt)!==ft){for(Lt===0&&(Lt=mt),gt+=lt,Ct=z-Lt,Et=1<<Ct;Ct+Lt<Ft&&(Et-=Mt[Ct+Lt],!(Et<=0));)Ct++,Et<<=1;if(Zt+=1<<Ct,C===g&&Zt>w||C===a&&Zt>I)return 1;ft=j&Rt,H[ft]=mt<<24|Ct<<16|gt-St|0}}return j!==0&&(H[gt+j]=z-Lt<<24|64<<16|0),kt.bits=mt,0}},function(f,p,y){var m=y(33),k=!0,w=!0;try{String.fromCharCode.apply(null,[0])}catch{k=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{w=!1}for(var I=new m.Buf8(256),S=0;S<256;S++)I[S]=S>=252?6:S>=248?5:S>=240?4:S>=224?3:S>=192?2:1;I[254]=I[254]=1,p.string2buf=function(a){var _,u,N,x,O,C=a.length,A=0;for(x=0;x<C;x++)u=a.charCodeAt(x),(u&64512)===55296&&x+1<C&&(N=a.charCodeAt(x+1),(N&64512)===56320&&(u=65536+(u-55296<<10)+(N-56320),x++)),A+=u<128?1:u<2048?2:u<65536?3:4;for(_=new m.Buf8(A),O=0,x=0;O<A;x++)u=a.charCodeAt(x),(u&64512)===55296&&x+1<C&&(N=a.charCodeAt(x+1),(N&64512)===56320&&(u=65536+(u-55296<<10)+(N-56320),x++)),u<128?_[O++]=u:u<2048?(_[O++]=192|u>>>6,_[O++]=128|u&63):u<65536?(_[O++]=224|u>>>12,_[O++]=128|u>>>6&63,_[O++]=128|u&63):(_[O++]=240|u>>>18,_[O++]=128|u>>>12&63,_[O++]=128|u>>>6&63,_[O++]=128|u&63);return _};function g(a,_){if(_<65537&&(a.subarray&&w||!a.subarray&&k))return String.fromCharCode.apply(null,m.shrinkBuf(a,_));for(var u="",N=0;N<_;N++)u+=String.fromCharCode(a[N]);return u}p.buf2binstring=function(a){return g(a,a.length)},p.binstring2buf=function(a){for(var _=new m.Buf8(a.length),u=0,N=_.length;u<N;u++)_[u]=a.charCodeAt(u);return _},p.buf2string=function(a,_){var u,N,x,O,C=_||a.length,A=new Array(C*2);for(N=0,u=0;u<C;){if(x=a[u++],x<128){A[N++]=x;continue}if(O=I[x],O>4){A[N++]=65533,u+=O-1;continue}for(x&=O===2?31:O===3?15:7;O>1&&u<C;)x=x<<6|a[u++]&63,O--;if(O>1){A[N++]=65533;continue}x<65536?A[N++]=x:(x-=65536,A[N++]=55296|x>>10&1023,A[N++]=56320|x&1023)}return g(A,N)},p.utf8border=function(a,_){var u;for(_=_||a.length,_>a.length&&(_=a.length),u=_-1;u>=0&&(a[u]&192)===128;)u--;return u<0||u===0?_:u+I[a[u]]>_?u:_}},function(f,p){f.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(f,p){f.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(f,p){function y(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}f.exports=y},function(f,p){function y(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}f.exports=y}])})})(Hn)),Hn.exports}var Us=Bs();const Ir=Ms(Us),Oe={ROOT:"/home/reeyuki",META_FILE:".meta.json",LEGACY_KEY:"desktopOS_fileSystem"},ee={IMAGE:"image",TEXT:"text",OTHER:"other"},xr={home:{reeyuki:{Documents:{"INFO.txt":{type:"file",content:"Files you saved in notepad get saved in your browser session.",kind:ee.TEXT,icon:"/static/icons/notepad.webp"}},Pictures:{"wallpaper1.webp":{type:"file",content:"/static/wallpapers/wallpaper1.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper1.webp"},"wallpaper2.webp":{type:"file",content:"/static/wallpapers/wallpaper2.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper2.webp"},"wallpaper3.webp":{type:"file",content:"/static/wallpapers/wallpaper3.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper3.webp"},"wallpaper4.webp":{type:"file",content:"/static/wallpapers/wallpaper4.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper4.webp"},"wallpaper5.webp":{type:"file",content:"/static/wallpapers/wallpaper5.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper5.webp"},"wallpaper6.webp":{type:"file",content:"/static/wallpapers/wallpaper6.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper6.webp"},"wallpaper7.webp":{type:"file",content:"/static/wallpapers/wallpaper7.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper7.webp"},"wallpaper8.webp":{type:"file",content:"/static/wallpapers/wallpaper8.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper8.webp"},"wallpaper9.webp":{type:"file",content:"/static/wallpapers/wallpaper9.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper9.webp"},"wallpaper10.webp":{type:"file",content:"/static/wallpapers/wallpaper10.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper10.webp"}},Music:{}}}};class zs{constructor(){this.fsReady=this.initFS()}p(c,...f){return new Promise((p,y)=>{this.fs[c](...f,m=>m?y(m):p())})}pRead(c,...f){return new Promise((p,y)=>{this.fs[c](...f,(m,k)=>m?y(m):p(k))})}pStat(c){return new Promise((f,p)=>{this.fs.stat(c,(y,m)=>y?p(y):f(m))})}async initFS(){return new Promise(c=>{Ir.configure({fs:"IndexedDB",options:{}},async()=>{this.fs=Ir.BFSRequire("fs"),await this.migrateIfNeeded(),await this.ensureDefaults(),c()})})}async migrateIfNeeded(){if(await this.exists(Oe.ROOT)||!await this.exists(Oe.LEGACY_KEY))return;const p=await this.readFile(Oe.LEGACY_KEY),y=JSON.parse(p);await this.createFromObject(y,"/"),await this.p("unlink",Oe.LEGACY_KEY)}async ensureDefaults(){await this.createFromObject(xr,"/")}async createFromObject(c,f){for(const p in c){const y=c[p],m=this.join(f,p);y.type==="file"?(await this.p("mkdir",this.dirname(m),{recursive:!0}).catch(()=>{}),await this.exists(m)||await this.p("writeFile",m,y.content??""),await this.writeMeta(this.dirname(m),p,y)):(await this.p("mkdir",m,{recursive:!0}).catch(()=>{}),await this.createFromObject(y,m))}}join(...c){return c.join("/").replace(/\/+/g,"/")}dirname(c){return c.split("/").slice(0,-1).join("/")||"/"}async readMeta(c){const f=this.join(c,Oe.META_FILE);try{const p=await this.pRead("readFile",f,"utf8");return JSON.parse(p)}catch{return{}}}async writeMeta(c,f,p){const y=this.join(c,Oe.META_FILE),m=await this.readMeta(c);m[f]={kind:p.kind,icon:p.icon},await this.p("writeFile",y,JSON.stringify(m))}async removeMeta(c,f){const p=this.join(c,Oe.META_FILE),y=await this.readMeta(c);delete y[f],await this.p("writeFile",p,JSON.stringify(y))}normalizePath(c){return typeof c=="string"?c.split("/").filter(Boolean):Array.isArray(c)?c.filter(Boolean):[]}resolvePath(c,f=[]){const p=typeof c=="string"?c.split("/"):[];let y=c.startsWith("/")?[]:[...f];for(const m of p)!m||m==="."||(m===".."?y.pop():y.push(m));return y}inferKind(c){const f=c.split(".").pop().toLowerCase();return["png","jpg","jpeg","gif","webp"].includes(f)?ee.IMAGE:["txt","js","json","md","html","css"].includes(f)?ee.TEXT:ee.OTHER}resolveDir(c=[]){return this.join("/",...Oe.ROOT.split("/").filter(Boolean),...this.normalizePath(c))}async getFolder(c){await this.fsReady;const f=this.resolveDir(c);let p;try{p=await new Promise((k,w)=>{this.fs.readdir(f,(I,S)=>I?w(I):k(S))})}catch{throw new Error("Invalid path")}const y=await this.readMeta(f),m={};for(const k of p){if(k===Oe.META_FILE)continue;const w=this.join(f,k);if((await this.pStat(w)).isDirectory())m[k]={};else{const S=y[k]?.kind??this.inferKind(k),g=y[k]?.icon??"/static/icons/file.png";let a="";try{a=await this.pRead("readFile",w,"utf8")}catch(_){console.error(_)}m[k]={type:"file",kind:S,icon:g,content:a}}}return m}async createFile(c,f,p="",y=null,m=null){await this.fsReady;const k=this.resolveDir(c),w=this.join(k,f),I=y||this.inferKind(f),S=m||(I===ee.TEXT?"/static/icons/notepad.webp":"/static/icons/file.png");await this.p("mkdir",k,{recursive:!0}).catch(()=>{}),await this.p("writeFile",w,p),await this.writeMeta(k,f,{kind:I,icon:S})}async createFolder(c,f){await this.fsReady;const p=this.join(this.resolveDir(c),f);await this.p("mkdir",p,{recursive:!0})}async deleteItem(c,f){await this.fsReady;const p=this.resolveDir(c),y=this.join(p,f);(await this.pStat(y)).isDirectory()?await this.p("rmdir",y,{recursive:!0}):(await this.p("unlink",y),await this.removeMeta(p,f))}async renameItem(c,f,p){await this.fsReady;const y=this.resolveDir(c);await this.p("rename",this.join(y,f),this.join(y,p));const m=await this.readMeta(y);m[f]&&(m[p]=m[f],delete m[f],await this.p("writeFile",this.join(y,Oe.META_FILE),JSON.stringify(m)))}async updateFile(c,f,p){await this.fsReady;const y=this.resolveDir(c),m=this.join(y,f);if(await this.exists(m))await this.p("writeFile",m,p);else{const w=this.inferKind(f),I=w===ee.TEXT?"/static/icons/notepad.webp":"/static/icons/file.png";await this.createFile(c,f,p,w,I)}}async getFileContent(c,f){await this.fsReady;try{return await this.pRead("readFile",this.join(this.resolveDir(c),f),"utf8")}catch{return""}}async getFileKind(c,f){return await this.fsReady,(await this.readMeta(this.resolveDir(c)))[f]?.kind??null}async getFileIcon(c,f){return await this.fsReady,(await this.readMeta(this.resolveDir(c)))[f]?.icon??null}isFile(c,f){try{return this.fs.statSync(this.join(this.resolveDir(c),f)).isFile()}catch{return!1}}async writeFile(c,f){await this.p("writeFile",c,f)}async readFile(c){return await this.pRead("readFile",c,"utf8")}async exists(c){try{return await this.pStat(c),!0}catch{return!1}}}const Rr="desktopOS_selectedWallpaper";class ui{static startClock(){const c=()=>{const f=new Date;document.getElementById("clock").textContent=f.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),document.getElementById("date").textContent=f.toLocaleDateString()};setInterval(c,1e3),c()}static setRandomWallpaper(){const c=xr.home.reeyuki.Pictures,f=Object.values(c).filter(y=>y.kind==="image").map(y=>y.content);if(!f.length)return;const p=f[Math.floor(Math.random()*f.length)];this.setWallpaper(p)}static setWallpaper(c){let f=document.getElementById("wallpaper-img");f||(f=document.createElement("img"),f.id="wallpaper-img",Object.assign(f.style,{position:"fixed",inset:"0",width:"100vw",height:"100vh",objectFit:"cover",zIndex:"-1",pointerEvents:"none",userSelect:"none"}),f.addEventListener("contextmenu",p=>p.preventDefault()),document.body.appendChild(f)),f.src=c,localStorage.setItem(Rr,c)}static loadWallpaper(){const c=localStorage.getItem(Rr);c?this.setWallpaper(c):this.setRandomWallpaper()}}const ce=document.getElementById("context-menu");class js{constructor(c,f,p){this.fs=c,this.wm=f,this.notepadApp=p,this.currentPath=[],this.history=[],this.historyIndex=-1,this.fileSelectCallback=null,this.open=this.open.bind(this)}async open(c=null){if(this.fileSelectCallback=c,document.getElementById("explorer-win")){this.wm.bringToFront(document.getElementById("explorer-win"));return}const f=document.createElement("div");f.className="window",f.id="explorer-win",f.dataset.fullscreen="false",f.innerHTML=`
      <div class="window-header">
        <span>File Explorer</span>
        ${this.wm.getWindowControls()}
      </div>
      <div class="explorer-nav">
        <div class="back-btn" id="exp-back">← Back</div>
        <div id="exp-path" style="color:#555"></div>
      </div>
      <div class="explorer-container">
        <div class="explorer-sidebar">
          <div class="start-item" data-path="Documents">Documents</div>
          <div class="start-item" data-path="Pictures">Pictures</div>
          <div class="start-item" data-path="Music">Music</div>
        </div>
        <div class="explorer-main" id="explorer-view"></div>
      </div>
    `,Ne.appendChild(f);const p=f.querySelector("#explorer-view");p.style.width="600px",p.style.height="300px",this.wm.makeDraggable(f),this.wm.makeResizable(f),this.wm.setupWindowControls(f),setTimeout(()=>this.wm.bringToFront(f),0),this.wm.addToTaskbar(f.id,"File Explorer","/static/icons/file.png"),this.setupExplorerControls(f),this.navigate([])}setupExplorerControls(c){c.querySelector("#exp-back").onclick=async()=>{this.historyIndex>0&&(this.historyIndex--,this.currentPath=[...this.history[this.historyIndex]],await this.render())},c.querySelectorAll(".explorer-sidebar .start-item").forEach(p=>{p.onclick=async()=>{const y=p.dataset.path.split("/").filter(m=>m);this.navigate(y)}});const f=c.querySelector("#explorer-view");f.addEventListener("contextmenu",p=>{p.target===f&&this.showBackgroundContextMenu(p)})}navigate(c){return this.currentPath=[...c],this.history=this.history.slice(0,this.historyIndex+1),this.history.push([...this.currentPath]),this.historyIndex=this.history.length-1,this.render()}async renderMusicPage(c){c&&(c.innerHTML=`
      <div style="display: flex; gap: 20px; flex-wrap: wrap;">
        <iframe src="https://open.spotify.com/embed/playlist/6oK6F4LglYBr4mYLSRDJOa" width="300" height="380" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
        <iframe src="https://open.spotify.com/embed/playlist/1q7zv2ScwtR2jIxaIRj9iG" width="300" height="380" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
        <iframe src="https://open.spotify.com/embed/playlist/6q8mgrJZ5L4YxabVQoAZZf" width="300" height="380" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
      </div>
    `)}async render(){const c=document.getElementById("explorer-view"),f=document.getElementById("exp-path");if(!c)return;if(c.innerHTML="",f.textContent="/"+this.currentPath.join("/"),this.currentPath[this.currentPath.length-1]==="Music"){await this.renderMusicPage(c);return}const p=await this.fs.getFolder(this.currentPath);for(const[y,m]of Object.entries(p)){const k=m?.type==="file";let w;k?m.icon?w=m.icon.startsWith("/")?m.icon:`data:image/*;base64,${m.icon}`:w=m.kind===ee.IMAGE?m.content.startsWith("/")?m.content:`data:image/*;base64,${m.content}`:"/static/icons/notepad.webp":w="/static/icons/file.png";const I=document.createElement("div");I.className="file-item",I.innerHTML=`
        <img src="${w}" style="width:64px;height:64px;object-fit:cover">
        <span>${y}</span>
      `,I.ondblclick=async()=>this.openItem(y,k),I.oncontextmenu=async S=>this.showFileContextMenu(S,y,k),c.appendChild(I)}}async openItem(c,f){if(f){if(this.fileSelectCallback){this.fileSelectCallback(this.currentPath,c),this.fileSelectCallback=null;return}const p=await this.fs.getFileContent(this.currentPath,c);await this.fs.getFileKind(this.currentPath,c)===ee.IMAGE?this.openImageViewer(c,p):this.notepadApp.open(c,p,this.currentPath)}else this.navigate([...this.currentPath,c])}openImageViewer(c,f){const p=document.createElement("div");p.className="window",Object.assign(p.style,{width:"500px",height:"400px",left:"150px",top:"150px",zIndex:2e3}),p.innerHTML=`
      <div class="window-header">
        <span>${c}</span>
        ${this.wm.getWindowControls()}
      </div>
      <div style="display:flex;justify-content:center;align-items:center;height:calc(100% - 30px);background:#222">
        <img src="${f}" style="max-width:100%; max-height:100%">
      </div>
    `,Ne.appendChild(p),this.wm.makeDraggable(p),this.wm.makeResizable(p),this.wm.setupWindowControls(p),this.wm.addToTaskbar(p.id,c,"/static/icons/file.png")}async showFileContextMenu(c,f,p){c.preventDefault(),c.stopPropagation(),ce.innerHTML="";const y=(S,g)=>{const a=document.createElement("div");return a.textContent=S,a.onclick=()=>g(),a},m=p?"Open":"Open Folder",k=async()=>{ce.style.display="none",await this.openItem(f,p)};ce.appendChild(y(m,k)),p&&(ce.appendChild(document.createElement("hr")),ce.appendChild(y("Delete",async()=>{ce.style.display="none",await this.fs.deleteItem(this.currentPath,f),await this.render()})),ce.appendChild(y("Rename",async()=>{ce.style.display="none";const S=prompt("Enter new name:",f);S&&S!==f&&(await this.fs.renameItem(this.currentPath,f,S),await this.render())})));const w=p?await this.fs.getFileKind(this.currentPath,f):null,I=p?await this.fs.getFileContent(this.currentPath,f):null;w===ee.IMAGE&&ce.appendChild(y("Set Wallpaper",()=>{ce.style.display="none",ui.setWallpaper(I)})),ce.appendChild(y("Properties",()=>{ce.style.display="none",this.wm.showPopup(`Name: ${f}
Type: ${p?"File":"Folder"}`)})),Object.assign(ce.style,{left:`${c.pageX}px`,top:`${c.pageY}px`,display:"block"})}showBackgroundContextMenu(c){c.preventDefault(),c.stopPropagation(),ce.innerHTML=`
      <div id="ctx-new-file">New File</div>
      <div id="ctx-new-folder">New Folder</div>
      <hr>
      <div id="ctx-refresh">Refresh</div>
    `;const f=(p,y)=>{document.getElementById(p).onclick=async()=>{ce.style.display="none",await y()}};f("ctx-new-file",async()=>{const p=prompt("Enter file name:","NewFile.txt");p&&(await this.fs.createFile(this.currentPath,p),await this.render())}),f("ctx-new-folder",async()=>{const p=prompt("Enter folder name:","NewFolder");p&&(await this.fs.createFolder(this.currentPath,p),await this.render())}),f("ctx-refresh",async()=>await this.render()),Object.assign(ce.style,{left:`${c.pageX}px`,top:`${c.pageY}px`,display:"block"})}}const kn=document.getElementById("window-style");let Fr=kn.parentNode;function Ws(){kn.parentNode&&Fr.removeChild(kn)}function Hs(){kn.parentNode||Fr.appendChild(kn)}class qs{constructor(){this.openWindows=new Map,this.zIndexCounter=1e3,this.gameWindowCount=0}updateTransparency(){this.gameWindowCount>0?Ws():Hs()}createWindow(c,f,p="80vw",y="80vh",m=!1){const k=document.createElement("div");k.className="window",k.id=c,k.dataset.fullscreen="false";const w=p!=null?String(p):"80vw",I=y!=null?String(y):"80vh",S=w.includes("vw")?window.innerWidth*parseFloat(w)/100:parseInt(w),g=I.includes("vh")?window.innerHeight*parseFloat(I)/100:parseInt(I);return Object.assign(k.style,{width:`${S}px`,height:`${g}px`,left:`${(window.innerWidth-S)/2}px`,top:`${(window.innerHeight-g)/2}px`,position:"absolute",zIndex:this.zIndexCounter++}),m&&this.gameWindowCount++,this.updateTransparency(),k}addToTaskbar(c,f,p){if(document.getElementById(`taskbar-${c}`))return;const y=document.createElement("div");if(y.id=`taskbar-${c}`,y.className="taskbar-item",p){const w=document.createElement("img");w.src=p,y.appendChild(w)}const m=document.createElement("span");m.textContent=f,y.appendChild(m),y.onclick=()=>{const w=document.getElementById(c);w&&(w.style.display==="none"?(w.style.display="block",y.classList.add("active")):this.bringToFront(w))},y.oncontextmenu=w=>{w.preventDefault();const I=document.getElementById("taskbar-context-menu");I&&I.remove();const S=document.createElement("div");S.id="taskbar-context-menu",S.className="kde-menu";const g=document.getElementById(c),a=(x,O)=>{const C=document.createElement("div");C.textContent=x,C.className="kde-item",C.onclick=()=>{O(),S.remove()},S.appendChild(C)};a(g.style.display==="none"?"Restore":"Minimize",()=>{g.style.display==="none"?g.style.display="block":this.minimizeWindow(g),this.bringToFront(g)}),a(g.dataset.fullscreen==="true"?"Restore Size":"Maximize",()=>{this.toggleFullscreen(g),this.bringToFront(g)}),a("Bring to Front",()=>this.bringToFront(g)),a("Properties",()=>{const x=this.openWindows.get(c);if(!x)return;const O=document.getElementById(c);if(!O)return;const C=O.dataset,A=O.getBoundingClientRect(),B=[`Window ID: ${c}`,`Title: ${x.title}`,C.appType?`Type: ${C.appType}`:"",C.appId?`App ID: ${C.appId}`:"",C.swf?`SWF Path: ${C.swf}`:"",C.rom?`ROM: ${C.rom}`:"",C.core?`Core: ${C.core}`:"",C.externalUrl?`URL: ${C.externalUrl}`:"",`Width: ${Math.round(A.width)}px`,`Height: ${Math.round(A.height)}px`,`Left: ${Math.round(A.left)}px`,`Top: ${Math.round(A.top)}px`,`Z-Index: ${O.style.zIndex}`,`Fullscreen: ${C.fullscreen==="true"?"Yes":"No"}`].filter(Boolean).map(St=>`<div style="margin:2px 0;">${St}</div>`).join(""),H=this.createWindow(`${c}-props`,`Properties: ${x.title}`,"40vw","40vh");H.innerHTML=`
          <div class="window-header">
            <span>Properties: ${x.title}</span>
            ${this.wm.getWindowControls()}
          </div>
          <div class="window-content" style="width:100%; height:100%; overflow:auto; user-select:text;">
            ${B}
          </div>
        `,Ne.appendChild(H),this.makeDraggable(H),this.makeResizable(H),this.setupWindowControls(H)}),a("Close Window",()=>{this.removeFromTaskbar(c),g&&g.remove()}),document.body.appendChild(S);const _=S.getBoundingClientRect();let u=w.pageX,N=window.innerHeight-w.pageY;u+_.width>window.innerWidth&&(u=window.innerWidth-_.width-10),N+_.height>window.innerHeight&&(N=10),S.style.setProperty("--ctx-left",`${u}px`),S.style.setProperty("--ctx-bottom",`${N}px`),document.addEventListener("click",function x(){S.remove(),document.removeEventListener("click",x)})},document.getElementById("taskbar-windows").appendChild(y),this.openWindows.set(c,{taskbarItem:y,title:f})}registerCloseWindow(c,f){c.addEventListener("click",()=>{const p=document.getElementById(f);if(p)p.remove();else return;this.removeFromTaskbar(f)})}removeFromTaskbar(c){const f=document.getElementById(`taskbar-${c}`);f&&f.remove(),this.openWindows.delete(c)}bringToFront(c){c&&(c.style.zIndex=this.zIndexCounter++)}minimizeWindow(c){c.style.display="none";const f=document.getElementById(`taskbar-${c.id}`);f&&(f.style.background="#1a1a1a")}toggleFullscreen(c){const f=c.dataset.fullscreen==="true",p=c.querySelector(".window-header");if(f)document.fullscreenElement===c&&document.exitFullscreen(),Object.assign(c.style,{width:c.dataset.prevWidth,height:c.dataset.prevHeight,left:c.dataset.prevLeft,top:c.dataset.prevTop}),p&&(p.style.display=""),c.dataset.fullscreen="false";else{Object.assign(c.dataset,{prevWidth:c.style.width,prevHeight:c.style.height,prevLeft:c.style.left,prevTop:c.style.top});const y=()=>{Object.assign(c.style,{width:"100vw",height:"100vh",left:"0",top:"0"}),p&&(p.style.display="none")};c.requestFullscreen?c.requestFullscreen().then(y).catch(y):y(),c.dataset.fullscreen="true";const m=()=>{document.fullscreenElement||(p&&(p.style.display=""),c.dataset.fullscreen="false",document.removeEventListener("fullscreenchange",m))};document.addEventListener("fullscreenchange",m)}}setupWindowControls(c){c.querySelector(".close-btn").onclick=()=>{this.removeFromTaskbar(c.id),c.remove(),c.dataset.isGame==="true"&&(this.gameWindowCount=Math.max(0,this.gameWindowCount-1)),this.updateTransparency()},c.querySelector(".minimize-btn").onclick=()=>this.minimizeWindow(c),c.querySelector(".maximize-btn").onclick=()=>this.toggleFullscreen(c);const f=c.querySelector(".close-btn");f&&this.registerCloseWindow(f),c.addEventListener("mousedown",()=>this.bringToFront(c))}makeDraggable(c){const f=c.querySelector(".window-header");f.onmousedown=p=>{if(p.target.tagName==="BUTTON")return;const y=p.clientX-c.offsetLeft,m=p.clientY-c.offsetTop;document.onmousemove=k=>{c.style.left=`${k.clientX-y}px`,c.style.top=`${k.clientY-m}px`},document.onmouseup=()=>document.onmousemove=null}}makeResizable(c){const p=y=>{const m=c.getBoundingClientRect();let k="";return y.clientY-m.top<10?k+="n":m.bottom-y.clientY<10&&(k+="s"),y.clientX-m.left<10?k+="w":m.right-y.clientX<10&&(k+="e"),k};c.addEventListener("mousemove",y=>{const m=p(y),k={n:"n-resize",s:"s-resize",w:"w-resize",e:"e-resize",nw:"nw-resize",ne:"ne-resize",sw:"sw-resize",se:"se-resize","":"default"};c.style.cursor=k[m]||"default"}),c.addEventListener("mousedown",y=>{const m=p(y);if(!m)return;y.preventDefault();const k=y.clientX,w=y.clientY,I=c.getBoundingClientRect(),S=I.width,g=I.height,a=I.left,_=I.top,u=x=>{let O=S,C=g,A=a,J=_;m.includes("e")&&(O=S+(x.clientX-k)),m.includes("s")&&(C=g+(x.clientY-w)),m.includes("w")&&(O=S-(x.clientX-k),A=a+(x.clientX-k)),m.includes("n")&&(C=g-(x.clientY-w),J=_+(x.clientY-w));const B=300;O>B&&(c.style.width=`${O}px`,c.style.left=`${A}px`),C>B&&(c.style.height=`${C}px`,c.style.top=`${J}px`)},N=()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",N)};document.addEventListener("mousemove",u),document.addEventListener("mouseup",N)})}getWindowControls(){return`<div class="window-controls">
              <button class="minimize-btn" title="Minimize">−</button>
              <button class="maximize-btn" title="Maximize">□</button>
              <button class="close-btn" title="Close">X</button>
            </div>
    `}showPopup(c){const f=document.createElement("div");f.textContent=c,Object.assign(f.style,{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"20px 40px",backgroundColor:"rgba(0,0,0,0.8)",color:"#fff",fontSize:"18px",borderRadius:"10px",textAlign:"center",zIndex:9999,cursor:"pointer",boxShadow:"0 4px 15px rgba(0,0,0,0.3)"}),f.addEventListener("click",()=>{f.remove()}),document.body.appendChild(f)}}class Gs{constructor(c){this.wm=c,this.history=[],this.historyIndex=-1,this.currentURL="https://www.google.com/webhp?igu=1"}open(){if(document.getElementById("browser-win")){this.wm.bringToFront(document.getElementById("browser-win"));return}const c=document.createElement("div");c.className="window",c.id="browser-win",c.dataset.fullscreen="false",c.innerHTML=`
      <div class="window-header">
        <span>Browser</span>
        <div class="window-controls">
          <button class="minimize-btn" title="Minimize">−</button>
          <button class="maximize-btn" title="Maximize">□</button>
          <button class="close-btn" title="Close">X</button>
        </div>
      </div>
      <nav class="browser-nav">
        <div>
          <button id="back-btn" disabled aria-label="Click to go back" title="Click to go back">
            ←
          </button>
          <button id="forward-btn" disabled aria-label="Click to go forward" title="Click to go forward">
            →
          </button>
          <button id="reload-btn" aria-label="Reload this page" title="Reload this page">
            ⟳
          </button>
        </div>
        <input id="address-bar" type="url" value="${this.currentURL}" aria-label="Address" enterkeyhint="go">
      </nav>
      <nav class="bookmark-bar">
      <button data-url="https://www.google.com/webhp?igu=1">Google</button>
      <button data-url="https://reeyuki.github.io">Reeyuki Site</button>
      <button data-url="https://liventcord.github.io">LiventCord</button>
      <button data-url="https://www.wikipedia.org">Wikipedia</button>
      <button data-url="https://www.mixconvert.com">Mix Convert</button>
      <button data-url="https://dustinbrett.com/Program%20Files/Browser/dino/index.html">T-Rex Dino</button>
      <button onclick="window.open('https://dn721809.ca.archive.org/0/items/youtube-xvFZjo5PgG0/xvFZjo5PgG0.mp4','_blank')">Click me</button>
      <button data-url="https://bluemaxima.org/flashpoint">Flashpoint Archive</button>
      <button data-url="https://jsfiddle.net">JS Fiddle</button>
      <a href="https://emupedia.net/beta/emuos/">EmuOS</a>
      </nav>
      <iframe id="browser-frame" src="${this.currentURL}" style="width:100%;height:calc(100% - 88px);border:none"></iframe>
    `,Ne.appendChild(c),this.wm.makeDraggable(c),this.wm.makeResizable(c),this.wm.setupWindowControls(c),this.wm.addToTaskbar(c.id,"Browser","/static/icons/chromium.webp"),this.wm.bringToFront(c),this.wm.registerCloseWindow(c.querySelector(".close-btn"),c.id),this.frame=c.querySelector("#browser-frame"),this.addressInput=c.querySelector("#address-bar"),this.backBtn=c.querySelector("#back-btn"),this.forwardBtn=c.querySelector("#forward-btn"),this.reloadBtn=c.querySelector("#reload-btn"),c.style.width="70vw",c.style.height="70vh",c.style.left="15vw",c.style.top="15vh",this.setupControls(c)}setupControls(c){this.backBtn.onclick=()=>this.goBack(),this.forwardBtn.onclick=()=>this.goForward(),this.reloadBtn.onclick=()=>this.frame.src=this.currentURL,this.addressInput.addEventListener("keydown",f=>{f.key==="Enter"&&this.navigate(this.addressInput.value)}),c.querySelectorAll(".bookmark-bar button").forEach(f=>{f.addEventListener("click",()=>{this.navigate(f.dataset.url)})})}navigate(c){if(!c){console.error("No url found");return}!c.startsWith("http")&&!c.startsWith("chrome")&&(c="https://"+c),this.historyIndex<this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1)),this.history.push(c),this.historyIndex++,this.updateNavigation()}goBack(){this.historyIndex>0&&(this.historyIndex--,this.updateNavigation())}goForward(){this.historyIndex<this.history.length-1&&(this.historyIndex++,this.updateNavigation())}updateNavigation(){this.currentURL=this.history[this.historyIndex],this.frame.src=this.currentURL,this.addressInput.value=this.currentURL,this.backBtn.disabled=this.historyIndex<=0,this.forwardBtn.disabled=this.historyIndex>=this.history.length-1}}const Tr="kdeFavorites";function fn(){return JSON.parse(localStorage.getItem(Tr))||[]}function Or(st){localStorage.setItem(Tr,JSON.stringify(st))}function Xs(st){let c=fn();c.includes(st)||(c.push(st),Or(c),fi(),Dr(st,!0))}function Ys(st){let c=fn();c=c.filter(f=>f!==st),Or(c),fi(),Dr(st,!1)}function Nr(st){const c=document.createElement("span");return c.textContent="★",c.className="star",c.style.color=fn().includes(st)?"gold":"#ccc",c.addEventListener("click",f=>{f.stopPropagation(),fn().includes(st)?Ys(st):Xs(st)}),c.dataset.app=st,c}function Dr(st,c){document.querySelectorAll(`.kde-item[data-app="${st}"] span`).forEach(p=>{p.textContent==="★"&&(p.style.color=c?"gold":"#ccc")});const f=document.querySelector(`.kde-item[data-app="${st}"]`);f&&(f.style.background=c?"rgba(255, 215, 0, 0.1)":"transparent")}function fi(st){if(!st){console.error("No app launcher");return}const c=document.querySelector('.kde-page[data-page="favorites"]');c.innerHTML="";const f=fn();if(f.length===0){const p=document.createElement("div");p.textContent="No favorite apps",p.style.padding="10px",p.style.color="#888",c.appendChild(p);return}f.forEach(p=>{const y=document.querySelector(`.kde-item[data-app="${p}"]`);if(!y)return;const m=y.cloneNode(!0);m.style.position="relative",m.style.background="rgba(255, 215, 0, 0.1)",m.onclick=()=>st.launch(p);const k=m.querySelector(".star");k&&k.remove(),m.appendChild(Nr(p)),c.appendChild(m)})}function Zs(){document.querySelectorAll(".kde-page:not([data-page='favorites']) .kde-item").forEach(st=>{const c=st.dataset.app;st.style.position="relative";const f=Nr(c);f.style.opacity="0",f.style.transition="opacity 0.2s",st.appendChild(f),st.addEventListener("mouseenter",()=>f.style.opacity="1"),st.addEventListener("mouseleave",()=>f.style.opacity="0"),fn().includes(c)&&(st.style.background="rgba(255, 215, 0, 0.1)")})}function Vs(){document.querySelectorAll(".kde-cat").forEach(st=>{st.onclick=()=>{document.querySelectorAll(".kde-cat").forEach(c=>c.classList.remove("active")),document.querySelectorAll(".kde-page").forEach(c=>c.classList.remove("active")),st.classList.add("active"),document.querySelector(`.kde-page[data-page="${st.dataset.cat}"]`).classList.add("active")}}),document.getElementById("kde-search").addEventListener("input",st=>{const c=st.target.value.toLowerCase();document.querySelectorAll(".kde-item").forEach(f=>{f.style.display=f.textContent.toLowerCase().includes(c)?"":"none"})}),Zs()}function Ks(st){return st.replace(/(?:^\w|[A-Z]|\b\w)/g,function(c,f){return f===0?c.toLowerCase():c.toUpperCase()}).replace(/\s+/g,"")}function Cr(st){if(st=Ks(st),st==="explorer")return"/static/icons/file.png";if(st==="computer")return"/static/icons/pc.webp";try{return document.querySelector(`#desktop div[data-app="${st}"]`)?.querySelector("img")?.src||null}catch(c){return console.error(c),null}}function Js(st){const c={system:document.querySelector('.kde-page[data-page="system"]'),apps:document.querySelector('.kde-page[data-page="apps"]'),games:document.querySelector('.kde-page[data-page="games"]'),favorites:document.querySelector('.kde-page[data-page="favorites"]')};["system","apps","games"].forEach(f=>{c[f]&&(c[f].innerHTML="")}),Object.entries(st.appMap).forEach(([f,p])=>{const y=document.createElement("div");y.classList.add("kde-item"),y.dataset.app=f;const m=Cr(f),k=document.createElement("img");k.classList.add("kde-item-icon"),m?(k.src=m,k.alt=""):k.style.display="none";const w=f.charAt(0).toUpperCase()+f.slice(1),I=document.createElement("span");I.textContent=w,y.appendChild(k),y.appendChild(I),y.addEventListener("click",()=>st.launch(f)),p.type==="system"?c.system?.appendChild(y):p.type==="game"||p.type==="swf"?c.games?.appendChild(y):c.apps?.appendChild(y)})}class Qs{constructor(c,f,p,y,m,k,w,I){this.wm=c,this.fs=f,this.musicPlayer=p,this.explorerApp=y,this.terminalApp=m,this.notepadApp=k,this.browserApp=w,this.cameraApp=I,this.pageLoadTime=Date.now(),this.TRANSPARENCY_ALLOWED_APP_IDS=new Set(["paint","vscode","liventcord"]);const S=this._getAnalyticsBase("hit-page");this.sendAnalytics({...S,event:"start"}),this.appMap={return:{type:"system",action:()=>window.location.href="/"},explorer:{type:"system",action:()=>this.explorerApp.open()},computer:{type:"system",action:()=>this.explorerApp.open()},terminal:{type:"system",action:()=>this.terminalApp.open()},notepad:{type:"system",action:()=>this.notepadApp.open()},browser:{type:"system",action:()=>this.browserApp.open()},cameraApp:{type:"system",action:()=>this.cameraApp.open()},music:{type:"system",action:()=>this.musicPlayer.open(this.wm)},photopea:{type:"game",url:"https://www.photopea.com"},sonic:{type:"swf",swf:"/static/games/swfGames/sonic.swf"},flight:{type:"swf",swf:"/static/games/swfGames/flight.swf"},swarmQueen:{type:"swf",swf:"/static/games/swfGames/swarmQueen.swf"},paint:{type:"game",url:"https://paint.js.org/"},pacman:{type:"game",url:"https://pacman-e281c.firebaseapp.com"},pvz:{type:"game",url:"https://emupedia.net/emupedia-game-pvz"},pvz2:{type:"remote",url:"https://play.pvzge.com"},pvzHybrid:{type:"remote",url:"https://www.miniplay.com/embed/plants-vs-zombies-hybrid-story"},tetris:{type:"game",url:"https://turbowarp.org/embed.html?autoplay#31651654"},roads:{type:"game",url:"https://slowroads.io"},vscode:{type:"game",url:"https://emupedia.net/emupedia-app-vscode"},isaac:{type:"game",url:"https://emupedia.net/emupedia-game-binding-of-isaac"},mario:{type:"game",url:"https://emupedia.net/emupedia-game-mario"},papaGames:{type:"game",url:"https://papasgamesfree.io"},zombieTd:{type:"swf",swf:"/static/games/swfGames/zombietd.swf"},zombotron:{type:"swf",swf:"/static/games/zombotron/zombotron.swf"},zombotron2:{type:"swf",swf:"/static/games/zombotron/zombotron2.swf"},zombotron2Time:{type:"game",url:"/static/rfiv.html?game=zombotron"},breach:{type:"swf",swf:"/static/games/swfGames/breach.swf"},fancyPants:{type:"swf",swf:"/static/games/swfGames/fancypantsadventure.swf"},fancyPants2:{type:"swf",swf:"/static/games/swfGames/fancypantsadventure2.swf"},fancyPants3:{type:"swf",swf:"/static/games/swfGames/fancypantsadventure3.swf"},strikeForce:{type:"swf",swf:"https://cache.armorgames.com/files/games/strikeforce-kitty-16008.swf?v=1404201513"},strikeForce2:{type:"swf",swf:"https://cache.armorgames.com/files/games/strikeforce-kitty-2-17643.swf?v=1423725280"},baloonsTd5:{type:"swf",swf:"/static/games/swfGames/baloonstd5.swf"},baloonsTd6:{type:"swf",swf:"https://truffled.lol/iframe.html?url=%2Fgames%2Fbtd6%2Findex.html"},trinitas:{type:"game",url:"/static/games/trinitas"},jojo:{type:"game",url:"https://www.retrogames.cc/embed/8843-jojos-bizarre-adventure%3A-heritage-for-the-future-jojo-no-kimyou-na-bouken%3A-mirai-e-no-isan-japan-990927-no-cd.html"},gtaVc:{type:"game",url:"/static/vciframe.html"},subwaySurfers:{type:"game",url:"https://g.igroutka.ru/games/164/Xm2W5MIcPqrF1Y90/12/subway_surfers_easter_edinburgh"},mutantFighting:{type:"swf",swf:"https://cache.armorgames.com/files/games/mutant-fighting-cup-14425.swf?v=1373587528"},mutantFighting2:{type:"swf",swf:"/static/games/swfGames/mutantfightingcup2.swf"},finnAndBones:{type:"game",url:"/static/flashpointarchive.html?fpGameName=finnAndBones"},obama:{type:"game",url:"/static/flashpointarchive.html?fpGameName=obama-alien-defense"},intrusion2:{type:"swf",swf:"/static/games/swfGames/intrusion2.swf"},dan:{type:"game",url:"https://www.silvergames.com/en/dan-the-man/gameframe"},infectonator:{type:"swf",swf:"https://cache.armorgames.com/files/games/infectonator-5020.swf?v=1373587522"},infectonator2:{type:"swf",swf:"https://cache.armorgames.com/files/games/infectonator-2-13150.swf?v=1373587527"},newyorkShark:{type:"swf",swf:"https://cache.armorgames.com/files/games/new-york-shark-12969.swf?v=1373587527"},swordsSouls:{type:"swf",swf:"https://cache.armorgames.com/files/games/swordssouls-17817.swf?v=1464609285"},corporationInc:{type:"swf",swf:"https://cache.armorgames.com/files/games/corporation-inc-7348.swf?v=1373587524"},aground:{type:"game",url:"https://cache.armorgames.com/files/games/aground-18245/index.html?v=1591832301"},mobyDick:{type:"swf",swf:"https://cache.armorgames.com/files/games/moby-dick-the-video--7199.swf?v=1373587524"},mobyDick2:{type:"swf",swf:"https://cache.armorgames.com/files/games/moby-dick-2-12662.swf?v=1373587526"},elfStory:{type:"swf",swf:"https://cache.armorgames.com/files/games/elf-story-14680.swf?v=1373587528"},frogDares:{type:"swf",swf:"https://cache.armorgames.com/files/games/frog-dares-12672.swf?v=1373587526"},kamikazePigs:{type:"swf",swf:"https://cache.armorgames.com/files/games/kamikaze-pigs-13545.swf?v=1373587527"},icyFishes:{type:"swf",swf:"https://cache.armorgames.com/files/games/icy-fishes-12977.swf?v=1373587527"},feedUs6:{type:"swf",swf:"/static/games/swfGames/feeduslostisland.swf"},superrobotwar:{type:"game",url:"/static/flashpointarchive.html?fpGameName=super-robot-war"},feedUsPirates:{type:"swf",swf:"/static/games/swfGames/feeduspirates.swf"},epicbossfighter2:{type:"swf",swf:"/static/games/swfGames/EpicBossFighter2.swf"},avatarFortressFight2:{type:"swf",swf:"/static/games/swfGames/avatarFortressFight2.swf"},incredibles:{type:"swf",swf:"/static/games/swfGames/incredibles.swf"},savagePursuit:{type:"swf",swf:"/static/games/swfGames/savagepursuit.swf"},cactusMcCoy:{type:"game",url:"https://papasgamesfree.io/cactus-mccoy-1"},jackSmith:{type:"game",url:"https://papasgamesfree.io/jacksmith"},pokemonRed:{type:"gba",url:"pokemon-red.gba"},pokemonEmerald:{type:"gba",url:"pokemon-emerald.gba"},pokemonPlatinum:{type:"nds",url:"pokemon-platinum.nds"},pokemonHeartgold:{type:"nds",url:"pokemon-heartgold.nds"},pokemonWhite:{type:"nds",url:"pokemon-white.nds"},pokemonWhite2:{type:"nds",url:"pokemon-white-2.zip"},minecraft:{type:"remote",url:"https://eaglercraft.com/play"},liventcord:{type:"game",url:"https://liventcord.github.io"},fnaf:{type:"game",url:"/static/games/fnaf"},geometryDash:{type:"game",url:"https://emupedia.net/emupedia-game-geometry-dash"},cutTheRope:{type:"game",url:"https://emupedia.net/emupedia-game-cut-the-rope2"},game2048:{type:"game",url:"https://emupedia.net/emupedia-game-2048"},pinball:{type:"game",url:"https://emupedia.net/emupedia-game-space-cadet-pinball"},flappyBird:{type:"game",url:"https://emupedia.net/emupedia-game-flappy-bird"},jetpack:{type:"game",url:"https://emupedia.net/emupedia-game-jetpack-joyride"},happyWheels:{type:"game",url:"https://emupedia.net/emupedia-game-happy-wheels/flash"},fistPunch:{type:"game",url:"/static/flashpointarchive.html?fpGameName=fistPunch"},hollowKnight:{type:"game",url:"/static/hollowknight.html"},slimeRancher:{type:"game",url:"https://dev.snubby.top"},kindergarten:{type:"game",url:"https://truffled.lol/games/kindergarten/1/index.html"},kindergarten2:{type:"game",url:"https://truffled.lol/games/kindergarten/2/index.html"},cuphead:{type:"game",url:"https://truffled.lol/games/Cuphead/index.html"},raft:{type:"game",url:"https://truffled.lol/games/raft/index.html"},celeste:{type:"game",url:"https://truffled.lol/games/celeste/index.html"},terraria:{type:"game",url:"https://truffled.lol/games/terraria/terraria-wrapper.html"},yandereSim:{type:"game",url:"https://truffled.lol/gamefile/yandere.html"},undertale:{type:"game",url:"https://truffled.lol/games/bts"},balatro:{type:"game",url:"https://truffled.lol/games/balatro/index.html"},granny:{type:"game",url:"https://truffled.lol/gamefile/Granny.html"},bendy:{type:"game",url:"https://truffled.lol/games/BATIM/BATIM/index.html"},tattletail:{type:"game",url:"https://truffled.lol/games/tattletail/index.html"}},Js(this)}launch(c){const f=this.appMap[c];if(!f){console.error(`App ${c} not found.`);return}console.log("Starting app : ",c);const p=this._getAnalyticsBase(c);this.sendAnalytics({...p,event:"launch"}),{system:()=>f.action(),swf:()=>this.openRuffleApp(c,f.swf,p),gba:()=>this.openEmulatorApp(c,f.url,"gba",p),nds:()=>this.openEmulatorApp(c,f.url,"nds",p),game:()=>this.openGameApp(c,f.url,p),html:()=>this.openHtmlApp(c,f.html,p,f),remote:()=>this.openRemoteApp(f.url)}[f.type]?.()}_getAnalyticsBase(c){const f=Date.now(),p=f-this.pageLoadTime,y=navigator.hardwareConcurrency||"Unknown",m=window.innerWidth;let k="small";m>=1024?k="large":m>=640&&(k="medium");const w=this.getBrowserFamily(),I=this.getDeviceType();return{app:c,timestamp:f,sessionAgeMs:p,cores:y,viewport:k,deviceType:I,browserfamily:w}}getDeviceType(){const c=navigator.userAgent||navigator.vendor||window.opera;return/android/i.test(c)||/iPad|iPhone|iPod/.test(c)&&!window.MSStream?"mobile":"desktop"}getBrowserFamily(){const c=navigator.userAgent;return/Firefox\/\d+/i.test(c)?"firefox":/Edg\/\d+/i.test(c)?"edge":/Chrome\/\d+/i.test(c)&&!/Edg\/\d+/i.test(c)?"chrome":/Safari\/\d+/i.test(c)&&!/Chrome\/\d+/i.test(c)?"safari":"other"}sendAnalytics(c){window.location.hostname!=="localhost"&&fetch("https://analytics.liventcord-a60.workers.dev/analytics",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})}recordUsage(c,f){const p=Date.now(),y=document.getElementById(c),m=()=>{const k=Date.now()-p;this.sendAnalytics({...f,event:"usage",durationMs:k})};y.querySelector(".close-btn").addEventListener("click",m),y.addEventListener("blur",m)}openRemoteApp(c){const f=this._getAnalyticsBase(c);this.sendAnalytics({...f,event:"launch"}),window.open(c,"_blank","noopener,noreferrer")}openHtmlApp(c,f,p){if(document.getElementById(`${c}-win`)){this.wm.bringToFront(document.getElementById(`${c}-win`));return}this.createWindow(c,c.replace(/([A-Z])/g," $1").replace(/^./,y=>y.toUpperCase()),f,null,c,p)}openRuffleApp(c,f){if(!f)return;const p=document.querySelector(`[data-app="${c}"] div`);p&&(c=p.textContent);const y=f.replace(/[^a-zA-Z0-9]/g,"");if(document.getElementById(`${y}-win`)){this.wm.bringToFront(document.getElementById(`${y}-win`));return}const m=`<embed src="${f}" width="100%" height="100%">`;this.createWindow(y,c.toUpperCase(),m,null,c,{type:"swf",swf:f})}openEmulatorApp(c,f,p){const y=document.querySelector(`[data-app="${c}"] div`);y&&(c=y.textContent);const m=`${p}-${f.replace(/\W/g,"")}-${Date.now()}`;if(document.getElementById(m)){this.wm.bringToFront(document.getElementById(m));return}const k=`/static/emulatorjs.html?rom=${encodeURIComponent(f)}&core=${encodeURIComponent(p)}&color=%230064ff`,w=`<iframe src="${k}" style="width:100%; height:100%; border:none;" allow="autoplay; fullscreen; clipboard-write; encrypted-media; picture-in-picture" sandbox="allow-forms allow-downloads allow-modals allow-pointer-lock allow-popups allow-same-origin allow-scripts allow-top-navigation-by-user-activation"></iframe>`;this.createWindow(m,c,w,k,c,{type:p,rom:f,core:p})}openGameApp(c,f){let p;const y=document.querySelector(`[data-app="${c}"] div`);if(y&&(p=y.textContent),document.getElementById(`${c}-win`)){this.wm.bringToFront(document.getElementById(`${c}-win`));return}const m=`<iframe src="${f}" style="width:100%; height:100%; border:none;" allow="autoplay; fullscreen; clipboard-write; encrypted-media; picture-in-picture" sandbox="allow-forms allow-downloads allow-modals allow-pointer-lock allow-popups allow-same-origin allow-scripts allow-top-navigation-by-user-activation"></iframe>`;this.createWindow(c,p,m,f,c,{type:"game"})}isTransparencyBlocked(c,f){return!(f.type==="system"||this.TRANSPARENCY_ALLOWED_APP_IDS.has(c))}createWindow(c,f,p,y=null,m=null,k={}){const w=this.isTransparencyBlocked(m,k),I=this.wm.createWindow(`${c}-win`,f,"80vw","80vh",w);I.dataset.appType=k.type||"",I.dataset.externalUrl=y||"",I.dataset.appId=m||"",I.dataset.swf=k.swf||"",I.dataset.isGame=w,I.dataset.rom=k.rom||"",I.dataset.core=k.core||"",console.log(`Id: ${c}, ${m}, appMeta ${k.toString()}, title: ${f}`),I.innerHTML=`
      <div class="window-header">
        <span>${f}</span>
        <div class="window-controls">
          <button class="minimize-btn" title="Minimize">−</button>
          ${y?'<button class="external-btn" title="Open in External">↗</button>':""}
          <button class="maximize-btn" title="Maximize">□</button>
          <button class="close-btn" title="Close">X</button>
        </div>
      </div>
      <div class="window-content" style="width:100%; height:100%;">
        ${p}
      </div>
    `,Ne.appendChild(I),this.wm.makeDraggable(I),this.wm.makeResizable(I),this.wm.setupWindowControls(I),this.wm.bringToFront(I),y&&I.querySelector(".external-btn").addEventListener("click",()=>this.openRemoteApp(y));const S=Cr(m||c);this.wm.addToTaskbar(I.id,f,S),this.recordUsage(`${c}-win`)}}class $s{constructor(c,f){this.fs=c,this.wm=f}setExplorer(c){this.explorerApp=c}open(c="Untitled",f="",p=null){const y=`notepad-${c.replace(/\s/g,"")}`;if(document.getElementById(y)){this.wm.bringToFront(document.getElementById(y));return}const m=this.wm.createWindow(y,`${c} - Notepad`,"600px","400px");Object.assign(m.style,{left:"250px",top:"150px"}),m.innerHTML=`
      <div class="window-header">
        <span>${c} - Notepad</span>
        <div class="window-controls">
          <button class="minimize-btn" title="Minimize">−</button>
          <button class="maximize-btn" title="Maximize">□</button>
          <button class="close-btn" title="Close">X</button>
        </div>
      </div>
      <div class="notepad-menu">
        <button class="notepad-btn" data-action="save">Save</button>
        <button class="notepad-btn" data-action="saveAs">Save As</button>
        <button class="notepad-btn" data-action="open">Open</button>
      </div>
      <div class="window-content">
        <textarea class="notepad-textarea" style="width:100%; height:calc(100% - 40px); border:none; padding:10px; font-family:monospace;">${f}</textarea>
      </div>
    `,Ne.appendChild(m),this.wm.makeDraggable(m),this.wm.makeResizable(m),this.wm.setupWindowControls(m),this.wm.addToTaskbar(m.id,`${c} - Notepad`,"/static/icons/music.png"),this.setupNotepadControls(m,c,p)}setupNotepadControls(c,f,p){const y=c.querySelector(".notepad-textarea");c.querySelectorAll(".notepad-btn").forEach(k=>{k.onclick=()=>{const w=k.dataset.action;w==="save"?this.saveFile(c,y,f,p):w==="saveAs"?this.saveAsFile(y):w==="open"&&this.openFileDialog()}})}saveFile(c,f,p,y){if(!y){this.saveAsFile(f);return}const m=f.value;this.fs.updateFile(y,p,m),alert(`File saved: ${p}`)}saveAsFile(c){const f=prompt("Enter file name:","NewFile.txt");if(!f)return;const p=prompt("Enter path (e.g., home/reeyuki/Documents):","home/reeyuki/Documents");if(!p)return;const y=p.split("/").filter(k=>k),m=c.value;try{this.fs.createFile(y,f,m),alert(`File saved: ${f} at /${p}`)}catch(k){console.error(k),alert("Error saving file. Please check the path.")}}openFileDialog(){this.explorerApp.open(async(c,f)=>{const p=await this.fs.getFileContent(c,f);this.open(f,p,c)})}}class ta{constructor(c){this.wm=c,this.stream=null,this.mediaRecorder=null,this.recordedChunks=[],this.recordings=[],this.recordingInterval=null,this.historyWin=null}open(){if(document.getElementById("camera-win")){this.wm.bringToFront(document.getElementById("camera-win"));return}const c=document.createElement("div");c.className="window",c.id="camera-win",c.dataset.fullscreen="false",c.innerHTML=`
      <div class="window-header">
        <span>Camera</span>
        ${this.wm.getWindowControls()}
      </div>
      <div style="padding:10px; display:flex; flex-direction:column; align-items:center; position:relative;">
      <div class="video-shell">
        <video id="camera-video" autoplay playsinline></video>
        <span id="recording-icon"></span>
        <span id="recording-timer"></span>
      </div>

        <div style="margin-top:10px; display:flex; gap:10px;">
          <button id="take-photo-btn" style="padding:5px 15px;">Take Photo</button>
          <button id="start-record-btn" style="padding:5px 15px;">Start Recording</button>
          <button id="stop-record-btn" style="padding:5px 15px;" disabled>Stop Recording</button>
          <button id="start-screen-btn" style="padding:5px 15px;">Record Screen</button>
          <button id="open-history-btn" style="padding:5px 15px;">History</button>
        </div>
        <a id="download-link" style="display:none; margin-top:10px;"></a>
      </div>
    `,Ne.appendChild(c),this.wm.makeDraggable(c),this.wm.makeResizable(c),this.wm.setupWindowControls(c),this.wm.addToTaskbar(c.id,"Camera","/static/icons/camera.svg"),this.wm.bringToFront(c);const f=c.querySelector(".close-btn");f.addEventListener("click"),this.wm.registerCloseWindow(f,c.id),this.video=c.querySelector("#camera-video"),this.takePhotoBtn=c.querySelector("#take-photo-btn"),this.startRecordBtn=c.querySelector("#start-record-btn"),this.stopRecordBtn=c.querySelector("#stop-record-btn"),this.downloadLink=c.querySelector("#download-link"),this.recordingIcon=c.querySelector("#recording-icon"),this.recordingTimer=c.querySelector("#recording-timer"),this.historyBtn=c.querySelector("#open-history-btn"),this.startScreenBtn=c.querySelector("#start-screen-btn"),c.style.width="50vw",c.style.height="70vh",c.style.left="25vw",c.style.top="15vh",this.startCamera(),this.takePhotoBtn.onclick=()=>this.takePhoto(),this.startRecordBtn.onclick=()=>this.startRecording(),this.stopRecordBtn.onclick=()=>this.stopRecording(),this.historyBtn.onclick=()=>this.openHistoryWindow(),this.startScreenBtn.onclick=()=>this.startScreenRecording(),this.db=this.initDB(),this.restoreHistory()}async startCamera(){try{this.stream=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),this.video.srcObject=this.stream}catch(c){alert("Camera access denied or not available."),console.error(c)}}takePhoto(){const c=document.createElement("canvas");c.width=this.video.videoWidth,c.height=this.video.videoHeight,c.getContext("2d").drawImage(this.video,0,0);const f=c.toDataURL("image/png");this.downloadLink.href=f,this.downloadLink.download="photo.png",this.downloadLink.textContent="Download Photo",this.downloadLink.style.display="block"}startRecording(){this.stream&&(this.recordedChunks=[],this.mediaRecorder=new MediaRecorder(this.stream),this.mediaRecorder.ondataavailable=c=>{c.data.size>0&&this.recordedChunks.push(c.data)},this.mediaRecorder.onstop=()=>{const c=new Blob(this.recordedChunks,{type:"video/webm"}),f=URL.createObjectURL(c);this.addRecording(f,c),this.stopTimer(),this.downloadLink.href=f,this.downloadLink.download=`video-${Date.now()}.webm`,this.downloadLink.textContent="Download Video",this.downloadLink.style.display="block",this.historyWin&&this.renderHistory()},this.mediaRecorder.start(),this.startRecordBtn.disabled=!0,this.stopRecordBtn.disabled=!1,this.recordingIcon.style.display="block",this.startTimer())}stopRecording(){this.mediaRecorder&&this.mediaRecorder.state!=="inactive"&&(this.mediaRecorder.stop(),this.stopTimer(),this.recordingIcon.style.display="none",this.startRecordBtn.disabled=!1,this.stopRecordBtn.disabled=!0)}async startScreenRecording(){try{const c=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0});this.activeStream=c,this.video.srcObject=c,this.recordedChunks=[],this.mediaRecorder=new MediaRecorder(c),this.mediaRecorder.ondataavailable=f=>{f.data.size>0&&this.recordedChunks.push(f.data)},this.mediaRecorder.onstop=()=>{const f=new Blob(this.recordedChunks,{type:"video/webm"}),p=URL.createObjectURL(f);this.addRecording(p,f),this.downloadLink.href=p,this.downloadLink.download=`screen-${Date.now()}.webm`,this.downloadLink.textContent="Download Screen Recording",this.downloadLink.style.display="block",this.stopTimer(),this.recordingIcon.style.display="none",this.startRecordBtn.disabled=!1,this.stopRecordBtn.disabled=!0,this.activeStream.getTracks().forEach(y=>y.stop()),this.activeStream=null,this.video.srcObject=this.stream,this.historyWin&&this.renderHistory()},c.getVideoTracks()[0].onended=()=>{this.mediaRecorder.state!=="inactive"&&this.mediaRecorder.stop()},this.mediaRecorder.start(),this.startRecordBtn.disabled=!0,this.stopRecordBtn.disabled=!1,this.recordingIcon.style.display="block",this.startTimer()}catch(c){console.error(c),alert("Screen capture cancelled or not allowed")}}startTimer(){let c=0;this.recordingTimer.textContent="00:00",this.recordingInterval=setInterval(()=>{c++;const f=String(Math.floor(c/60)).padStart(2,"0"),p=String(c%60).padStart(2,"0");this.recordingTimer.textContent=`${f}:${p}`},1e3)}stopTimer(){clearInterval(this.recordingInterval),this.recordingTimer.textContent=""}async addRecording(c,f){const p={id:crypto.randomUUID(),name:`Recording ${new Date().toLocaleTimeString()}`,blob:f};if(this.recordings.unshift({...p,url:URL.createObjectURL(f)}),await this.saveRecordingToDB(p),this.recordings.length>5){const y=this.recordings.pop();URL.revokeObjectURL(y.url),await this.deleteRecordingFromDB(y.id)}}openHistoryWindow(){if(this.historyWin){this.wm.bringToFront(this.historyWin);return}this.historyWin=document.createElement("div"),this.historyWin.className="window",this.historyWin.id="history-win",this.historyWin.innerHTML=`
      <div class="window-header">
        <span>Recordings History</span>
        ${this.wm.getWindowControls()}
      </div>
      <div id="history-list" style="padding:10px; display:flex; flex-direction:column; gap:5px; overflow-y:auto; height:calc(100% - 30px);"></div>
    `,Ne.appendChild(this.historyWin),this.wm.makeDraggable(this.historyWin),this.wm.makeResizable(this.historyWin),this.wm.setupWindowControls(this.historyWin),this.wm.bringToFront(this.historyWin),this.historyWin.querySelector(".close-btn").onclick=()=>{this.historyWin.remove(),this.historyWin=null},this.historyWin.style.width="30vw",this.historyWin.style.height="50vh",this.historyWin.style.left="60vw",this.historyWin.style.top="20vh",this.renderHistory()}renderHistory(){if(!this.historyWin)return;const c=this.historyWin.querySelector("#history-list");c.innerHTML="",this.recordings.forEach(f=>{const p=document.createElement("div");p.style.display="flex",p.style.alignItems="center",p.style.justifyContent="space-between",p.style.gap="6px",p.style.borderBottom="1px solid #ccc",p.style.padding="6px";const y=document.createElement("span");y.textContent=f.name,y.style.cursor="pointer",y.onclick=()=>this.playRecording(f.url);const m=document.createElement("div");m.style.display="flex",m.style.gap="4px";const k=document.createElement("button");k.textContent="Rename",k.onclick=()=>this.renameRecording(f.id);const w=document.createElement("button");w.textContent="Delete",w.onclick=()=>this.deleteRecording(f.id),m.appendChild(k),m.appendChild(w),p.appendChild(y),p.appendChild(m),c.appendChild(p)})}async renameRecording(c){const f=this.recordings.find(m=>m.id===c);if(!f)return;const p=prompt("Rename recording:",f.name);if(!p)return;f.name=p;const y={id:c,name:p,blob:f.blob};await this.saveRecordingToDB(y),this.renderHistory()}async deleteRecording(c){const f=this.recordings.findIndex(p=>p.id===c);f!==-1&&(URL.revokeObjectURL(this.recordings[f].url),this.recordings.splice(f,1),await this.deleteRecordingFromDB(c),this.renderHistory())}playRecording(c){const f=document.createElement("div");f.className="window",f.innerHTML=`
      <div class="window-header">
        <span>Playback</span>
        <div class="window-controls">
          <button class="close-btn">X</button>
        </div>
      </div>
      <video controls autoplay style="width:100%; height:90%;"></video>
    `,Ne.appendChild(f),this.wm.makeDraggable(f),this.wm.makeResizable(f),this.wm.bringToFront(f),f.querySelector(".close-btn").onclick=()=>f.remove();const p=f.querySelector("video");p.src=c,f.style.width="50vw",f.style.height="50vh",f.style.left="30vw",f.style.top="25vh"}stopCamera(){this.stream&&this.stream.getTracks().forEach(c=>c.stop())}async initDB(){return new Promise((c,f)=>{const p=indexedDB.open("camera-recordings-db",1);p.onupgradeneeded=y=>{y.target.result.createObjectStore("recordings",{keyPath:"id"})},p.onsuccess=y=>c(y.target.result),p.onerror=y=>f(y)})}async saveRecordingToDB(c){const f=await this.db;return new Promise(p=>{const y=f.transaction("recordings","readwrite");y.objectStore("recordings").put(c),y.oncomplete=p})}async deleteRecordingFromDB(c){const f=await this.db;return new Promise(p=>{const y=f.transaction("recordings","readwrite");y.objectStore("recordings").delete(c),y.oncomplete=p})}async loadRecordingsFromDB(){const c=await this.db;return new Promise(f=>{const y=c.transaction("recordings","readonly").objectStore("recordings").getAll();y.onsuccess=()=>f(y.result)})}async restoreHistory(){const c=await this.loadRecordingsFromDB();this.recordings=c.map(f=>({...f,url:URL.createObjectURL(f.blob)}))}}class ea{constructor(){}open(c){if(document.getElementById("music-win")){console.log("bringing window to front"),c.bringToFront(document.getElementById("music-win"));return}console.log("Creating window");const f=c.createWindow("music-win","MUSIC");f.innerHTML=`
    <div class="window-header">
      <span>MUSIC</span>
      ${c.getWindowControls()}
    </div>
    <div class="window-content" style="width:100%; height:100%;">
      <div id="player-container" style="display:flex; flex-direction:column; align-items:center; gap:10px; padding:10px;"></div>
      </div>
    </div>`,qn.appendChild(f),je.renderMusicPage(document.getElementById("player-container")),c.makeDraggable(f),c.makeResizable(f),c.setupWindowControls(f),c.addToTaskbar(f.id,"MUSIC","/static/icons/music.png")}}class na{constructor(c){this.appLauncher=c,this.desktop=document.getElementById("desktop"),this.startButton=document.getElementById("start-button"),this.startMenu=document.getElementById("start-menu"),this.contextMenu=document.getElementById("context-menu"),this.selectionBox=document.getElementById("selection-box"),this.clipboardCurrentCopied=null,this.isDragging=!1,this.draggedIcons=[],this.dragOffsets=[],this.setupEventListeners()}setupEventListeners(){this.startButton.addEventListener("click",c=>{c.stopPropagation(),this.startMenu.style.display=this.startMenu.style.display==="flex"?"none":"flex",fi(this.appLauncher)}),this.startMenu.addEventListener("click",c=>c.stopPropagation()),document.addEventListener("click",()=>{this.startMenu.style.display="none",this.contextMenu.style.display="none"}),this.desktop.addEventListener("contextmenu",c=>{c.target.classList.contains("selectable")?(c.preventDefault(),this.showIconContextMenu(c,c.target)):c.target===this.desktop&&(c.preventDefault(),this.showDesktopContextMenu(c))}),this.setupIconHandlers(),this.setupSelectionBox(),this.setupStartMenu()}setupIconHandlers(){document.querySelectorAll(".icon.selectable").forEach(c=>{this.makeIconDraggable(c)})}makeIconDraggable(c){c.draggable=!1,Object.assign(c.style,{userSelect:"none",webkitUserDrag:"none"}),c.addEventListener("dblclick",p=>{p.stopPropagation(),this.appLauncher.launch(c.dataset.app,c)});let f={x:0,y:0};c.addEventListener("mousedown",p=>{f={x:p.clientX,y:p.clientY},p.ctrlKey?c.classList.toggle("selected"):c.classList.contains("selected")||(document.querySelectorAll(".icon.selectable").forEach(w=>w.classList.remove("selected")),c.classList.add("selected"));const y=Array.from(document.querySelectorAll(".icon.selectable.selected"));this.draggedIcons=y,this.dragOffsets=y.map(w=>({x:p.clientX-w.offsetLeft,y:p.clientY-w.offsetTop}));const m=w=>{Math.sqrt(Math.pow(w.clientX-f.x,2)+Math.pow(w.clientY-f.y,2))>5&&!this.isDragging&&(this.isDragging=!0,this.draggedIcons.forEach(S=>{S.style.opacity="0.7",S.style.zIndex="1000"})),this.isDragging&&this.draggedIcons.forEach((S,g)=>{const a=w.clientX-this.dragOffsets[g].x,_=w.clientY-this.dragOffsets[g].y;S.style.left=`${Math.max(0,a)}px`,S.style.top=`${Math.max(0,_)}px`})},k=()=>{this.isDragging&&(this.draggedIcons.forEach(g=>{const a=parseInt(g.style.left),_=parseInt(g.style.top),u=85,N=105;let x=Math.round(a/u)*u+5,O=Math.round(_/N)*N+5;for(;this.isPositionOccupied(x,O,g);){const C=this.desktop.clientHeight;O+=N,O+100>C&&(O=5,x+=u)}g.style.left=`${x}px`,g.style.top=`${O}px`,g.style.opacity="1",g.style.zIndex="1"}),this.isDragging=!1),this.draggedIcons=[],this.dragOffsets=[],document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",k)};document.addEventListener("mousemove",m),document.addEventListener("mouseup",k)})}isPositionOccupied(c,f,p){const y=Array.from(document.querySelectorAll(".icon.selectable")),m=10;return y.some(k=>{if(k===p)return!1;const w=parseInt(k.style.left)||0,I=parseInt(k.style.top)||0;return Math.abs(w-c)<m&&Math.abs(I-f)<m})}showIconContextMenu(c,f){const p=Array.from(document.querySelectorAll(".icon.selectable.selected"));p.includes(f)||(document.querySelectorAll(".icon.selectable").forEach(m=>m.classList.remove("selected")),f.classList.add("selected"));const y=Array.from(document.querySelectorAll(".icon.selectable.selected")).pop();this.contextMenu.innerHTML=`
      <div id="ctx-open">Open</div>
      <div id="ctx-cut">Cut</div>
      <div id="ctx-copy">Copy</div>
      <div id="ctx-delete">Delete</div>
      <div id="ctx-properties">Properties</div>
    `,document.getElementById("ctx-open").onclick=()=>{this.contextMenu.style.display="none",this.appLauncher.launch(y.dataset.app,y)},document.getElementById("ctx-cut").onclick=()=>{this.clipboardCurrentCopied={action:"cut",icons:p.map(m=>({element:m,data:{app:m.dataset.app,name:m.dataset.name,path:m.dataset.path,innerHTML:m.innerHTML,className:m.className}}))},this.contextMenu.style.display="none"},document.getElementById("ctx-copy").onclick=()=>{this.clipboardCurrentCopied={action:"copy",icons:p.map(m=>({data:{app:m.dataset.app,name:m.dataset.name,path:m.dataset.path,innerHTML:m.innerHTML,className:m.className}}))},this.contextMenu.style.display="none"},document.getElementById("ctx-delete").onclick=()=>{p.forEach(m=>{m.remove()}),this.contextMenu.style.display="none"},document.getElementById("ctx-properties").onclick=()=>{this.showPropertiesDialog(y),this.contextMenu.style.display="none"},Object.assign(this.contextMenu.style,{left:`${c.pageX}px`,top:`${c.pageY}px`,display:"block"})}showPropertiesDialog(c){const f=c.id||`icon-${Date.now()}`,p=c.dataset,y=c.getBoundingClientRect(),m=p.app,k=this.appLauncher?.appMap?.[m]||{},I=[`Name: ${p.name||"Unknown"}`,`Type: ${p.app||"Application"}`,p.path?`Path: ${p.path}`:"",k.type?`App Type: ${k.type}`:"",k.swf?`SWF Path: ${k.swf}`:"",k.url?`URL: ${k.url}`:"",p.core?`Core: ${p.core}`:"",`Width: ${Math.round(y.width)}px`,`Height: ${Math.round(y.height)}px`,`Left: ${Math.round(y.left)}px`,`Top: ${Math.round(y.top)}px`,`Z-Index: ${c.style.zIndex||"0"}`].filter(Boolean).map(g=>`<div style="margin:2px 0;">${g}</div>`).join(""),S=this.appLauncher.wm.createWindow(`${f}-props`,`Properties: ${p.name||"Unknown"}`,"300px","auto");S.innerHTML=`
        <div class="window-header">
            <span>Properties: ${p.name||"Unknown"}</span>
            <div class="window-controls">
                <button class="minimize-btn" title="Minimize">−</button>
                <button class="maximize-btn" title="Maximize">□</button>
                <button class="close-btn" title="Close">X</button>
            </div>
        </div>
        <div class="window-content" style="width:100%; height:100%; overflow:auto; user-select:text; padding:10px;">
            ${I}
        </div>
    `,qn.appendChild(S),this.appLauncher.wm.makeDraggable(S),this.appLauncher.wm.makeResizable(S),this.appLauncher.wm.setupWindowControls(S)}showDesktopContextMenu(c){const f=['<div id="ctx-new-notepad">New Notepad</div>','<div id="ctx-open-explorer">Open File Explorer</div>'];this.clipboardCurrentCopied&&f.push('<div id="ctx-paste">Paste</div>'),f.push("<hr>",'<div id="ctx-refresh">Refresh</div>'),this.contextMenu.innerHTML=f.join(""),document.getElementById("ctx-new-notepad").onclick=()=>{this.contextMenu.style.display="none",In.open()},document.getElementById("ctx-open-explorer").onclick=()=>{this.contextMenu.style.display="none",je.open()},this.clipboardCurrentCopied&&(document.getElementById("ctx-paste").onclick=()=>{this.pasteIcons(c.pageX,c.pageY),this.contextMenu.style.display="none"}),document.getElementById("ctx-refresh").onclick=()=>{this.contextMenu.style.display="none",location.reload()},Object.assign(this.contextMenu.style,{left:`${c.pageX}px`,top:`${c.pageY}px`,display:"block"})}pasteIcons(c,f){if(!this.clipboardCurrentCopied)return;const{action:p,icons:y}=this.clipboardCurrentCopied;y.forEach((m,k)=>{const w=document.createElement("div");w.className=m.data.className,w.innerHTML=m.data.innerHTML,w.dataset.app=m.data.app,w.dataset.name=m.data.name,w.dataset.path=m.data.path,Object.assign(w.style,{position:"absolute",left:`${c+k*10}px`,top:`${f+k*10}px`,userSelect:"none",webkitUserDrag:"none"}),this.makeIconDraggable(w),this.desktop.appendChild(w),p==="cut"&&m.element&&m.element.remove()}),p==="cut"&&(this.clipboardCurrentCopied=null)}setupSelectionBox(){let c,f;this.desktop.addEventListener("mousedown",p=>{if(p.target!==this.desktop)return;c=p.pageX,f=p.pageY,Object.assign(this.selectionBox.style,{left:`${c}px`,top:`${f}px`,width:"0px",height:"0px",display:"block"});const y=document.querySelectorAll(".icon.selectable");y.forEach(w=>w.classList.remove("selected"));const m=w=>{const I=Math.abs(w.pageX-c),S=Math.abs(w.pageY-f),g=Math.min(w.pageX,c),a=Math.min(w.pageY,f);Object.assign(this.selectionBox.style,{width:`${I}px`,height:`${S}px`,left:`${g}px`,top:`${a}px`});const _=this.selectionBox.getBoundingClientRect();y.forEach(u=>{const N=u.getBoundingClientRect();!(N.right<_.left||N.left>_.right||N.bottom<_.top||N.top>_.bottom)?u.classList.add("selected"):u.classList.remove("selected")})},k=()=>{this.selectionBox.style.display="none",document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",k)};document.addEventListener("mousemove",m),document.addEventListener("mouseup",k)})}setupStartMenu(){this.startMenu.querySelectorAll(".start-item").forEach(c=>{c.onclick=f=>{f.stopPropagation();const p=c.dataset.app;p==="documents"?(je.open(),je.navigate(["home","reeyuki","Documents"])):p==="pictures"?(je.open(),je.navigate(["home","reeyuki","Pictures"])):p==="notes"&&In.open(),this.startMenu.style.display="none"}})}}const qn=document.getElementById("desktop"),Gn=new zs,hn=new qs,In=new $s(Gn,hn,null),je=new js(Gn,hn,In),ia=new Gs(hn);In.setExplorer(je);const ra=new As(Gn,hn),oa=new ea,sa=new ta(hn),Ar=new Qs(hn,Gn,oa,je,ra,In,ia,sa);new na(Ar);ui.startClock();ui.setRandomWallpaper();const aa=window.location.search,ca=new URLSearchParams(aa),Lr=ca.get("game");Lr&&setTimeout(()=>{Ar.launch(Lr)},100);const la=qn.querySelectorAll(".icon");function Mr(){const st=qn.clientHeight,c=80,f=100,p=5;let y=p,m=p;la.forEach(k=>{(!k.style.left||!k.style.top)&&(k.style.position="absolute",k.style.left=`${y}px`,k.style.top=`${m}px`,m+=f+p,m+f>st&&(m=p,y+=c+p))})}window.addEventListener("load",Mr);window.addEventListener("resize",Mr);console.log("Howdy, devtools user! the source of this site is available at: https://github.com/Reeyuki/reeyuki.github.io");Vs();Cs({immediate:!0});
